# coding=utf-8
from __future__ import absolute_import, division, print_function, \
  unicode_literals

from unittest import TestCase

import filters as f
from filters.test import BaseFilterTestCase
from six import binary_type, iterkeys

from iota import Address, BadApiResponse, Iota, ProposedTransaction, Tag, \
  TryteString
from iota.adapter import MockAdapter
from iota.commands.extended.prepare_transfer import PrepareTransferCommand
from iota.crypto.types import Seed
from iota.filters import GeneratedAddress, Trytes
from test import mock


class PrepareTransferRequestFilterTestCase(BaseFilterTestCase):
  filter_type = PrepareTransferCommand(MockAdapter()).get_request_filter
  skip_value_check = True

  # noinspection SpellCheckingInspection
  def setUp(self):
    super(PrepareTransferRequestFilterTestCase, self).setUp()

    # Define some tryte sequences that we can reuse between tests.
    self.trytes1 = (
      b'TESTVALUEONE9DONTUSEINPRODUCTION99999JBW'
      b'GEC99GBXFFBCHAEJHLC9DX9EEPAI9ICVCKBX9FFII'
    )

    self.trytes2 = (
      b'TESTVALUETWO9DONTUSEINPRODUCTION99999THZ'
      b'BODYHZM99IR9KOXLZXVUOJM9LQKCQJBWMTY999999'
    )

    self.trytes3 = (
      b'TESTVALUETHREE9DONTUSEINPRODUCTIONG99999'
      b'GTQ9CSNUFPYW9MBQ9LFQJSORCF9LGTY9BWQFY9999'
    )

    self.trytes4 = (
      b'TESTVALUEFOUR9DONTUSEINPRODUCTION99999ZQ'
      b'HOGCBZCOTZVZRFBEHQKHENBIZWDTUQXTOVWEXRIK9'
    )

    self.transfer1 =\
      ProposedTransaction(
        address =
          Address(
            b'TESTVALUEFIVE9DONTUSEINPRODUCTION99999MG'
            b'AAAHJDZ9BBG9U9R9XEOHCBVCLCWCCCCBQCQGG9WHK'
          ),

        value = 42,
      )

    self.transfer2 =\
      ProposedTransaction(
        address =
          Address(
            b'TESTVALUESIX9DONTUSEINPRODUCTION99999GGT'
            b'FODSHHELBDERDCDRBCINDCGQEI9NAWDJBC9TGPFME'
          ),

        value = 86,
      )

  def test_pass_happy_path(self):
    """
    Request is valid.
    """
    request = {
      'changeAddress':  Address(self.trytes1),
      'seed':           Seed(self.trytes2),
      'transfers':      [self.transfer1, self.transfer2],

      'inputs': [
        Address(self.trytes3, key_index=3, security_level=2),
        Address(self.trytes4, key_index=4, security_level=2),
      ],

    }

    filter_ = self._filter(request)

    self.assertFilterPasses(filter_)
    self.assertDictEqual(filter_.cleaned_data, request)

  def test_pass_compatible_types(self):
    """
    Request contains values that can be converted to the expected
    types.
    """
    filter_ = self._filter({
      # Any TrytesCompatible value works here.
      'changeAddress':  binary_type(self.trytes1),
      'seed':           bytearray(self.trytes2),

      # These have to be :py:class:`Address` instances, so that we can
      # set ``key_index``.
      'inputs': [
        Address(self.trytes3, key_index=3, security_level=2),
        Address(self.trytes4, key_index=4, security_level=2),
      ],

      # These still have to have the correct type, however.
      'transfers': [self.transfer1, self.transfer2],
    })

    self.assertFilterPasses(filter_)
    self.assertDictEqual(
      filter_.cleaned_data,

      {
        'changeAddress':  Address(self.trytes1),
        'seed':           Seed(self.trytes2),
        'transfers':      [self.transfer1, self.transfer2],

        'inputs': [
          Address(self.trytes3),
          Address(self.trytes4),
        ],
      },
    )

  def test_pass_optional_parameters_omitted(self):
    """
    Request omits optional parameters.
    """
    filter_ = self._filter({
      'seed':       Seed(self.trytes1),
      'transfers':  [self.transfer1],
    })

    self.assertFilterPasses(filter_)
    self.assertDictEqual(
      filter_.cleaned_data,

      {
        'seed':       Seed(self.trytes1),
        'transfers':  [self.transfer1],

        # These parameters are set to their default values.
        'changeAddress':  None,
        'inputs':         None,
      },
    )

  def test_fail_empty(self):
    """
    Request is empty.
    """
    self.assertFilterErrors(
      {},

      {
        'seed':       [f.FilterMapper.CODE_MISSING_KEY],
        'transfers':  [f.FilterMapper.CODE_MISSING_KEY],
      },
    )

  def test_fail_unexpected_parameters(self):
    """
    Request contains unexpected parameters.
    """
    self.assertFilterErrors(
      {
        'seed': Seed(self.trytes1),

        'transfers': [
          ProposedTransaction(address=Address(self.trytes2), value=42),
        ],

        # You guys give up? Or are you thirsty for more?
        'foo': 'bar',
      },

      {
        'foo': [f.FilterMapper.CODE_EXTRA_KEY],
      },
    )

  def test_fail_seed_null(self):
    """
    ``seed`` is null.
    """
    self.assertFilterErrors(
      {
        'seed': None,

        'transfers': [
          ProposedTransaction(address=Address(self.trytes2), value=42),
        ],
      },

      {
        'seed': [f.Required.CODE_EMPTY],
      },
    )

  def test_fail_seed_wrong_type(self):
    """
    ``seed`` is not a TrytesCompatible value.
    """
    self.assertFilterErrors(
      {
        'seed': 42,

        'transfers': [
          ProposedTransaction(address=Address(self.trytes2), value=42),
        ],
      },

      {
        'seed': [f.Type.CODE_WRONG_TYPE],
      },
    )

  def test_fail_seed_not_trytes(self):
    """
    ``seed`` contains invalid characters.
    """
    self.assertFilterErrors(
      {
        'seed': b'not valid; must contain only uppercase and "9"',

        'transfers': [
          ProposedTransaction(address=Address(self.trytes2), value=42),
        ],
      },

      {
        'seed': [Trytes.CODE_NOT_TRYTES],
      },
    )

  def test_fail_transfers_wrong_type(self):
    """
    ``transfers`` is not an array.
    """
    self.assertFilterErrors(
      {
        # It's gotta be an array, even if there's only one transaction.
        'transfers':
          ProposedTransaction(address=Address(self.trytes2), value=42),

        'seed': Seed(self.trytes1),
      },

      {
        'transfers': [f.Type.CODE_WRONG_TYPE],
      },
    )

  def test_fail_transfers_empty(self):
    """
    ``transfers`` is an array, but it is empty.
    """
    self.assertFilterErrors(
      {
        'transfers': [],

        'seed': Seed(self.trytes1),
      },

      {
        'transfers': [f.Required.CODE_EMPTY],
      },
    )

  def test_fail_transfers_contents_invalid(self):
    """
    ``transfers`` is a non-empty array, but it contains invalid values.
    """
    self.assertFilterErrors(
      {
        'transfers': [
          None,

          # This value is valid; just adding it to make sure the filter
          # doesn't cheat!
          ProposedTransaction(address=Address(self.trytes2), value=42),

          {'address': Address(self.trytes2), 'value': 42},
        ],

        'seed': Seed(self.trytes1),
      },

      {
        'transfers.0': [f.Required.CODE_EMPTY],
        'transfers.2': [f.Type.CODE_WRONG_TYPE],
      },
    )

  def test_fail_change_address_wrong_type(self):
    """
    ``changeAddress`` is not a TrytesCompatible value.
    """
    self.assertFilterErrors(
      {
        'changeAddress':  42,

        'seed': Seed(self.trytes1),

        'transfers': [
          ProposedTransaction(address=Address(self.trytes2), value=42),
        ],
      },

      {
        'changeAddress':  [f.Type.CODE_WRONG_TYPE],
      },
    )

  def test_fail_change_address_not_trytes(self):
    """
    ``changeAddress`` contains invalid characters.
    """
    self.assertFilterErrors(
      {
        'changeAddress':  b'not valid; must contain only uppercase and "9"',

        'seed': Seed(self.trytes1),

        'transfers': [
          ProposedTransaction(address=Address(self.trytes2), value=42),
        ],
      },

      {
        'changeAddress':  [Trytes.CODE_NOT_TRYTES],
      },
    )

  def test_fail_inputs_wrong_type(self):
    """
    ``inputs`` is not an array.
    """
    self.assertFilterErrors(
      {
        # Must be an array, even if there's only one input.
        'inputs': Address(self.trytes3),

        'seed': Seed(self.trytes1),

        'transfers': [
          ProposedTransaction(address=Address(self.trytes2), value=42),
        ],
      },

      {
        'inputs': [f.Type.CODE_WRONG_TYPE],
      },
    )

  def test_fail_inputs_contents_invalid(self):
    """
    ``inputs`` is a non-empty array, but it contains invalid values.
    """
    self.assertFilterErrors(
      {
        'inputs': [
          None,
          binary_type(self.trytes1),

          # This is actually valid; I just added it to make sure the
          #   filter isn't cheating!
          Address(self.trytes1, key_index=1, security_level=2),

          # Inputs must have ``key_index`` set, so that we can generate
          # the correct private key to sign them.
          Address(b'', key_index=None, security_level=2),

          # Inputs must have ``security_level`` set, so that we know
          # how many signature fragments to generate.
          Address(b'', key_index=2),
        ],

        'seed': Seed(self.trytes1),

        'transfers': [
          ProposedTransaction(address=Address(self.trytes2), value=42),
        ],
      },

      {
        'inputs.0': [f.Required.CODE_EMPTY],
        'inputs.1': [f.Type.CODE_WRONG_TYPE],
        'inputs.3': [GeneratedAddress.CODE_NO_KEY_INDEX],
        'inputs.4': [GeneratedAddress.CODE_NO_SECURITY_LEVEL],
      },
    )


# noinspection SpellCheckingInspection
class PrepareTransferCommandTestCase(TestCase):
  """
  Generating validation data using the JS lib:

  .. code-block:: javascript

     var Bundle = require('./lib/crypto/bundle/bundle'),
         Converter = require('./lib/crypto/converter/converter'),
         IOTA = require('./lib/iota'),
         Signing = require('./lib/crypto/signing/signing'),
         Utils = require('./lib/utils/utils');

     // Set the seed that will be used to generate signing keys.
     // Skip this step if there are no inputs.
     var seed = 'SEED9GOES9HERE';

     // Specify constant timestamp value to use for transactions.
     var timestamp = 1482938294;

     // Specify (optional) tag to attach to transactions.
     // IMPORTANT:  This must be exactly 27 trytes long!
     var tag = 'TAG';
     tag += '9'.repeat(Math.max(27-tag.length, 0));

     // Define parameters we will use to generate inputs/signatures.
     var inputs = [
       {balance: 100, keyIndex: 0, securityLevel: 3},
       ...
     ];

     // Assemble the bundle.
     var bundle = new Bundle();
     var iota = new IOTA();

     // Add spend transaction(s) to the bundle.
     // See ``lib/crypto/bundle/bundle.js:Bundle.prototype.addEntry``
     bundle.addEntry(1, 'RECIPIENT9ADDY', 42, tag, timestamp);
     ...

     // Count the number of spend transactions.
     // We'll need this later.
     // Skip this step if there are no inputs.
     var currentIndex = bundle.bundle.length;

     // Add input transaction(s) to the bundle.
     // Skip this step if there are no inputs.
     for(var i=0; i<inputs.length; ++i) {
       bundle.addEntry(
         inputs[i].securityLevel,
         iota.api._newAddress(seed, inputs[i].keyIndex, inputs[i].securityLevel, false),
         -inputs[i].balance,
         tag,
         timestamp
       );
     }

     // Add change transaction (if applicable).
     // Skip this step if there are no inputs.
     bundle.addEntry(1, 'CHANGE9ADDY', 58, tag, timestamp);

     // Finalize the bundle.
     bundle.finalize();

     // Add message to spend transaction(s), if desired.
     // IMPORTANT:  If you don't want to add a message to any
     // transactions, invoke this method with an empty array instead.
     // See ``lib/crypto/bundle/bundle.js:Bundle.prototype.addTrytes``
     bundle.addTrytes(['HELLO9IOTA']);

     // Add signatures.
     // Skip this step if there are no inputs.
     // See ``lib/api/api.js:api.prototype.prepareTransfers``
     var normalizedBundleHash = bundle.normalizedBundle(bundle.bundle[0].bundle);
     for(var i=0; i<inputs.length; ++i) {
       var signingKey = Signing.key(
         Converter.trits(seed),
         inputs[i].keyIndex,
         inputs[i].securityLevel
       );

       for(var j=0; j<inputs[i].securityLevel; ++j) {
         bundle.bundle[currentIndex].signatureMessageFragment = Converter.trytes(
           Signing.signatureFragment(
             normalizedBundleHash.slice(j*27, (j+1)*27),
             signingKey.slice(j*6561, (j+1)*6561)
           )
         );

         ++currentIndex;
       }
     }

     // Convert into tryte sequences, and output the finished product.
     // Phew!
     var transactionTrytes = bundle.bundle.map(Utils.transactionTrytes).reverse();
     console.log(transactionTrytes);
  """
  def setUp(self):
    super(PrepareTransferCommandTestCase, self).setUp()

    self.adapter = MockAdapter()
    self.command = PrepareTransferCommand(self.adapter)

  def run(self, result=None):
    # Ensure that all tranactions use a predictable timestamp.
    self.timestamp = 1482938294

    def get_current_timestamp():
      return self.timestamp

    with mock.patch(
        target  = 'iota.transaction.creation.get_current_timestamp',
        new     = get_current_timestamp,
    ):
      return super(PrepareTransferCommandTestCase, self).run(result)

  def test_wireup(self):
    """
    Verify that the command is wired up correctly.
    """
    self.assertIsInstance(
      Iota(self.adapter).prepareTransfer,
      PrepareTransferCommand,
    )

  def test_pass_inputs_not_needed(self):
    """
    Preparing a bundle that does not transfer any IOTAs.
    """
    response =\
      self.command(
        seed = Seed.random(),

        transfers = [
          ProposedTransaction(
            address =
              Address(
                b'TESTVALUE9DONTUSEINPRODUCTION99999KJUPKN'
                b'RMTHKVJYWNBKBGCKOQWBTKBOBJIZZYQITTFJZKLOI',
              ),

            tag   = Tag(b'PYOTA9UNIT9TESTS9'),
            value = 0,
          ),

          ProposedTransaction(
            address =
              Address(
                b'TESTVALUE9DONTUSEINPRODUCTION99999YMSWGX'
                b'VNDMLXPT9HMVAOWUUZMLSJZFWGKDVGXPSQAWAEBJN',
              ),

            value = 0,
          ),
        ],
      )

    self.assertEqual(set(iterkeys(response)), {'trytes'})
    self.assertEqual(len(response['trytes']), 2)

    # Note that the transactions are returned in reverse order.
    self.assertEqual(
      response['trytes'][0],
      TryteString(b'999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999TESTVALUE9DONTUSEINPRODUCTION99999YMSWGXVNDMLXPT9HMVAOWUUZMLSJZFWGKDVGXPSQAWAEBJN999999999999999999999999999999999999999999999999999999NYBKIVD99A99999999A99999999LK9ZCHYABJFCM9UGKNWDKPAH9KSSXJPOMYYHLHRAGVAZDDFUJLJBONPLNYQCEBEPVEELEZINMNC9QZYQW999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )

    self.assertEqual(
      response['trytes'][1],
      TryteString(b'999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999TESTVALUE9DONTUSEINPRODUCTION99999KJUPKNRMTHKVJYWNBKBGCKOQWBTKBOBJIZZYQITTFJZKLOI999999999999999999999999999PYOTA9UNIT9TESTS99999999999NYBKIVD99999999999A99999999LK9ZCHYABJFCM9UGKNWDKPAH9KSSXJPOMYYHLHRAGVAZDDFUJLJBONPLNYQCEBEPVEELEZINMNC9QZYQW999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )


  def test_pass_inputs_explicit_no_change(self):
    """
    Preparing a bundle with specified inputs, no change address needed.
    """
    self.adapter.seed_response('getBalances', {
      'balances': [13, 29],
      'duration': '1',

      'milestone':
        'TESTVALUE9DONTUSEINPRODUCTION99999ZNIUXU'
        'FIVFBBYQHFYZYIEEWZL9VPMMKIIYTEZRRHXJXKIKF',
    })

    response = self.command(
      seed =
        Seed(
          b'TESTVALUEONE9DONTUSEINPRODUCTION99999C9V'
          b'C9RHFCQAIGSFICL9HIY9ZEUATFVHFGAEUHSECGQAK'
        ),

      transfers = [
        ProposedTransaction(
          address =
            Address(
              b'TESTVALUETWO9DONTUSEINPRODUCTION99999XYY'
              b'NXZLKBYNFPXA9RUGZVEGVPLLFJEM9ZZOUINE9ONOW'
            ),

          value = 42,
        ),
      ],

      inputs = [
        Address(
          trytes =
            b'MQAKZPG9RTXSDGXWZRZJWGHEJIZLZWSMHBLHFFIX'
            b'PQZOFFHNRIOQNJEBWZBDTZDJCUKSQDWR9ALZVDUEB',

          # Normally, you would use an AddressGenerator to create
          # new addresses, so ``key_index`` would be populated
          # automatically.
          #
          # But, AddressGenerator runs a bit slowly, so to speed up
          # test execution, we will use hard-coded values.
          key_index       = 4,
          security_level  = 2,
        ),

        Address(
          trytes =
            b'TNNTKUYYZVIOPMQHXIYKKZVN9PELGAKAUUGKCBYR'
            b'QOZJT9NLVDEVFQXIZKXIF9MOYTJTDTOQJYQLQKXQC',

          key_index       = 5,
          security_level  = 2,
        ),
      ],
    )

    self.assertEqual(set(iterkeys(response)), {'trytes'})
    self.assertEqual(len(response['trytes']), 5)

    # Note that the transactions are returned in reverse order.

    # Input #2, Part 2 of 2
    self.assertEqual(
      response['trytes'][0],
      TryteString(b'PNOHSCLHTDHBNES9REFELWTCKSFPFDPQOEEUKYBXFMRSHAAXBWUXMD9QNSQUWZMOBGDDAVIIHWGBLWIKCLTPZDVYRHYZWWJUKNWOLYDWRTRBOVMXMFJCBEJVMSPBQJQISISHSRNKEZXSOZHZISSMLCMCOBYN9DWGV9Z9GO9QEHNGIASTVPGWPBYQORFASXYDOTMJZVEJHZZRJSUDDTAFJDQFCZKFKJWEPQARTHCWKDWKITI9ZDCRNUWJQBDZZMRYNBDQPHJOCTQKMSFFCXGM9NGNGCBTUEEPAVOXDKHQNHSSUNA9CLTFAUIHSYPIESEVC9YWAWEBKNVAKGKZWWGRWYYPPOLTSOGTKEPCQQ9PLDDAMKGRPOHHHDYCLOJVBWWDTSLYZHKLOZBKHPCOUFPIBZQ9MOHHKMSRTXGXHERZREPSSAASILWCFDUFPXOKGTDSHWRBZSQSNCYFJZJTB9DGDJYISY9EZPLHJRMIQARDR9SIEMDYSBJXMWBGGRANNSAI9A9HYRPG9JEFFTIFSMJZHQWXXTABXPQXYOLTEFDAPZFMLTGGXCVPL9ZNBNNWVLMUHAXAWJNNVBPTXWNTFNQAYDBVCQSXJTPXABKG9PYIJEZRKSYBXTHGUSWORXZNKZNHIJW9KEPWANBKNNKOUKGLISUUTQRGMGHOQQDUUUWHFJQOFXXN9MOAOLSLOXLKPAQ9CRNSTKVRUMNLFPVIULPYXKOLDLARYUKLPMIEQYWSJYTYRMBHRHSPQJHJALMWUHLPIGQLQSXWDPVNIGFUOEMJJ9GIUVGNB9IWKIPBERFTPZOZVDJMBCKFTWLTQYDP9YHXAOU9DEEMDU9WBHPSRKFARYYCQBEKKQQFFTRUKJO9SECIZRQMMDOJZVPWSWWANMYVGHDCCGSKKGEGCKN9MYFG9ASYM9PEFX9DUJUYVTITKVMBKXWFTWUNVTFEDYSSTMWVGCYZIOCRKVRDGBPOVIDPAGIGZJYNI9TSAJCOSGQYQOTIXMBQXDGJTDJCIGKNLTZNEWEELSAXWYEBYCZILJWPKCGFHXTCDRANRRRUJWRIKTHQJNSDLZJTSDPHU9UMRPCHKJBHTYSNGIARREPPIMULJXFIATTWPQAAYSDSBTGYATXNDDIBMQEIBIUK9YAUPNBMKMZSRHK9UGN9YWOVMTFCSZWOMWHUHPYUMWJUNDMMVOAQUBQDLJLMCXFQEGBSZABKVTNFAJTLGVJ9VHAQGD9MSDYLOMCODQJIEBZARCRFVHFIGFFZRZPBFVX9OMHAAIXFKXWC99RINEESNHPYSFWESSKP9AQHJHWUPWYOOYVKFUNKXPXSKTHNWNULCRUMIHBJNAIQNGDLQSXNWRILYVJMYSELRBTLDYELCZVSVTDNVOHFXLPN9NDPSKA9YHVFRGPAFAKNOXBGWNRMYQCFCSMIBHUKKTNQBDDRQXZLWBLHRYTWSMJUJWSPQZPSBQTAZBVOIVIRXKJPSXNRB9ILEUAMGJKDGOEGVGOKFDKWWBRF9BYDQUYVEHFTNJQDAMEVFHQLSU9XTGFPOGGOYWTZONFSZWODUOMKA9AXWWIZL9GMNIXHWNJFHNONJUJGMFUGPAAMHZLXBOJFLJFHGNNWEU9DS9VKVBNVIUDXXGDQFQSNLMGWAMPETROFUFVCDMCARZAJICIXAVAM9YZAFSILIPOEOGHZ9TJQTKRLGTQNWFDAEDHZIOAMRHNUE9ANKIYKEKWBYZWFVUMKFTWBRACWZUWZSGWGWTAPXIILCFMLLLGOLHVVUIGRPO9CRDXECHIZYAJXXECRBMLNCYSFOH9PNJ9UXOWBGCYIRIAOI9VVAIYOLHTLBYEKOYMOCSVBFCHHCTGIBOUDCXXXKGBTWVBCAVOUQVOZCUSKORPYWBXCVYYBVFWSZACWFLRUWZORZULS9RNOBKHRQTR9IYTKFVXRWSWERUECAHVTAKTTSN9VNZOLGJJGAHPIJZQBITVDSXNXZTRMIDLH9XFIOEYUVJWIKLLEAIYBOFFUPCBEMMXBDGTZDICOBWWQ9EBAMLPQNHNHKDBZHACQW9GDQQQPSAWIAYLWWOYDTDRXKCNIWFXZRAXNSGDUSDTWTEFANWWTSAJQIVJQZGPXHUP99LYTNIESJDUZGHEELFJGSBLMEKJBRABTBZASNKLSAUB9GHHIHMJZSGJHXKWMKIJOQVBTNNTKUYYZVIOPMQHXIYKKZVN9PELGAKAUUGKCBYRQOZJT9NLVDEVFQXIZKXIF9MOYTJTDTOQJYQLQKXQC999999999999999999999999999999999999999999999999999999NYBKIVD99D99999999D99999999YBPL9FUHMJAALACSDMDFUKKBTUPCHTXNCASWTZJZMYLFPJH9MWDXUCNGAVYJWFFQNHCABKYIQBTJWSZID999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )

    # Input #2, Part 1 of 2
    self.assertEqual(
      response['trytes'][1],
      TryteString(b'MJ9UDTLPAAOHPYNXBLEOLLHTXEBTGAKYONGZUFJAFEDKZYUBAEDUQZMAMSYKPPWCGBK99QAJVXCDXYKJXTQFTG9BSWEKXKWY9ADZVHAMQQAUCEOIQPRULPHGCINEAI9ORHTTCEHU9GPIFDYMOZORWNZYUZNEFGF9WYRBKLSAZTXIFKODGYAMKFJODJRWMLXUFQ9WFJKLWT9TAVINDIALUWQIZISLXDOVKGZPIYNRAQYWRZW9AFCEMTOBSHJEEYN9GZ9ZUULYDHYNEQSSETKYZVQYRIPNRWGRBCFLHRUAKJODCEMYRFBP9EVFKXL9ZTERUVFCXNTYFJBHN9GUGYDTIXXTKTEWSDM9POVBSQSKGBPSPTLAZQ9SENKYBEHGHPXVLI9UJULIDA9KXVRRQBKKAQM9QVZ9GEOUMSMMMZSBQVAYWUJPUKCLDZBHDQIGUK9DOADAVEO9GQTVHLMPXSJQZHEYDCCDHTWKPUEJBAIQ9ZDYLLYTEIBCFZKLZCNYEZULRNSUGPTXZBEWGFVYRBZLSTRGCYSTML9ZGVNXJAQTDASQENWWGBAPNCZHQOQWDXWSUCYDDIDIXRUJXCETUDIDBZJZTNJG9GUDYYBLHRPSZORPOITTJVAGNTPKFURHWMGU9E9DSQQCVAEYEYDPZWBUVPXAFGLKZZWRINYOVSAZCINPQSUKCFDGDSRCCLKLGGOQIJQWGCKTLRBQOQMGSOVYGBVACOOUFINHRQGQBBDWWMVJTEZJEBB9LD9ZNUEYBFRKUZEFT9WRTZRAXQPHHCNGBHRERZDCBCPP9JQ9MH9RBZPGSL9HJBDHPL9WHKCRUVHFWHJSJFWAWEXCTHU9OYKNPBUMSIMONQRHWDIQXETDHT9QGSNPXGTDNUCCFHCJONIDIJADUINVPAVDZQJNOQJQPBMOSCHMPEGHGPMHMRUUWURB9ZPGENHERLURYWLTVVR9GXYGCDCNZLVWVRPKVRXNSXBGDLBBKVGUAJUGGNUYVJSWHKVYT9LYFLVMNBUJDBLVXGDDIJAQKPGUHRTPWNOTLUKDMXGP9BZFKGGJRRNOUNBWZAUZSMMVGZOKGDJEECERVCMJKXHNLFTI9XCZQXN9WGGQMKXXQSIDSXT99KGAOOTGLDJHCPQJPLJDCZQAGRXYADFXCFBCXQGEVEOCKEICIVKVOMKGBXPZHQ9SXDXBFZZI9THLXOPTTGTPSQJTBBC9VYZUXWNENXQRVGKDY9JWCYNXTSAOLIDCBINWLLQDUNYAQRHAZBBROWSCMANZJZYCKZGAVQEI9CLDNKFDXWZMBMGHFEAXD9CW9WHZJ9LTZWEWKETMHHYINLADMLTQEQEVAJOVCZBHEASNWRATZNQWFIVEIXAJEBPLCRYA9JCO9XJPSUCKISZ9FKXVYDLRIKVIFISWWEXMHEREKXIUBFTBWWYVRKWJOPPVSYTZZRLFWAKHBYETICAKPPAJPADYVSFXSY9IVADYPWTULJOIAYWCUBBCPJBEVWIFNWDSWGVZSFSFFIIEJXIVWJDNHJKXPHTRQGWMVYOUQYUZQWNEHEXCARMOKYQSKWEJKKKLDGKJBXQKODOGJXDSACUDHVREMWBSAUAAKUYVAHTUGVSUEVLWRFYTURXKSVRMTFLEEGQUORVNPXEHTIJIGC9MPCOFKARODEORLUGHDVFXVQZYFFIXBSLWVVOICMPPFIEK9APVOCENJ9DFAQ9CQ9LUAQVSDNSYKXBCSLCGYOIVRGRGUSBTBIMSQTNQYCZ9TFARMHY9XXJMHFUVDWOYRBNBSADQTZAKRLYQFVAMSCXBTHVWPFJTVENWKHHOCURLKGCCGK9SKGFIASFHPTJDGKOIRSKNCODYCEBSSCZNZAMSOTXBCFPGLNJHEPJOP9IIIZXRHTMFEXXZUVKDXTEIUXKBFRTXZTMGSXRWBQQGKBSJWHEXVZL9EKECRQQGWG9OTMQSBBAZAMBOHNGVDBM9NSXMRDJIEOOYLISNGNIVKKQHWC9ZIPWHJUWCXVQZOMRKZ9JCHAXS9RZWC9RACAE9EKZGJHYNLWPMZYDYP9MD9YVA9RCWHMFDRVEHLQV9RORXMULAKDOJOZBOYDFNLTUEJHIPL9CQKTPFYKBUREGDWUAUMZUXMCJFQMZUZXLTGZSDTLW9DFFWGKFIOODTMMXMCQHRNWRUXCGYQGTBMR9NQDBTNNTKUYYZVIOPMQHXIYKKZVN9PELGAKAUUGKCBYRQOZJT9NLVDEVFQXIZKXIF9MOYTJTDTOQJYQLQKXQCYZ9999999999999999999999999999999999999999999999999999NYBKIVD99C99999999D99999999YBPL9FUHMJAALACSDMDFUKKBTUPCHTXNCASWTZJZMYLFPJH9MWDXUCNGAVYJWFFQNHCABKYIQBTJWSZID999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )

    # Input #1, Part 2 of 2
    self.assertEqual(
      response['trytes'][2],
      TryteString(b'EOWARUTCGMPDDIK9HLSBJUNJNKFQ9W9EHNWAWCVBOWZNPDPI9MDARRBMMCQTVNYKQYKO99FJY9ULJLRYZQRC9XTVDAFGNRNJHXBWCUQEUNJKTCXKIPHQWRV9KAGREYBHXIUFNS9DIQWJEN9FEAXBOZDNHSCLOSGKTDFLVVEDDRSXKSFOAIIDHDVEW9YWNQZQUHGCBYDZUZGINOLCFKHAPPSYMEIGRHZUVP9BLFFGHYWIOLYF9DXXYUKVSYMLDGMLKDEVERGZ9AWDXSOTVCWQVES9H9YE9LJJJQJCPUVFNCJCVHPAVMBVPODVWGZQJ9ZQWITDKH9DIRSGNGN9ZYJPVZOJAOXOPOQSZCSDILTOAUUMLGOIYG9MYSYBQUVDDDBCFTDWUMPXUDHZBDBAHTUXZWINNALMYDJHGJLCFCJ9KZZNTFPZGSLXGEVEGOWSOUAFBJAY9IOEVNLHFTIWEFURULVEFSDURVWBMNUTNAQAX9NYD9BSA9XKUOEKSSVI9HSAIXLG9PCZKWKSLGOBRKGHSPCTREBYTKUBUWRCCHTDQPFMQBIKTAVXVOCTGUEZCEHGXOGSBYYZFQ9WTBUKSJEUIXJVCWBWQILYUAZ9LBXRRQCQWGMEMU9YNU9RYUBEJQYDZOOFXBLWBRLIGVP9RZKMLPDCMKBEHY9CUBUDVPFHLOFPFOEHUCFFFKQC9NXTNDHGSVNVONLXUZANIAOUWDOUY9LFXGFFBFYPECHONGIXDXXRFAXZIJIXZRTXOOGLZKUVNPDSBSQPWZIOWQQQDQHZJRRXMPYVYHFAPYLESHJXJDGYHOGZUHDWVIXGJEIMQAQACAGJXDESBXPMZM9SOMNEWFVLWJHHBPQRCXVXDGQIAPNTPWNZEXTBZJGSKRXKJPMWPUSZYVUGRJHFHQBLLMGXZWWOQME9PUUEAQNZCZNNGN9LDHAQMDXTSRV9LDMGRXBLUIDEJPIDT9TZDHWYQZQWCUVKTUZGNZ9RHIBWMQNFRQL9BDBRACLIVCWLNZQNEADVMHAYFLMTGZSYRIZDWIWMVGU9TBFEC9XIHFK9GMGVGYBADQBGMQB9IWKASSSLC9OWZG9AZEYRPMHQGRCFKUOPEIOZXUHTUDDLIRHENPXFWOQMFBAKZHKOL9RZLCEKCFTOHWWTBVFOWDKUDWSSMDZEKPEBQUIE9TUSDAMHIRKRGHOGRURYOCTYSDRLIZIADWXZRPCBVHOFZCJLZTQZLPCDRNGBREQTKTPMWVDDNLKYPVCUGPBAQBYCQGDVOKBGMX9WHKNEDIJXEPIKPIQWZVO9UVYVG9QB9KPNHIDAMHTVVCHVKAJREZCZETYPQFKRCNDYGGLDYSMHBTUXGNFPHZVQOQQUBTADRQKZCVCVIABGGNPDGBVWC9FBPHVVUFBPPBBCLXLKYBFH9LH9AVKBIFKSPWZYKQPRGNKMAHQCTYFQWAKIY9KYSCFGZTTAOGWPMKDMQGQSVANQL9YLOQCCIATBEEOTELNTXVJTLOTZUPYJQEAQMDCCSU9ORYZBQJULDQVXPMDNBWFXFPEBIE9MFFPIIWKXDVCPKDGBJFWTICOBRUNKJEFBKXAAFWXYPSCVFRLUVKDSBSUYCIV9UPLJTFYWGFJ9ZFYNOM9YXMHOYWFDDPIJOMTD9KGA9XCXGQHLZVBEKEUWLSC9BFSUTFJGTUHNMKOJ9NQC9UXJXFQSBDOUZRTMPOMURVXUAYGFLGHNKRDDTCASPTBUIDLUHH9HBQHPBRIUICIGNYMGPVNUPIQZOVFHLTAENGAYPWLCQE9DQPLMNPCJUFBPKYGHPHBRTALLMFUHIATKTSQBNTHGRCZILLNCTSZKJHQNVYZ9LOVYYSEXJDBHBBXEKCJEUDDDTUBLWCWWRRGHSZFMJIIEMVABUFNTNLWMVYG9UUVONDX9AMEO9WEPWAJDLRISKO9YCBIYQGGDMJDFDERJNNIKRROFSVLEBYFRJJOOSEWWBYMTIQXBQBYMSFAFBXPMVZAKU9LOGBEHKMOZDMSYXRVEZHPPZPKWCTEEAPFLHOGHJPCFQFLSFHTKRMZEKNEYHQZHLG9E9EUHKKUYSAQTOZWVPQSGFPRAZT9VSYKWRBEEHWPDJUKDCDXUCQCRAGSNAMLCSFOBMIRJFINXNGTGHXSRGFQCI9JFWNBCM9WDEWDPDGMNXMNKLITPRVXYHHCMQAKZPG9RTXSDGXWZRZJWGHEJIZLZWSMHBLHFFIXPQZOFFHNRIOQNJEBWZBDTZDJCUKSQDWR9ALZVDUEB999999999999999999999999999999999999999999999999999999NYBKIVD99B99999999D99999999YBPL9FUHMJAALACSDMDFUKKBTUPCHTXNCASWTZJZMYLFPJH9MWDXUCNGAVYJWFFQNHCABKYIQBTJWSZID999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )

    # Input #1, Part 1 of 2
    self.assertEqual(
      response['trytes'][3],
      TryteString(b'UZW99YV9GMPLXSPRTMJFFGOVNMUNUIPSIJTLBUZT9YCAXBKRWYDVKOMTKHW9STWCMHUBUQHZUGNFMALYCPTSOEEYANVTHWJRFHRYJ9D9JIBDVQLTQFDBYLXBJWAEJPPRHOXSZP9KWKNLQCUGMOKMHJQYODRVVYOZ9DEGJAFBQNIXYXJ9PFGAMZXOBZDQTKQGSTLSXEJBJ9IXICGUFPONWTRIPZXVUAJQIRXYMKONHSEFMCJML9DGQRGLMGLGKEHWTQZWOMIZIF9FWUUMVVWS9CWUMWCHZIRKTODTRLEJTRNA9CCRFJNCVCDCQID9UDQJHGN9YIFJZEFEDVMT9PUYWCABIHJMPNQTSQQEJBKRVQYLGHPYRCOLWKCTKMPFCMOMC9PABJNHFPNJVCYNPAIMCFDVHWOEJIVJOIKPMTCAQZZEFEL9YSOSRWWGBQEPFJNTLVWOXIEPZHHCIQF9DZOQGUKYOJSIFHARSBORDAJRVCTTIEBUD9ISDDLULQQQPHZJTNXOBSDGDWRGCBURMWUP9XQTYIYRLCGWGIWWDO9SQLQIUZOGXQQOZ9CZZINSZAYSLXJHVRQT9DGTLTIERBHIEYFGCHLFUEZJHUUKCZKRCOWSTYIGNFB9TZACBURMAGZQIPEKPHUZ9HIYGWZKOEECUJPKYFXMW9TDITMEOBNNQVJHECBQPXXAETVTHCYCKJGEYVSMWRAXBREMDKCHHVPAED9DYFFSRP9WOFAARRNLONJDNYLCBDKPUM9HYKRURNIOFJBIDJBKYNRVZKTAITEWNMZLA9XMJHIPNUJDWQ9ZRDBJXNZCXADAFREDEDG9EVDYWVFDOEZNFJKJVEXGVSUSOHKUFIGKRZWCVDAWBHVIAEGRENQJSPZMSJXK9VDSLNPWFEVZPFD9JRSV9YOOTJHYKV9ZWKPGBEAPATMINAESECJXMULWYQUENYNTAEYITFUZOTFXVCOWTPMCDKWBYOPWHJMUFRJYQNJLIXIBQHYKZTVGFRDMENVRUAGPBXHJEDVXPEEYWHALUAIFUCPTIFBHMYXSSYSPWOHRXDIKGLRHRHKXIOPBQFQBHQTKGPMYL9THJFRGIFBY9WKIMQSUHKUKFQRDHFUBGPWZNE9SWREBKNIOCAZXFSKEHYBZPWOLDTPVUNVUTURRERGDVEUOCE9NDEHIZWRQCSNUEWYMOAHJGEARXYYLGJGQGASBVJAYZCCUTXIFIHQUMKI9MPRXRZAFUYYSPZQWIDLHJ9NGU9WYNLNRWYKNGEZIKGSZEXL9BVIUNFUWMDLONJTFIIXWUETTMSPBUGHYTHJTJCCXQXLGMHUDJEBVQPCHKYTXJQBBIGRGRWPYCNCYRIOMNSCITUCWHIVOMKCXIW9UZAXRQLKUEH9PZBVPHB9VETTZWFIDEWCHJIHW9QVZHPVUSAEBTLUENJAMSYSDVNPVEDXJBGYYBQLQDXLUEAFJMDYEGDKRTUV9DCJNFZZSFMQX9DCZ9LQLVDOCNFDSNGR9PP9CNHAIAPFGVUUMSMOBUQJWDBAFJXHLZFZOCSK9OQIJYFBRVREMNRJDDHOPPITCXZYJYEAARBNUZYBVETPPZHMFCOIQLJRQYDZYBZCSHERQOZDKOSZWP9QHWMRSYESTDRPGW9HZKKBGHHPBHAUYXLE99OMBYHUFJUYGGWVUEPUXJVEVAEBFJRRFPTOIBPDXSIVJWPZYQVXY9VF9GFTRNRBZEHWFSCNUPGETVYGEJJJQEVFIUFMTFHMDWBTEIWFXGERGZLLMPMKNJSI9AGNZNXWYTJTXLUJHQHAUPZZIAXKCBAECERGTBPCKQZEGSRZIZTYRULGOAXETODFXIKBEZQETMZ99LLTUMLYWA9DREHWALIM9AYCBQQFRNNHUIKVJVIGTGIF9MUMSYJIZJAPOXHIFXH9PPOUOGAQWAKFGXNJDDISLFELAOKYBHMJUYHKXNZQAYWPHPICVMMQOSNOJFDOGPOPMZITNCRT9EXZPRYGOGDIZBWXRNLCGJCNGQDXYYGOFBARMWTPNNTLJBHHPKDDBULTHKEHDTTZUETG9LWVQCRWADOQFMIF9GOCZKBZSWECWORPZUXGLO9WXIZ9QOBANDWNBPMHBGCJ9TLS9WKPGCAJDPBUNU9OMCKMZJVLTUKPZLD9HYOAFKBKLFEVPJGPAVNGRMDYYBARNZHRKULBMQAKZPG9RTXSDGXWZRZJWGHEJIZLZWSMHBLHFFIXPQZOFFHNRIOQNJEBWZBDTZDJCUKSQDWR9ALZVDUEBN99999999999999999999999999999999999999999999999999999NYBKIVD99A99999999D99999999YBPL9FUHMJAALACSDMDFUKKBTUPCHTXNCASWTZJZMYLFPJH9MWDXUCNGAVYJWFFQNHCABKYIQBTJWSZID999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )

    # Spend transaction, Part 1 of 1
    self.assertEqual(
      response['trytes'][4],
      TryteString(b'999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999TESTVALUETWO9DONTUSEINPRODUCTION99999XYYNXZLKBYNFPXA9RUGZVEGVPLLFJEM9ZZOUINE9ONOWOB9999999999999999999999999999999999999999999999999999NYBKIVD99999999999D99999999YBPL9FUHMJAALACSDMDFUKKBTUPCHTXNCASWTZJZMYLFPJH9MWDXUCNGAVYJWFFQNHCABKYIQBTJWSZID999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )

  def test_pass_inputs_explicit_with_change(self):
    """
    Preparing a bundle with specified inputs, change address needed.
    """
    self.adapter.seed_response('getBalances', {
      'balances': [86],
      'duration': '1',

      'milestone':
        'TESTVALUE9DONTUSEINPRODUCTION99999ZNIUXU'
        'FIVFBBYQHFYZYIEEWZL9VPMMKIIYTEZRRHXJXKIKF',
    })

    response = self.command(
      seed =
        Seed(
          b'TESTVALUEONE9DONTUSEINPRODUCTION99999C9V'
          b'C9RHFCQAIGSFICL9HIY9ZEUATFVHFGAEUHSECGQAK'
        ),

      transfers = [
        ProposedTransaction(
          address =
            Address(
              b'TESTVALUETWO9DONTUSEINPRODUCTION99999XYY'
              b'NXZLKBYNFPXA9RUGZVEGVPLLFJEM9ZZOUINE9ONOW'
            ),

          value = 42,
        ),
      ],

      inputs = [
        Address(
          trytes =
            b'MQAKZPG9RTXSDGXWZRZJWGHEJIZLZWSMHBLHFFIX'
            b'PQZOFFHNRIOQNJEBWZBDTZDJCUKSQDWR9ALZVDUEB',

          key_index      = 4,
          security_level = 2,
        ),
      ],

      changeAddress =
        Address(
          b'TESTVALUEFOUR9DONTUSEINPRODUCTION99999WJ'
          b'RBOSBIMNTGDYKUDYYFJFGZOHORYSQPCWJRKHIOVIY',
        ),
    )

    self.assertEqual(set(iterkeys(response)), {'trytes'})
    self.assertEqual(len(response['trytes']), 4)

    # Note that the transactions are returned in reverse order.

    # Change transaction, Part 1 of 1
    self.assertEqual(
      response['trytes'][0],
      TryteString(b'999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999TESTVALUEFOUR9DONTUSEINPRODUCTION99999WJRBOSBIMNTGDYKUDYYFJFGZOHORYSQPCWJRKHIOVIYQB9999999999999999999999999999999999999999999999999999NYBKIVD99C99999999C99999999XRHLMDZPZTK9DIVUOHZIVOOLNKFYRMOX9WJZVXCKRITLLRPVGZJKBEWGAZYCTPS9DDAZTOORMO9AFQLDY999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )

    # Input, Part 2 of 2
    self.assertEqual(
      response['trytes'][1],
      TryteString(b'EOWARUTCGMPDDIK9HLSBJUNJNKFQ9W9EHNWAWCVBOWZNPDPI9MDARRBMMCQTVNYKQYKO99FJY9ULJLRYZFIWJBYENOJJQLK9WPNZOYKIVFEGDEYESZXRKUPXQCGCIMRFCRESTNQFLISJRDZYJYPFXIFJEPKSDUCRTXSKXGTEVVQLWKHCQDQDQYTHRVZDGYALJOQYIVPUGQCWFGXSLIAQZKKMFIHHU9DIJHUCAGJFNFVYLKSCYFDPOQIJUKSFLDRETJJGOIHQOQRIBCVTUEDEKTEQPPZGWBUCLMRUSQZLMWCGKHZRFQKSTCAEJXJSJGZOOKMDEFDEAVOPEPIZAFFGXPJBKOF9YWUGNVZZBWAUMRUBHUGSMLXX9JARMUUQOEHESMAUBYEEDASGN9ZPQUTIXAOWQTYIKNENEXTUVYWRZWBXAATTNJUGBWQEVUQNXGOLGESNXUTRENPIZDHJVTGSTDJJTJXR9VWBYVXILZVCEOXRKBZTSCZN9IODZATCQUSPOWMWNBBNWXMA9HVAMYKYAQYHFFKFLBIWYDNDCTXPYVBNKREIGKGMTDCRAMM9NORHYGETYEKPOGVUICDBCQQVGCWXISODSCBTVMYCHW9PWMSPWRVBGUUBNMUM9PCNHTXKBLYWKSCCNKMCYNFWFJQBSLIAJMCILGJUNCNLXFULXNHEZDW9OZMNWCTKFVKARMJPTBEFH9BBBZKTOZNTACATBNWW9FZ9BIOMKIGAWBPFHZFGXQZJDTAMP9EXDDSBLLQRZKJILUFPMQM9SVZUUOMMLJBHHSYQQIKXLGRKDOBTPC9KWBYQZYCZLAWICDRDKMHWDCWTXQAPKAYQSCSDTNDU9JVUECMPEFHZPXCZEAVLIHNLC9ADFY9IFFCMVPYQFFPWUXIAPIRIGLMIESRRCK9DAUALK9DPHKTUMGUOVDJSGCYXXOZJXRSYFHEKE9LCZXVFFZMBGBIMLNTWDKEOKUMLIRZWB9WHIIYDFRHLSULEBOHHPBOQCWVTKJZYQFEYFXBJVGKQGVLYTILI9VDVXDEHAWMQLLRGBUJJHKSXBPNBWXQGYLMHWVRLOGYCCBTFVSLFNXTH9EHPRCVDTVXWMOHU9MBYMSLK9LPRIZAROMFPPWKI9WSWRPROZZACGLUWVMDKABBNFWBFIRQJRICGHCYODVPTH9GDDLZPBUSXZVYTFNQUHIRFMQAHHLPNNAPFLPXQNXEDFNCOWXUV9F99CFXLKMOSMOE9CKMOHJX9CUKV9CDYBGGEKYKVTMBAAWAVEU99PPO9PMBLQFFRLQGCFIQVJMKNOVHTSUWXXTEKKZCT9RQASRZHCLAIPNEAED9Y9YIHKNUTJOYOYWTMNRNEBMXHCABTDHRNDOQAWATLOGRLRTPOJOGKKIGDWSAUDV9MNXP9IHETL9ZHUOK9GSNJZUSA9KGXLV9GYZQDQETXHETWPDMECU9W9BVVUMKMQRJQF9CTGCXMG9YZWYSWRXDXDZNAXDVOALJAXYVFUPNHAOZHCULZTBADQRMCHLFUJLU9XCBPBPYJMKFKJMSRPKPGWUWITCOOSHUNMGQHFSUSZFGKFCAVXGNOROHKVSNNTIKBATGSGFYWOHNXYBSQQIFKNDRYXMUOQBMKPNCCKNBRSHSIRZSROZLHKPKTSCANHLMWJGFMRJLAEIXSFZXMGCZCKNCXORYKQUX9TSXFBAWMCNFED9PLCXBDEMCDXLKCKVABBGLZEGCESXGTPXPVACXXQLQ99AZMPQPLRMK9IHSQIKQUHQGQYOAGOXSADYDQDTUQMXPNPEXARZQVYTNCTLBWN9DWTBMNFMIGRZVPOUCHOEZSMZRUYYAZBL9KOCKNPKEQHPOLOOURWZ9HOFKVWHVOKUAYPGNGRGARFGEINTOJVMDSJKENFJADXBOZMKEJGAMSQMMETTCTDWNQWKYIGVYQVFMC99N9UTUWXKVLQSJGEQJEZJNXXLQRT9PKTPUZJYDLWUDHZNG9TPZZCHBMELIYUZ9KTDEJSLYVGIQNZQOJCOHCDFBU9JPQUGKGWSVMAW99LBLPJPZOPNDOFOSYAKWREJMJ99SMQWTGBWBKXLQPSFREJOQTOYDLHGSRQJEYHCOGEXPJMDLQYAPQWJGDOEHYFUQZUWSFRVNISOQIDASYGRYJQGEONSAZXCDV9ANDFLGYPFUSLJOILSMMFKXMQAKZPG9RTXSDGXWZRZJWGHEJIZLZWSMHBLHFFIXPQZOFFHNRIOQNJEBWZBDTZDJCUKSQDWR9ALZVDUEB999999999999999999999999999999999999999999999999999999NYBKIVD99B99999999C99999999XRHLMDZPZTK9DIVUOHZIVOOLNKFYRMOX9WJZVXCKRITLLRPVGZJKBEWGAZYCTPS9DDAZTOORMO9AFQLDY999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )

    # Input, Part 1 of 2
    self.assertEqual(
      response['trytes'][2],
      TryteString(b'FRPHPZRQUPWTFQMAPXTNOWFIUPGARU9DKHZWAJVAVBYONCVLMLU9LZOOIZNZDJRWB9HPSXUVEB9VVMLTATOHTODTLYG9GNMHHAFFIEQX9YN9KXURYYNV9BGOXNPXGFVLSOPAMFLKVVOLNRGNUQENIZVNJBBNIHSFOBUOVJDEQRATJLX9TTZWCMRQBJETDZCKYEBQXOSESYFGAAAJVFDGVRIRNVGSQROY9UNTORVGREMHZLDHBXDIWPKCEVEFETRILNWE9Z9WPIOLYHWAEROAZX9WXDMSRIZWXAHFWRAHGKCFAZFBHQTCLCVLS9OHVBCNPXXCZHWYJNEZHNEUZ9X9APMBWQZ9GYBZPIYAGXGKN9D9CMTTHGHCZR9CPQPQYPV9PGWAOKOXSZSRIACP9OAACJSKBLFZBSWTEKTGDL9NGGFDCMB9LGGY9AOUNQLAUSREFIZQGUZAPTHWCTJPILUFEOPDFNREQOXLFKCHTBLKZGEDWPLJPKRFYVQFGQMFRSUHKMNXTWFMFRHRLTSIMVYQCDH9JCNWRHPYRMGARJSQDEMGCSQAWDZI9D9OGBJZEKSEMUUSHTCAUSAORPOBCXJ9LNKNPKJGREVHTZUEFNCGFHGMWLZFCMDTFXCYYFUHFPUFUPNWDKOXFIUCQIB9GYCQYMUKBLY9ZRPUCGU9DQOFHYIEMZNYDESWSLMEWPPQICQUVYWJVKDKDAPOOUMBKSVCVZRECGMBNLPAKEDXVFKBAOPKFOXIFBUNOICBRGMYWTFSFRYCDOKZGZDGWXSREFADMP9HUHJUZWVIFYZFOJKEMZ9DJINBQTVDLDVOSYDVZIPKGQXEBUCMNTVMB9HXWDNPANGOQAVXJAECUFYLIF9VAHUELULAJSYHEIGY9XYPSHIL9PGWF9ZZEDNJFOBHENKVLSFBDTY9YFFSOIQBP9LDOINEWGOABLN9TRFWH9AWXEAKAQDZGBFBHGOAUUSIIMWQ9LQTINFIHIYAVRSYRBJQGDAJKHEOLPCP9VRYDKQJGKFSCVHVHUGITCMHIIOTEQBCO9UQRPSTXOQRAZVVTZNUSJKEYRYYVUIVQR9KFQUVAOZPEHJMANKIEBW9PZOGGCREWHERBLIBK9NZRZUEIE9XBSCJMYWKFLQIEHBRUQHYZYCGJWQIMODPIPHFELJCWRCIIKYEQNRSYCUGWXMJSOFUEBCKPXIOCXP9OTZOIDOSWPDTIIOYGUNUYBL9JJI9GPTIP9FEZIGEBZCZSSVGAYDKDAMPNBCXVBZJJSJ9JGDFMDPMONUGAOFLS9GUREOWVZIX9BGRLZ99HFCUWSZQSRRNAMWXSTK9WUUSJNQSBXPUASIKAXQFLUUSOSRAHUKN9WBOUMCYSDZELDMICVAFNTVPTHCYHVORHNUPPLEJXBMZCCXTWEWSIIHNJAFYPLTLVLGKBJUZGOVIMKJRLLLSJXSUXZCBYZD9BYUFUCXAJCOVTU9AKOQIGUTPUKCJGLHWASEWFLEQ9LBNZGHSQRADCMOHDEFCTZXEMSEGTLAQHRRNZOZDGSYVQDRLQUQ9MFYMWGZSLSYZOXSJXBFEUVTZU9OXQSJKIQPMCBVMHFISFCFVPPQRIDT9ZAFHZGBXJUVUVTNWYAKGDPHRUOARINT9CYAQEHIPXYXJVMYWXZKKHPLTD9LLVLTCMAPSGVV9VQ9WPOOPZYLXNYHCZIUPVFCGAPGSAVXZRMWAUFXEGD9VRODALCTZPXABVSRYADTMMCOLHWKAI9JAPKOTYXEQHRXGRPMDVFPQFPYTLJZOJYVIDNDQTGHNWVSHBHTSACYAYUZUNXWVNOAZAOUAPPKVPCKWJXANORWQGYYTSNZYPPPAQFVZYZEPG9KZUCAAMGDHCDRXDNIOLGCMP9JDOVYYZOCSZYSBT9JUDNHXCIZOMSAPVNRCHTYKUQK9PCTKHIFLNYIWELZTLJUXEEIIGIFFRRGUXARDUPXUGDCUDYE9ENRRASYDWELETZKUIAFQAIQSOGWRFGSFUSOCWASBBBEZFMYULJYOYDFNOQO9HFZXVWTWXVSTGQHGMLESYJPMH9CJCZPEKMJVUPGELRLVZTTZKAC9GHLZCNVRQ9ITLCUDGGUJGCUGNCNHLAZIANRVAKHDMMAYCTCZJYGFOQPMOT9WJWNJJYBEK9CMEKSYFWDKENYTCIPEQIWDG9VHQINPFOAMQAKZPG9RTXSDGXWZRZJWGHEJIZLZWSMHBLHFFIXPQZOFFHNRIOQNJEBWZBDTZDJCUKSQDWR9ALZVDUEBVX9999999999999999999999999999999999999999999999999999NYBKIVD99A99999999C99999999XRHLMDZPZTK9DIVUOHZIVOOLNKFYRMOX9WJZVXCKRITLLRPVGZJKBEWGAZYCTPS9DDAZTOORMO9AFQLDY999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )

    # Spend transaction, Part 1 of 1
    self.assertEqual(
      response['trytes'][3],
      TryteString(b'999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999TESTVALUETWO9DONTUSEINPRODUCTION99999XYYNXZLKBYNFPXA9RUGZVEGVPLLFJEM9ZZOUINE9ONOWOB9999999999999999999999999999999999999999999999999999NYBKIVD99999999999C99999999XRHLMDZPZTK9DIVUOHZIVOOLNKFYRMOX9WJZVXCKRITLLRPVGZJKBEWGAZYCTPS9DDAZTOORMO9AFQLDY999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )

  def test_fail_inputs_explicit_insufficient(self):
    """
    Specified inputs are not sufficient to cover spend amount.
    """
    self.adapter.seed_response('getBalances', {
      'balances': [30],
      'duration': '1',

      'milestone':
        'TESTVALUE9DONTUSEINPRODUCTION99999ZNIUXU'
        'FIVFBBYQHFYZYIEEWZL9VPMMKIIYTEZRRHXJXKIKF',
    })

    with self.assertRaises(BadApiResponse):
      self.command(
        seed = Seed(
          b'TESTVALUEONE9DONTUSEINPRODUCTION99999C9V'
          b'C9RHFCQAIGSFICL9HIY9ZEUATFVHFGAEUHSECGQAK'
        ),

        transfers = [
          ProposedTransaction(
            value = 42,
            address = Address(
              b'TESTVALUETWO9DONTUSEINPRODUCTION99999XYY'
              b'NXZLKBYNFPXA9RUGZVEGVPLLFJEM9ZZOUINE9ONOW'
            ),
          ),
        ],

        inputs = [
          Address(
            trytes =
              b'TESTVALUETHREE9DONTUSEINPRODUCTION99999N'
              b'UMQE9RGHNRRSKKAOSD9WEYBHIUM9LWUWKEFSQOCVW',

            key_index      = 4,
            security_level = 2,
          ),
        ],
      )

  def test_pass_inputs_implicit_no_change(self):
    """
    Preparing a bundle that finds inputs to use automatically, no
    change address needed.
    """
    # To keep the unit test focused, we will mock the ``getInputs``
    #   command that ``prepareTransfer`` calls internally.
    #
    # References:
    #   - :py:class:`iota.commands.extended.prepare_transfer.PrepareTransferCommand`
    #   - :py:class:`iota.commands.extended.get_inputs.GetInputsCommand`
    mock_get_inputs =\
      mock.Mock(return_value={
        'inputs': [
          Address(
            trytes =
              b'MQAKZPG9RTXSDGXWZRZJWGHEJIZLZWSMHBLHFFIX'
              b'PQZOFFHNRIOQNJEBWZBDTZDJCUKSQDWR9ALZVDUEB',

            balance         = 13,
            key_index       = 4,
            security_level  = 2,
          ),

          Address(
            trytes =
              b'TNNTKUYYZVIOPMQHXIYKKZVN9PELGAKAUUGKCBYR'
              b'QOZJT9NLVDEVFQXIZKXIF9MOYTJTDTOQJYQLQKXQC',

            balance         = 29,
            key_index       = 5,
            security_level  = 2,
          ),
        ],

        'totalBalance': 42,
      })

    with mock.patch(
        'iota.commands.extended.get_inputs.GetInputsCommand._execute',
        mock_get_inputs,
    ):
      response =\
        self.command(
          seed =
            Seed(
              b'TESTVALUEONE9DONTUSEINPRODUCTION99999C9V'
              b'C9RHFCQAIGSFICL9HIY9ZEUATFVHFGAEUHSECGQAK'
            ),

          transfers = [
            ProposedTransaction(
              address =
                Address(
                  b'TESTVALUETWO9DONTUSEINPRODUCTION99999XYY'
                  b'NXZLKBYNFPXA9RUGZVEGVPLLFJEM9ZZOUINE9ONOW'
                ),

              value = 42,
            ),
          ],
        )

    self.assertEqual(set(iterkeys(response)), {'trytes'})
    self.assertEqual(len(response['trytes']), 5)

    # Note that the transactions are returned in reverse order.

    # Input #2, Part 2 of 2
    self.assertEqual(
      response['trytes'][0],
      TryteString(b'PNOHSCLHTDHBNES9REFELWTCKSFPFDPQOEEUKYBXFMRSHAAXBWUXMD9QNSQUWZMOBGDDAVIIHWGBLWIKCLTPZDVYRHYZWWJUKNWOLYDWRTRBOVMXMFJCBEJVMSPBQJQISISHSRNKEZXSOZHZISSMLCMCOBYN9DWGV9Z9GO9QEHNGIASTVPGWPBYQORFASXYDOTMJZVEJHZZRJSUDDTAFJDQFCZKFKJWEPQARTHCWKDWKITI9ZDCRNUWJQBDZZMRYNBDQPHJOCTQKMSFFCXGM9NGNGCBTUEEPAVOXDKHQNHSSUNA9CLTFAUIHSYPIESEVC9YWAWEBKNVAKGKZWWGRWYYPPOLTSOGTKEPCQQ9PLDDAMKGRPOHHHDYCLOJVBWWDTSLYZHKLOZBKHPCOUFPIBZQ9MOHHKMSRTXGXHERZREPSSAASILWCFDUFPXOKGTDSHWRBZSQSNCYFJZJTB9DGDJYISY9EZPLHJRMIQARDR9SIEMDYSBJXMWBGGRANNSAI9A9HYRPG9JEFFTIFSMJZHQWXXTABXPQXYOLTEFDAPZFMLTGGXCVPL9ZNBNNWVLMUHAXAWJNNVBPTXWNTFNQAYDBVCQSXJTPXABKG9PYIJEZRKSYBXTHGUSWORXZNKZNHIJW9KEPWANBKNNKOUKGLISUUTQRGMGHOQQDUUUWHFJQOFXXN9MOAOLSLOXLKPAQ9CRNSTKVRUMNLFPVIULPYXKOLDLARYUKLPMIEQYWSJYTYRMBHRHSPQJHJALMWUHLPIGQLQSXWDPVNIGFUOEMJJ9GIUVGNB9IWKIPBERFTPZOZVDJMBCKFTWLTQYDP9YHXAOU9DEEMDU9WBHPSRKFARYYCQBEKKQQFFTRUKJO9SECIZRQMMDOJZVPWSWWANMYVGHDCCGSKKGEGCKN9MYFG9ASYM9PEFX9DUJUYVTITKVMBKXWFTWUNVTFEDYSSTMWVGCYZIOCRKVRDGBPOVIDPAGIGZJYNI9TSAJCOSGQYQOTIXMBQXDGJTDJCIGKNLTZNEWEELSAXWYEBYCZILJWPKCGFHXTCDRANRRRUJWRIKTHQJNSDLZJTSDPHU9UMRPCHKJBHTYSNGIARREPPIMULJXFIATTWPQAAYSDSBTGYATXNDDIBMQEIBIUK9YAUPNBMKMZSRHK9UGN9YWOVMTFCSZWOMWHUHPYUMWJUNDMMVOAQUBQDLJLMCXFQEGBSZABKVTNFAJTLGVJ9VHAQGD9MSDYLOMCODQJIEBZARCRFVHFIGFFZRZPBFVX9OMHAAIXFKXWC99RINEESNHPYSFWESSKP9AQHJHWUPWYOOYVKFUNKXPXSKTHNWNULCRUMIHBJNAIQNGDLQSXNWRILYVJMYSELRBTLDYELCZVSVTDNVOHFXLPN9NDPSKA9YHVFRGPAFAKNOXBGWNRMYQCFCSMIBHUKKTNQBDDRQXZLWBLHRYTWSMJUJWSPQZPSBQTAZBVOIVIRXKJPSXNRB9ILEUAMGJKDGOEGVGOKFDKWWBRF9BYDQUYVEHFTNJQDAMEVFHQLSU9XTGFPOGGOYWTZONFSZWODUOMKA9AXWWIZL9GMNIXHWNJFHNONJUJGMFUGPAAMHZLXBOJFLJFHGNNWEU9DS9VKVBNVIUDXXGDQFQSNLMGWAMPETROFUFVCDMCARZAJICIXAVAM9YZAFSILIPOEOGHZ9TJQTKRLGTQNWFDAEDHZIOAMRHNUE9ANKIYKEKWBYZWFVUMKFTWBRACWZUWZSGWGWTAPXIILCFMLLLGOLHVVUIGRPO9CRDXECHIZYAJXXECRBMLNCYSFOH9PNJ9UXOWBGCYIRIAOI9VVAIYOLHTLBYEKOYMOCSVBFCHHCTGIBOUDCXXXKGBTWVBCAVOUQVOZCUSKORPYWBXCVYYBVFWSZACWFLRUWZORZULS9RNOBKHRQTR9IYTKFVXRWSWERUECAHVTAKTTSN9VNZOLGJJGAHPIJZQBITVDSXNXZTRMIDLH9XFIOEYUVJWIKLLEAIYBOFFUPCBEMMXBDGTZDICOBWWQ9EBAMLPQNHNHKDBZHACQW9GDQQQPSAWIAYLWWOYDTDRXKCNIWFXZRAXNSGDUSDTWTEFANWWTSAJQIVJQZGPXHUP99LYTNIESJDUZGHEELFJGSBLMEKJBRABTBZASNKLSAUB9GHHIHMJZSGJHXKWMKIJOQVBTNNTKUYYZVIOPMQHXIYKKZVN9PELGAKAUUGKCBYRQOZJT9NLVDEVFQXIZKXIF9MOYTJTDTOQJYQLQKXQC999999999999999999999999999999999999999999999999999999NYBKIVD99D99999999D99999999YBPL9FUHMJAALACSDMDFUKKBTUPCHTXNCASWTZJZMYLFPJH9MWDXUCNGAVYJWFFQNHCABKYIQBTJWSZID999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )

    # Input #2, Part 1 of 2
    self.assertEqual(
      response['trytes'][1],
      TryteString(b'MJ9UDTLPAAOHPYNXBLEOLLHTXEBTGAKYONGZUFJAFEDKZYUBAEDUQZMAMSYKPPWCGBK99QAJVXCDXYKJXTQFTG9BSWEKXKWY9ADZVHAMQQAUCEOIQPRULPHGCINEAI9ORHTTCEHU9GPIFDYMOZORWNZYUZNEFGF9WYRBKLSAZTXIFKODGYAMKFJODJRWMLXUFQ9WFJKLWT9TAVINDIALUWQIZISLXDOVKGZPIYNRAQYWRZW9AFCEMTOBSHJEEYN9GZ9ZUULYDHYNEQSSETKYZVQYRIPNRWGRBCFLHRUAKJODCEMYRFBP9EVFKXL9ZTERUVFCXNTYFJBHN9GUGYDTIXXTKTEWSDM9POVBSQSKGBPSPTLAZQ9SENKYBEHGHPXVLI9UJULIDA9KXVRRQBKKAQM9QVZ9GEOUMSMMMZSBQVAYWUJPUKCLDZBHDQIGUK9DOADAVEO9GQTVHLMPXSJQZHEYDCCDHTWKPUEJBAIQ9ZDYLLYTEIBCFZKLZCNYEZULRNSUGPTXZBEWGFVYRBZLSTRGCYSTML9ZGVNXJAQTDASQENWWGBAPNCZHQOQWDXWSUCYDDIDIXRUJXCETUDIDBZJZTNJG9GUDYYBLHRPSZORPOITTJVAGNTPKFURHWMGU9E9DSQQCVAEYEYDPZWBUVPXAFGLKZZWRINYOVSAZCINPQSUKCFDGDSRCCLKLGGOQIJQWGCKTLRBQOQMGSOVYGBVACOOUFINHRQGQBBDWWMVJTEZJEBB9LD9ZNUEYBFRKUZEFT9WRTZRAXQPHHCNGBHRERZDCBCPP9JQ9MH9RBZPGSL9HJBDHPL9WHKCRUVHFWHJSJFWAWEXCTHU9OYKNPBUMSIMONQRHWDIQXETDHT9QGSNPXGTDNUCCFHCJONIDIJADUINVPAVDZQJNOQJQPBMOSCHMPEGHGPMHMRUUWURB9ZPGENHERLURYWLTVVR9GXYGCDCNZLVWVRPKVRXNSXBGDLBBKVGUAJUGGNUYVJSWHKVYT9LYFLVMNBUJDBLVXGDDIJAQKPGUHRTPWNOTLUKDMXGP9BZFKGGJRRNOUNBWZAUZSMMVGZOKGDJEECERVCMJKXHNLFTI9XCZQXN9WGGQMKXXQSIDSXT99KGAOOTGLDJHCPQJPLJDCZQAGRXYADFXCFBCXQGEVEOCKEICIVKVOMKGBXPZHQ9SXDXBFZZI9THLXOPTTGTPSQJTBBC9VYZUXWNENXQRVGKDY9JWCYNXTSAOLIDCBINWLLQDUNYAQRHAZBBROWSCMANZJZYCKZGAVQEI9CLDNKFDXWZMBMGHFEAXD9CW9WHZJ9LTZWEWKETMHHYINLADMLTQEQEVAJOVCZBHEASNWRATZNQWFIVEIXAJEBPLCRYA9JCO9XJPSUCKISZ9FKXVYDLRIKVIFISWWEXMHEREKXIUBFTBWWYVRKWJOPPVSYTZZRLFWAKHBYETICAKPPAJPADYVSFXSY9IVADYPWTULJOIAYWCUBBCPJBEVWIFNWDSWGVZSFSFFIIEJXIVWJDNHJKXPHTRQGWMVYOUQYUZQWNEHEXCARMOKYQSKWEJKKKLDGKJBXQKODOGJXDSACUDHVREMWBSAUAAKUYVAHTUGVSUEVLWRFYTURXKSVRMTFLEEGQUORVNPXEHTIJIGC9MPCOFKARODEORLUGHDVFXVQZYFFIXBSLWVVOICMPPFIEK9APVOCENJ9DFAQ9CQ9LUAQVSDNSYKXBCSLCGYOIVRGRGUSBTBIMSQTNQYCZ9TFARMHY9XXJMHFUVDWOYRBNBSADQTZAKRLYQFVAMSCXBTHVWPFJTVENWKHHOCURLKGCCGK9SKGFIASFHPTJDGKOIRSKNCODYCEBSSCZNZAMSOTXBCFPGLNJHEPJOP9IIIZXRHTMFEXXZUVKDXTEIUXKBFRTXZTMGSXRWBQQGKBSJWHEXVZL9EKECRQQGWG9OTMQSBBAZAMBOHNGVDBM9NSXMRDJIEOOYLISNGNIVKKQHWC9ZIPWHJUWCXVQZOMRKZ9JCHAXS9RZWC9RACAE9EKZGJHYNLWPMZYDYP9MD9YVA9RCWHMFDRVEHLQV9RORXMULAKDOJOZBOYDFNLTUEJHIPL9CQKTPFYKBUREGDWUAUMZUXMCJFQMZUZXLTGZSDTLW9DFFWGKFIOODTMMXMCQHRNWRUXCGYQGTBMR9NQDBTNNTKUYYZVIOPMQHXIYKKZVN9PELGAKAUUGKCBYRQOZJT9NLVDEVFQXIZKXIF9MOYTJTDTOQJYQLQKXQCYZ9999999999999999999999999999999999999999999999999999NYBKIVD99C99999999D99999999YBPL9FUHMJAALACSDMDFUKKBTUPCHTXNCASWTZJZMYLFPJH9MWDXUCNGAVYJWFFQNHCABKYIQBTJWSZID999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )

    # Input #1, Part 2 of 2
    self.assertEqual(
      response['trytes'][2],
      TryteString(b'EOWARUTCGMPDDIK9HLSBJUNJNKFQ9W9EHNWAWCVBOWZNPDPI9MDARRBMMCQTVNYKQYKO99FJY9ULJLRYZQRC9XTVDAFGNRNJHXBWCUQEUNJKTCXKIPHQWRV9KAGREYBHXIUFNS9DIQWJEN9FEAXBOZDNHSCLOSGKTDFLVVEDDRSXKSFOAIIDHDVEW9YWNQZQUHGCBYDZUZGINOLCFKHAPPSYMEIGRHZUVP9BLFFGHYWIOLYF9DXXYUKVSYMLDGMLKDEVERGZ9AWDXSOTVCWQVES9H9YE9LJJJQJCPUVFNCJCVHPAVMBVPODVWGZQJ9ZQWITDKH9DIRSGNGN9ZYJPVZOJAOXOPOQSZCSDILTOAUUMLGOIYG9MYSYBQUVDDDBCFTDWUMPXUDHZBDBAHTUXZWINNALMYDJHGJLCFCJ9KZZNTFPZGSLXGEVEGOWSOUAFBJAY9IOEVNLHFTIWEFURULVEFSDURVWBMNUTNAQAX9NYD9BSA9XKUOEKSSVI9HSAIXLG9PCZKWKSLGOBRKGHSPCTREBYTKUBUWRCCHTDQPFMQBIKTAVXVOCTGUEZCEHGXOGSBYYZFQ9WTBUKSJEUIXJVCWBWQILYUAZ9LBXRRQCQWGMEMU9YNU9RYUBEJQYDZOOFXBLWBRLIGVP9RZKMLPDCMKBEHY9CUBUDVPFHLOFPFOEHUCFFFKQC9NXTNDHGSVNVONLXUZANIAOUWDOUY9LFXGFFBFYPECHONGIXDXXRFAXZIJIXZRTXOOGLZKUVNPDSBSQPWZIOWQQQDQHZJRRXMPYVYHFAPYLESHJXJDGYHOGZUHDWVIXGJEIMQAQACAGJXDESBXPMZM9SOMNEWFVLWJHHBPQRCXVXDGQIAPNTPWNZEXTBZJGSKRXKJPMWPUSZYVUGRJHFHQBLLMGXZWWOQME9PUUEAQNZCZNNGN9LDHAQMDXTSRV9LDMGRXBLUIDEJPIDT9TZDHWYQZQWCUVKTUZGNZ9RHIBWMQNFRQL9BDBRACLIVCWLNZQNEADVMHAYFLMTGZSYRIZDWIWMVGU9TBFEC9XIHFK9GMGVGYBADQBGMQB9IWKASSSLC9OWZG9AZEYRPMHQGRCFKUOPEIOZXUHTUDDLIRHENPXFWOQMFBAKZHKOL9RZLCEKCFTOHWWTBVFOWDKUDWSSMDZEKPEBQUIE9TUSDAMHIRKRGHOGRURYOCTYSDRLIZIADWXZRPCBVHOFZCJLZTQZLPCDRNGBREQTKTPMWVDDNLKYPVCUGPBAQBYCQGDVOKBGMX9WHKNEDIJXEPIKPIQWZVO9UVYVG9QB9KPNHIDAMHTVVCHVKAJREZCZETYPQFKRCNDYGGLDYSMHBTUXGNFPHZVQOQQUBTADRQKZCVCVIABGGNPDGBVWC9FBPHVVUFBPPBBCLXLKYBFH9LH9AVKBIFKSPWZYKQPRGNKMAHQCTYFQWAKIY9KYSCFGZTTAOGWPMKDMQGQSVANQL9YLOQCCIATBEEOTELNTXVJTLOTZUPYJQEAQMDCCSU9ORYZBQJULDQVXPMDNBWFXFPEBIE9MFFPIIWKXDVCPKDGBJFWTICOBRUNKJEFBKXAAFWXYPSCVFRLUVKDSBSUYCIV9UPLJTFYWGFJ9ZFYNOM9YXMHOYWFDDPIJOMTD9KGA9XCXGQHLZVBEKEUWLSC9BFSUTFJGTUHNMKOJ9NQC9UXJXFQSBDOUZRTMPOMURVXUAYGFLGHNKRDDTCASPTBUIDLUHH9HBQHPBRIUICIGNYMGPVNUPIQZOVFHLTAENGAYPWLCQE9DQPLMNPCJUFBPKYGHPHBRTALLMFUHIATKTSQBNTHGRCZILLNCTSZKJHQNVYZ9LOVYYSEXJDBHBBXEKCJEUDDDTUBLWCWWRRGHSZFMJIIEMVABUFNTNLWMVYG9UUVONDX9AMEO9WEPWAJDLRISKO9YCBIYQGGDMJDFDERJNNIKRROFSVLEBYFRJJOOSEWWBYMTIQXBQBYMSFAFBXPMVZAKU9LOGBEHKMOZDMSYXRVEZHPPZPKWCTEEAPFLHOGHJPCFQFLSFHTKRMZEKNEYHQZHLG9E9EUHKKUYSAQTOZWVPQSGFPRAZT9VSYKWRBEEHWPDJUKDCDXUCQCRAGSNAMLCSFOBMIRJFINXNGTGHXSRGFQCI9JFWNBCM9WDEWDPDGMNXMNKLITPRVXYHHCMQAKZPG9RTXSDGXWZRZJWGHEJIZLZWSMHBLHFFIXPQZOFFHNRIOQNJEBWZBDTZDJCUKSQDWR9ALZVDUEB999999999999999999999999999999999999999999999999999999NYBKIVD99B99999999D99999999YBPL9FUHMJAALACSDMDFUKKBTUPCHTXNCASWTZJZMYLFPJH9MWDXUCNGAVYJWFFQNHCABKYIQBTJWSZID999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )

    # Input #1, Part 1 of 2
    self.assertEqual(
      response['trytes'][3],
      TryteString(b'UZW99YV9GMPLXSPRTMJFFGOVNMUNUIPSIJTLBUZT9YCAXBKRWYDVKOMTKHW9STWCMHUBUQHZUGNFMALYCPTSOEEYANVTHWJRFHRYJ9D9JIBDVQLTQFDBYLXBJWAEJPPRHOXSZP9KWKNLQCUGMOKMHJQYODRVVYOZ9DEGJAFBQNIXYXJ9PFGAMZXOBZDQTKQGSTLSXEJBJ9IXICGUFPONWTRIPZXVUAJQIRXYMKONHSEFMCJML9DGQRGLMGLGKEHWTQZWOMIZIF9FWUUMVVWS9CWUMWCHZIRKTODTRLEJTRNA9CCRFJNCVCDCQID9UDQJHGN9YIFJZEFEDVMT9PUYWCABIHJMPNQTSQQEJBKRVQYLGHPYRCOLWKCTKMPFCMOMC9PABJNHFPNJVCYNPAIMCFDVHWOEJIVJOIKPMTCAQZZEFEL9YSOSRWWGBQEPFJNTLVWOXIEPZHHCIQF9DZOQGUKYOJSIFHARSBORDAJRVCTTIEBUD9ISDDLULQQQPHZJTNXOBSDGDWRGCBURMWUP9XQTYIYRLCGWGIWWDO9SQLQIUZOGXQQOZ9CZZINSZAYSLXJHVRQT9DGTLTIERBHIEYFGCHLFUEZJHUUKCZKRCOWSTYIGNFB9TZACBURMAGZQIPEKPHUZ9HIYGWZKOEECUJPKYFXMW9TDITMEOBNNQVJHECBQPXXAETVTHCYCKJGEYVSMWRAXBREMDKCHHVPAED9DYFFSRP9WOFAARRNLONJDNYLCBDKPUM9HYKRURNIOFJBIDJBKYNRVZKTAITEWNMZLA9XMJHIPNUJDWQ9ZRDBJXNZCXADAFREDEDG9EVDYWVFDOEZNFJKJVEXGVSUSOHKUFIGKRZWCVDAWBHVIAEGRENQJSPZMSJXK9VDSLNPWFEVZPFD9JRSV9YOOTJHYKV9ZWKPGBEAPATMINAESECJXMULWYQUENYNTAEYITFUZOTFXVCOWTPMCDKWBYOPWHJMUFRJYQNJLIXIBQHYKZTVGFRDMENVRUAGPBXHJEDVXPEEYWHALUAIFUCPTIFBHMYXSSYSPWOHRXDIKGLRHRHKXIOPBQFQBHQTKGPMYL9THJFRGIFBY9WKIMQSUHKUKFQRDHFUBGPWZNE9SWREBKNIOCAZXFSKEHYBZPWOLDTPVUNVUTURRERGDVEUOCE9NDEHIZWRQCSNUEWYMOAHJGEARXYYLGJGQGASBVJAYZCCUTXIFIHQUMKI9MPRXRZAFUYYSPZQWIDLHJ9NGU9WYNLNRWYKNGEZIKGSZEXL9BVIUNFUWMDLONJTFIIXWUETTMSPBUGHYTHJTJCCXQXLGMHUDJEBVQPCHKYTXJQBBIGRGRWPYCNCYRIOMNSCITUCWHIVOMKCXIW9UZAXRQLKUEH9PZBVPHB9VETTZWFIDEWCHJIHW9QVZHPVUSAEBTLUENJAMSYSDVNPVEDXJBGYYBQLQDXLUEAFJMDYEGDKRTUV9DCJNFZZSFMQX9DCZ9LQLVDOCNFDSNGR9PP9CNHAIAPFGVUUMSMOBUQJWDBAFJXHLZFZOCSK9OQIJYFBRVREMNRJDDHOPPITCXZYJYEAARBNUZYBVETPPZHMFCOIQLJRQYDZYBZCSHERQOZDKOSZWP9QHWMRSYESTDRPGW9HZKKBGHHPBHAUYXLE99OMBYHUFJUYGGWVUEPUXJVEVAEBFJRRFPTOIBPDXSIVJWPZYQVXY9VF9GFTRNRBZEHWFSCNUPGETVYGEJJJQEVFIUFMTFHMDWBTEIWFXGERGZLLMPMKNJSI9AGNZNXWYTJTXLUJHQHAUPZZIAXKCBAECERGTBPCKQZEGSRZIZTYRULGOAXETODFXIKBEZQETMZ99LLTUMLYWA9DREHWALIM9AYCBQQFRNNHUIKVJVIGTGIF9MUMSYJIZJAPOXHIFXH9PPOUOGAQWAKFGXNJDDISLFELAOKYBHMJUYHKXNZQAYWPHPICVMMQOSNOJFDOGPOPMZITNCRT9EXZPRYGOGDIZBWXRNLCGJCNGQDXYYGOFBARMWTPNNTLJBHHPKDDBULTHKEHDTTZUETG9LWVQCRWADOQFMIF9GOCZKBZSWECWORPZUXGLO9WXIZ9QOBANDWNBPMHBGCJ9TLS9WKPGCAJDPBUNU9OMCKMZJVLTUKPZLD9HYOAFKBKLFEVPJGPAVNGRMDYYBARNZHRKULBMQAKZPG9RTXSDGXWZRZJWGHEJIZLZWSMHBLHFFIXPQZOFFHNRIOQNJEBWZBDTZDJCUKSQDWR9ALZVDUEBN99999999999999999999999999999999999999999999999999999NYBKIVD99A99999999D99999999YBPL9FUHMJAALACSDMDFUKKBTUPCHTXNCASWTZJZMYLFPJH9MWDXUCNGAVYJWFFQNHCABKYIQBTJWSZID999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )

    # Spend Transaction, Part 1 of 1
    self.assertEqual(
      response['trytes'][4],
      TryteString(b'999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999TESTVALUETWO9DONTUSEINPRODUCTION99999XYYNXZLKBYNFPXA9RUGZVEGVPLLFJEM9ZZOUINE9ONOWOB9999999999999999999999999999999999999999999999999999NYBKIVD99999999999D99999999YBPL9FUHMJAALACSDMDFUKKBTUPCHTXNCASWTZJZMYLFPJH9MWDXUCNGAVYJWFFQNHCABKYIQBTJWSZID999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    )

  def test_pass_inputs_implicit_with_change(self):
    """
    Preparing a bundle that finds inputs to use automatically, change
    address needed.
    """
    # To keep the unit test focused, we will mock the ``getInputs``
    #   command that ``prepareTransfer`` calls internally.
    #
    #   References:
    #     - :py:class:`iota.commands.extended.prepare_transfer.PrepareTransferCommand`
    #     - :py:class:`iota.commands.extended.get_inputs.GetInputsCommand`
    mock_get_inputs = mock.Mock(return_value={
      'inputs': [
        Address(
          trytes =
            b'TESTVALUETHREE9DONTUSEINPRODUCTION99999N'
            b'UMQE9RGHNRRSKKAOSD9WEYBHIUM9LWUWKEFSQOCVW',

          balance         = 86,
          key_index       = 4,
          security_level  = 2,
        ),
      ],

      'totalBalance': 86,
    })

    with mock.patch(
        'iota.commands.extended.get_inputs.GetInputsCommand._execute',
        mock_get_inputs,
    ):
      response = self.command(
        seed = Seed(
          b'TESTVALUEONE9DONTUSEINPRODUCTION99999C9V'
          b'C9RHFCQAIGSFICL9HIY9ZEUATFVHFGAEUHSECGQAK'
        ),

        transfers = [
          ProposedTransaction(
            value = 42,
            address = Address(
              b'TESTVALUETWO9DONTUSEINPRODUCTION99999XYY'
              b'NXZLKBYNFPXA9RUGZVEGVPLLFJEM9ZZOUINE9ONOW'
            ),
          ),
        ],

        changeAddress =
          Address(
            b'TESTVALUEFOUR9DONTUSEINPRODUCTION99999WJ'
            b'RBOSBIMNTGDYKUDYYFJFGZOHORYSQPCWJRKHIOVIY',
          ),
      )

    self.assertDictEqual(
      response,

      {
        # Note that the transactions are returned in reverse order.
        'trytes': [
          # Change transaction, Part 1 of 1
          TryteString(
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'99999999999TESTVALUEFOUR9DONTUSEINPRODUCTION99999WJRBOSBIMNTGDYK'
            b'UDYYFJFGZOHORYSQPCWJRKHIOVIYQB9999999999999999999999999999999999'
            b'999999999999999999NYBKIVD99C99999999C99999999VEUNVMI9BSZTFZMGEZJ'
            b'CPMPOTRTUR9PSISHCXAESJQU9CEYAGXVHBAXAFRWHQNAFHGNID9BAOMKSJJDEO99'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999'
          ),

          # Input #1, Part 2 of 2
          TryteString(
            b'ZOJNUMZOBEHLYDSDAVZKXHF9MAHAJICBMJTZZHTQTCACVQAUSSCFUMGCSJTONNKX'
            b'FINPOAXQIKSJ9GUV9GXM9KYDCDWUHULIJMSKMOLDZBYE9FTGFMKLODKHFF9YUCPT'
            b'YFFM9EDCJDCKRFLZUHGGYNYFJLBFWXCIUF9HMGUQKPUCJ9OQ99FXHSUSRRBEUSSC'
            b'KCYPIEAFZJQNXEUYWLEXKZWLRINBEGAZTJMYTUEQTTORMIIQASISHSHZDQJXANFL'
            b'KOIRUEJUPZZHUJFWHEXFIZ9OU99SQLDDNLARDFPGYSCMXQCMGPRB9QLM99QUBLTL'
            b'TKWYXHVAFUVVAMHEYCCNVEITSPVQWMSEIZJSLPWNGWISKWQNXCNRNOIGRGUHGYWL'
            b'OFNXBDCT9JLA9CEKW9BFGOESKGOQLJBTLUMOICBEZDHCR9SZCJUZVXIEAVITFJFD'
            b'GNJII9LSW9IQKV99UJWWAACGIRPCZUENXGILUXCMJIGW9REUNA99MWSANWL9KVKK'
            b'XCKXLRGDT9NXIGQVZWG9NBQPOQKEEET9ZUSENFPGFDNNHGBITCPASGHOPBNYKKEH'
            b'KHVATNVWX9ZGTISUKPKTMWMPCGVVJSGMRJWNFICSFUAVAHIZWA9PDOIXFJGWCPTZ'
            b'HUDDUFJVQPBYNJREQ99UHOESTT9FELDMVK9VHZYPRVOWEW9NXTCYDCIMT9UIWGXU'
            b'FYILOPOCJFVVEJEJN9ULGXIABFJWWRKAD9NHZBULMWUKESZLCPRQVVKWOHEWSTLO'
            b'FNA9KNERURWJPROBBXEWICDKKCQXWYMJUCQLWEUPFXRSNMIJWQUEJUNIKDYJILXC'
            b'GCLFETWOZYIUZVJVYVB9YGXSSDXYXSJXTOQZ9CCCAKMCNNKQCYEDGSGTBICCOGEH'
            b'RIVMICUQPUUFRFCBF9NUUWSQBTVIYFVWAASTQJZFDDWWUUIHPKTIIVAGGIEQCZUE'
            b'VOFDMQLDESMQDPQUSOOKZJ9QLXTAFPXXILFHFUIFJTKSEHXXZBPTZUGLYUZNORFO'
            b'EKQDEIWGXZPBXSOGGQFILUJTKDLWVKPVISU9QOATYVKJHLDLOKROZNFAGS9CICXX'
            b'IUQQVLLRPPPDYJVSCW9OWIHKADCVSKPWTENYEWQWEHP9DDWOUJDWSTSOGYQPALFM'
            b'KCTUGLSXHNYETTMYTS999SYQVQSPHQPKRJSUY9QTABAJOJAAMGVBCSLAAOBXZOJZ'
            b'LIFXUYOVXBKHPFVTKKGSIHUXMBDTMGNVL9NXYCHOVTLGDICIWTCIGNRHLBZBVSXM'
            b'PBFAWIXPCDJWNDUFHUVLBSPBWICZNYIUJPRRTOCSSCVPNBXEDCMHKFVDMHJTSP9J'
            b'I9BXTD9ZILEEOCBMHCQRRDNL9EUKJGJ9MPQGQU9ZFYGVSNOYAEC9NWTCVEJBSXLY'
            b'WTUPMXNAAWXSBIAJYSGYHGLYOMAHFTYMICZRDZTQXHAQGVXENKIGW9XZTPBAIMZL'
            b'HWAJCGY9ZDNQOTGDRCTXSJCEJVTTMVRYYKWAFYSV9WVEVCFAXJKJNUC9NQHPEXWI'
            b'OHOJQEXJNLEW9GLO9AJCJXIEXDONOGKXFJ9OXXXETUEHLBXAJGFPHKAQDCRTKQBX'
            b'PZYQZBQODTVIBUTSAEXMBFBMTAXOQZCOHWEWRJEKNKHZXXSO9USZRWUPZAASWDBX'
            b'OVAEGSAGYDIOZWSSEAIQVRWFDSOXSRRRQHRCWDJWZXXJOGPZRLKQOA9DOY9RXZNW'
            b'BFJTKUOVRRQNSDUOFGCUQNHOBMJSFQZXVBPHHBRRIXZNLXAH9P9EFMGRPGSCFRZI'
            b'NEPOQPXPKHTSRJWARXRGJGYMTPUKQISLV9GUC9VTJLOISKGUZCTZEYNDTURLBPXG'
            b'NQLVXHAHUVNGIHVMZOHLEUBDTRFXFXXVRYBRUF9ULNMSZZOZBYDJUWTMHVHE9EEB'
            b'QYSNWECSPAJHGLTEUCXALBRVTKMWSWCBPUMZFVSEEFIHBAGJVVQV9QLFEGGYVPNS'
            b'DOBZEQGLEFLCQVPDJA9MQDRHYNVZVNTYNJ9GJCXKED9NEWTD9RVMNA9HOHUBLLAS'
            b'NQSDLDZKOMFOEGBJZPYVYZCVHYFEGSVEHSWV9WAGMEQIUDZQZUACWYQLTD9LHBVK'
            b'KNXXXDWQUWRJKTCDP9CEJOHLLPTWCIKKHHIFAFFDVMFZR9A9LYVMTQAPAXAVPJOZ'
            b'KWFQNAJTO99TESTVALUETHREE9DONTUSEINPRODUCTION99999NUMQE9RGHNRRSK'
            b'KAOSD9WEYBHIUM9LWUWKEFSQOCVW999999999999999999999999999999999999'
            b'999999999999999999NYBKIVD99B99999999C99999999VEUNVMI9BSZTFZMGEZJ'
            b'CPMPOTRTUR9PSISHCXAESJQU9CEYAGXVHBAXAFRWHQNAFHGNID9BAOMKSJJDEO99'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999'
          ),

          # Input #1, Part 1 of 2
          TryteString(
            b'OGTAZHXTC9FFCADHPLXKNQPKBWWOJGDCEKSHUPGLOFGXRNDRUWGKN9TYYKWVEWWG'
            b'HMNUXBJTOBKZFDNJEZUKCKWGUHVSU9ZJYAVSQSOFDCOIEP9LCXYLTEFMCYUJAAHL'
            b'YUHQP99S9XRWHXHRPZCWHDMIDYW9OQAWUPTFMBTJGDCWRVNVRDPIWISVYNUDWUGB'
            b'PNNFZDWRVZ9FGAVSEWFXRXGGLXJTPJTJLC9JYHMFBKYAUJRAMHQHKUUZHRWZIVC9'
            b'KFEEXXVNEXJRYUSFV9PEPFUDCNRRTSCZXSTUEGJKDV9UCYNZSBRDYGOKFGYKWVFC'
            b'YSWBUJYVGEUXWTDGPWTWURH9RKEZRFCUUBFBPKSFONMDXWGYKWAUWVUOQVBIGQMM'
            b'KQVDYAZ9SVFIUUNMHOJGRQVXZGIIPKVNNBKABGKZLRNFK9KSIHTCGYPVCWYGDS9O'
            b'IZWLNINYRLGJQCUBWYMAVDWFAURLALQPMRMFRAZCMCPOWM99SGBVEZPAFAXHXNEN'
            b'NWXLF9ZVHZIDWBLFKVWKBUYNBXOXTVPDWAGZXIOMDAEKNMRFGZVIGIFOSHGMPIPW'
            b'NOWQDMHPKOJTYYECKNGCDDTJVALGPZSX9IH9LEGQSDACLBWKNXUW9BAZSHAISUJD'
            b'TPJDOASLVRXFNJJHXQTKMKZUZIMJFPOKHEQXSCJQH9JPRNZHDVVZKWTHWWFNFMHF'
            b'XPUIEEA9HPHJTCJJWZPUHKAAWJQQSAIF9HRETYYPXAZ9YCFJRCXTGCOLJQA9HDLF'
            b'NTVDMYPRCYPQR9MNBBAMGOJXPRFCUSIIZN9VROZDPMOKZBCILKGB9EPCXOYWLPHF'
            b'XTYBCMLRVHWNQDSQUIHHTAUTZCJFQ9CO9GTONKYKMDBSREZC9SUBHYK9JDOBYDBU'
            b'BUIO9TRXQLAYHDDSXGJ9NB9FKMUUUS9GANWVMQLIHX9MPJGLTAOMCZTQYDYVOWXH'
            b'GHYCV9VDCXHGTCOOUEXIITVKHXCSUSOIRTMEAKMTYZCMAWURNX9JOVDICICKHXQY'
            b'BXKWTXWXBZVZWRIDC9YCZVSKYIKJYYMFYQRTWBNJHWXRL9JFSZAXJYYTGDYLTHLW'
            b'RMBUEG9QTGNRPVTBGRYFPEJQSIWTLPGV9CCMCO9TCKLKSJEAMFKQMXEYETISVEYD'
            b'OSCRZ99RFDPUQPHMQ9NVRUBXITDGFZCYQNFCSULGRHPONWJDVWT9UELEKEPQEAFK'
            b'DLDNYPABC9GUASVFJBFZF9Z9CHIUNLJWHKGDYKADLUCRNEPAIWYSX9LT9QWQRKU9'
            b'WEVDPKSTSA9PPEVNTBNLN9ZOPETINXGKA9DCOHPDQMMOOOCKYVEZJ9ZJQRJHNCKR'
            b'FDRPHUVPGVGQYKZBLOILZTPIX9MIBKTXOJKVAYRLSXDTOEEKLF9WWZGLSGIOQZWC'
            b'JJHSBTXYWRDYVEQTCNUENYWDRLZZIVTGCXEAJDRY9OVMXJGCSQSGYFLGYDZUH9EH'
            b'UDQTCXLSDPMNDYQRZYRXYXKY9GIYOSIDQPXXHKJKDQLSCUY9FFBTPSTJFEFROCEX'
            b'FFYTFYHQROAVTYKQOCOQQWBN9RKJ9JJEURKTVOECYRITTYKNOGCD9OPQ9WDMKRPI'
            b'UNRAVUSLFMC9WZWHSESGLDUYHVPAX9YJOFTTFSKFHTOOQQRCPYZKTDVCUZGBOBZK'
            b'LVBVBCWTUS9XOBJADZYN9TMLGCKXEXFEQFQ9VDFKWVEWV9WGXPJHUBWYXGECBPQO'
            b'POHG9YCVXDWOXTEAOFBCEEAV9JCHUVLIRIMHXMUSZPOMMRBF9PLVLRJYTXTBANBZ'
            b'WFQWGNGFGXFOZ9YGMQSZFEJHLFZTTVHRLJPATA9TYCM9LSEWMNEUDNWQFLUXOFUN'
            b'VDKSNIIXCXVUYZZOKVYNNQDZVUQEQFWVF9EIQELSWDJXGMQRVUGGVBMRVGXBBPBE'
            b'BDVGZDBWMDMLPXYJBBRNOMKGPMCG9FTSLMRADFVPUTTEIOUCBLPRYZHGOICNC9BT'
            b'9WHJJJPDOSOMLD9EKRGKYUHUMMCAVHGYWOVQXFLTCXAAUDYKGKGKOYHLDCCQSKNH'
            b'JHPSXTJVTW9QPFOQ9FDZIDDKIVF9CDYGU9ABRESMDLIBONAQWFVGCNOTEDHBMCSU'
            b'H9GKYZPBX9QJELYYMSGDFU9EVTROODXVUAELBUKKXCDYNMHYBVAVUYGABCRIYOHV'
            b'ITGYROZZNQPTESTVALUETHREE9DONTUSEINPRODUCTION99999NUMQE9RGHNRRSK'
            b'KAOSD9WEYBHIUM9LWUWKEFSQOCVWVX9999999999999999999999999999999999'
            b'999999999999999999NYBKIVD99A99999999C99999999VEUNVMI9BSZTFZMGEZJ'
            b'CPMPOTRTUR9PSISHCXAESJQU9CEYAGXVHBAXAFRWHQNAFHGNID9BAOMKSJJDEO99'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999'
          ),

          # Spend transaction, Part 1 of 1
          TryteString(
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'99999999999TESTVALUETWO9DONTUSEINPRODUCTION99999XYYNXZLKBYNFPXA9'
            b'RUGZVEGVPLLFJEM9ZZOUINE9ONOWOB9999999999999999999999999999999999'
            b'999999999999999999NYBKIVD99999999999C99999999VEUNVMI9BSZTFZMGEZJ'
            b'CPMPOTRTUR9PSISHCXAESJQU9CEYAGXVHBAXAFRWHQNAFHGNID9BAOMKSJJDEO99'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999'
          ),
        ],
      },
    )

  def test_fail_inputs_implicit_insufficient(self):
    """
    Account's total balance is not enough to cover spend amount.
    """
    # To keep the unit test focused, we will mock the ``getInputs``
    #   command that ``prepareTransfer`` calls internally.
    #
    #   References:
    #     - :py:class:`iota.commands.extended.prepare_transfer.PrepareTransferCommand`
    #     - :py:class:`iota.commands.extended.get_inputs.GetInputsCommand`
    mock_get_inputs = mock.Mock(side_effect=BadApiResponse)

    with mock.patch(
        'iota.commands.extended.get_inputs.GetInputsCommand._execute',
        mock_get_inputs,
    ):
      with self.assertRaises(BadApiResponse):
        self.command(
          seed = Seed(
            b'TESTVALUEONE9DONTUSEINPRODUCTION99999C9V'
            b'C9RHFCQAIGSFICL9HIY9ZEUATFVHFGAEUHSECGQAK'
          ),

          transfers = [
            ProposedTransaction(
              value = 42,
              address = Address(
                b'TESTVALUETWO9DONTUSEINPRODUCTION99999XYY'
                b'NXZLKBYNFPXA9RUGZVEGVPLLFJEM9ZZOUINE9ONOW'
              ),
            ),
          ],
        )

  def test_pass_change_address_auto_generated(self):
    """
    Preparing a bundle with an auto-generated change address.
    """
    # To keep the unit test focused, we will mock the ``getNewAddresses``
    #   command that ``prepareTransfer`` calls internally.
    #
    #   References:
    #     - :py:class:`iota.commands.extended.prepare_transfer.PrepareTransferCommand`
    #     - :py:class:`iota.commands.extended.get_new_addresses.GetNewAddressesCommand`
    mock_get_new_addresses_command = mock.Mock(return_value={
      'addresses': [
        Address(
          trytes =
            b'TESTVALUEFOUR9DONTUSEINPRODUCTION99999WJ'
            b'RBOSBIMNTGDYKUDYYFJFGZOHORYSQPCWJRKHIOVIY',

          key_index       = 5,
          security_level  = 2,
        ),
      ],
    })

    self.adapter.seed_response('getBalances', {
      'balances': [86],
      'duration': '1',

      'milestone':
        'TESTVALUE9DONTUSEINPRODUCTION99999ZNIUXU'
        'FIVFBBYQHFYZYIEEWZL9VPMMKIIYTEZRRHXJXKIKF',
    })

    with mock.patch(
      'iota.commands.extended.get_new_addresses.GetNewAddressesCommand._execute',
      mock_get_new_addresses_command,
    ):
      response = self.command(
        seed = Seed(
          b'TESTVALUEONE9DONTUSEINPRODUCTION99999C9V'
          b'C9RHFCQAIGSFICL9HIY9ZEUATFVHFGAEUHSECGQAK'
        ),

        transfers = [
          ProposedTransaction(
            value = 42,
            address = Address(
              b'TESTVALUETWO9DONTUSEINPRODUCTION99999XYY'
              b'NXZLKBYNFPXA9RUGZVEGVPLLFJEM9ZZOUINE9ONOW'
            ),
          ),
        ],

        inputs = [
          Address(
            trytes =
              b'TESTVALUETHREE9DONTUSEINPRODUCTION99999N'
              b'UMQE9RGHNRRSKKAOSD9WEYBHIUM9LWUWKEFSQOCVW',

            key_index       = 4,
            security_level  = 2,
          ),
        ],
      )

    self.assertDictEqual(
      response,

      {
        # Note that the transactions are returned in reverse order.
        'trytes': [
          # Change transaction, Part 1 of 1
          TryteString(
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'99999999999TESTVALUEFOUR9DONTUSEINPRODUCTION99999WJRBOSBIMNTGDYK'
            b'UDYYFJFGZOHORYSQPCWJRKHIOVIYQB9999999999999999999999999999999999'
            b'999999999999999999NYBKIVD99C99999999C99999999VEUNVMI9BSZTFZMGEZJ'
            b'CPMPOTRTUR9PSISHCXAESJQU9CEYAGXVHBAXAFRWHQNAFHGNID9BAOMKSJJDEO99'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999'
          ),

          # Input #1, Part 2 of 2
          TryteString(
            b'ZOJNUMZOBEHLYDSDAVZKXHF9MAHAJICBMJTZZHTQTCACVQAUSSCFUMGCSJTONNKX'
            b'FINPOAXQIKSJ9GUV9GXM9KYDCDWUHULIJMSKMOLDZBYE9FTGFMKLODKHFF9YUCPT'
            b'YFFM9EDCJDCKRFLZUHGGYNYFJLBFWXCIUF9HMGUQKPUCJ9OQ99FXHSUSRRBEUSSC'
            b'KCYPIEAFZJQNXEUYWLEXKZWLRINBEGAZTJMYTUEQTTORMIIQASISHSHZDQJXANFL'
            b'KOIRUEJUPZZHUJFWHEXFIZ9OU99SQLDDNLARDFPGYSCMXQCMGPRB9QLM99QUBLTL'
            b'TKWYXHVAFUVVAMHEYCCNVEITSPVQWMSEIZJSLPWNGWISKWQNXCNRNOIGRGUHGYWL'
            b'OFNXBDCT9JLA9CEKW9BFGOESKGOQLJBTLUMOICBEZDHCR9SZCJUZVXIEAVITFJFD'
            b'GNJII9LSW9IQKV99UJWWAACGIRPCZUENXGILUXCMJIGW9REUNA99MWSANWL9KVKK'
            b'XCKXLRGDT9NXIGQVZWG9NBQPOQKEEET9ZUSENFPGFDNNHGBITCPASGHOPBNYKKEH'
            b'KHVATNVWX9ZGTISUKPKTMWMPCGVVJSGMRJWNFICSFUAVAHIZWA9PDOIXFJGWCPTZ'
            b'HUDDUFJVQPBYNJREQ99UHOESTT9FELDMVK9VHZYPRVOWEW9NXTCYDCIMT9UIWGXU'
            b'FYILOPOCJFVVEJEJN9ULGXIABFJWWRKAD9NHZBULMWUKESZLCPRQVVKWOHEWSTLO'
            b'FNA9KNERURWJPROBBXEWICDKKCQXWYMJUCQLWEUPFXRSNMIJWQUEJUNIKDYJILXC'
            b'GCLFETWOZYIUZVJVYVB9YGXSSDXYXSJXTOQZ9CCCAKMCNNKQCYEDGSGTBICCOGEH'
            b'RIVMICUQPUUFRFCBF9NUUWSQBTVIYFVWAASTQJZFDDWWUUIHPKTIIVAGGIEQCZUE'
            b'VOFDMQLDESMQDPQUSOOKZJ9QLXTAFPXXILFHFUIFJTKSEHXXZBPTZUGLYUZNORFO'
            b'EKQDEIWGXZPBXSOGGQFILUJTKDLWVKPVISU9QOATYVKJHLDLOKROZNFAGS9CICXX'
            b'IUQQVLLRPPPDYJVSCW9OWIHKADCVSKPWTENYEWQWEHP9DDWOUJDWSTSOGYQPALFM'
            b'KCTUGLSXHNYETTMYTS999SYQVQSPHQPKRJSUY9QTABAJOJAAMGVBCSLAAOBXZOJZ'
            b'LIFXUYOVXBKHPFVTKKGSIHUXMBDTMGNVL9NXYCHOVTLGDICIWTCIGNRHLBZBVSXM'
            b'PBFAWIXPCDJWNDUFHUVLBSPBWICZNYIUJPRRTOCSSCVPNBXEDCMHKFVDMHJTSP9J'
            b'I9BXTD9ZILEEOCBMHCQRRDNL9EUKJGJ9MPQGQU9ZFYGVSNOYAEC9NWTCVEJBSXLY'
            b'WTUPMXNAAWXSBIAJYSGYHGLYOMAHFTYMICZRDZTQXHAQGVXENKIGW9XZTPBAIMZL'
            b'HWAJCGY9ZDNQOTGDRCTXSJCEJVTTMVRYYKWAFYSV9WVEVCFAXJKJNUC9NQHPEXWI'
            b'OHOJQEXJNLEW9GLO9AJCJXIEXDONOGKXFJ9OXXXETUEHLBXAJGFPHKAQDCRTKQBX'
            b'PZYQZBQODTVIBUTSAEXMBFBMTAXOQZCOHWEWRJEKNKHZXXSO9USZRWUPZAASWDBX'
            b'OVAEGSAGYDIOZWSSEAIQVRWFDSOXSRRRQHRCWDJWZXXJOGPZRLKQOA9DOY9RXZNW'
            b'BFJTKUOVRRQNSDUOFGCUQNHOBMJSFQZXVBPHHBRRIXZNLXAH9P9EFMGRPGSCFRZI'
            b'NEPOQPXPKHTSRJWARXRGJGYMTPUKQISLV9GUC9VTJLOISKGUZCTZEYNDTURLBPXG'
            b'NQLVXHAHUVNGIHVMZOHLEUBDTRFXFXXVRYBRUF9ULNMSZZOZBYDJUWTMHVHE9EEB'
            b'QYSNWECSPAJHGLTEUCXALBRVTKMWSWCBPUMZFVSEEFIHBAGJVVQV9QLFEGGYVPNS'
            b'DOBZEQGLEFLCQVPDJA9MQDRHYNVZVNTYNJ9GJCXKED9NEWTD9RVMNA9HOHUBLLAS'
            b'NQSDLDZKOMFOEGBJZPYVYZCVHYFEGSVEHSWV9WAGMEQIUDZQZUACWYQLTD9LHBVK'
            b'KNXXXDWQUWRJKTCDP9CEJOHLLPTWCIKKHHIFAFFDVMFZR9A9LYVMTQAPAXAVPJOZ'
            b'KWFQNAJTO99TESTVALUETHREE9DONTUSEINPRODUCTION99999NUMQE9RGHNRRSK'
            b'KAOSD9WEYBHIUM9LWUWKEFSQOCVW999999999999999999999999999999999999'
            b'999999999999999999NYBKIVD99B99999999C99999999VEUNVMI9BSZTFZMGEZJ'
            b'CPMPOTRTUR9PSISHCXAESJQU9CEYAGXVHBAXAFRWHQNAFHGNID9BAOMKSJJDEO99'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999'
          ),

          # Input #1, Part 1 of 2
          TryteString(
            b'OGTAZHXTC9FFCADHPLXKNQPKBWWOJGDCEKSHUPGLOFGXRNDRUWGKN9TYYKWVEWWG'
            b'HMNUXBJTOBKZFDNJEZUKCKWGUHVSU9ZJYAVSQSOFDCOIEP9LCXYLTEFMCYUJAAHL'
            b'YUHQP99S9XRWHXHRPZCWHDMIDYW9OQAWUPTFMBTJGDCWRVNVRDPIWISVYNUDWUGB'
            b'PNNFZDWRVZ9FGAVSEWFXRXGGLXJTPJTJLC9JYHMFBKYAUJRAMHQHKUUZHRWZIVC9'
            b'KFEEXXVNEXJRYUSFV9PEPFUDCNRRTSCZXSTUEGJKDV9UCYNZSBRDYGOKFGYKWVFC'
            b'YSWBUJYVGEUXWTDGPWTWURH9RKEZRFCUUBFBPKSFONMDXWGYKWAUWVUOQVBIGQMM'
            b'KQVDYAZ9SVFIUUNMHOJGRQVXZGIIPKVNNBKABGKZLRNFK9KSIHTCGYPVCWYGDS9O'
            b'IZWLNINYRLGJQCUBWYMAVDWFAURLALQPMRMFRAZCMCPOWM99SGBVEZPAFAXHXNEN'
            b'NWXLF9ZVHZIDWBLFKVWKBUYNBXOXTVPDWAGZXIOMDAEKNMRFGZVIGIFOSHGMPIPW'
            b'NOWQDMHPKOJTYYECKNGCDDTJVALGPZSX9IH9LEGQSDACLBWKNXUW9BAZSHAISUJD'
            b'TPJDOASLVRXFNJJHXQTKMKZUZIMJFPOKHEQXSCJQH9JPRNZHDVVZKWTHWWFNFMHF'
            b'XPUIEEA9HPHJTCJJWZPUHKAAWJQQSAIF9HRETYYPXAZ9YCFJRCXTGCOLJQA9HDLF'
            b'NTVDMYPRCYPQR9MNBBAMGOJXPRFCUSIIZN9VROZDPMOKZBCILKGB9EPCXOYWLPHF'
            b'XTYBCMLRVHWNQDSQUIHHTAUTZCJFQ9CO9GTONKYKMDBSREZC9SUBHYK9JDOBYDBU'
            b'BUIO9TRXQLAYHDDSXGJ9NB9FKMUUUS9GANWVMQLIHX9MPJGLTAOMCZTQYDYVOWXH'
            b'GHYCV9VDCXHGTCOOUEXIITVKHXCSUSOIRTMEAKMTYZCMAWURNX9JOVDICICKHXQY'
            b'BXKWTXWXBZVZWRIDC9YCZVSKYIKJYYMFYQRTWBNJHWXRL9JFSZAXJYYTGDYLTHLW'
            b'RMBUEG9QTGNRPVTBGRYFPEJQSIWTLPGV9CCMCO9TCKLKSJEAMFKQMXEYETISVEYD'
            b'OSCRZ99RFDPUQPHMQ9NVRUBXITDGFZCYQNFCSULGRHPONWJDVWT9UELEKEPQEAFK'
            b'DLDNYPABC9GUASVFJBFZF9Z9CHIUNLJWHKGDYKADLUCRNEPAIWYSX9LT9QWQRKU9'
            b'WEVDPKSTSA9PPEVNTBNLN9ZOPETINXGKA9DCOHPDQMMOOOCKYVEZJ9ZJQRJHNCKR'
            b'FDRPHUVPGVGQYKZBLOILZTPIX9MIBKTXOJKVAYRLSXDTOEEKLF9WWZGLSGIOQZWC'
            b'JJHSBTXYWRDYVEQTCNUENYWDRLZZIVTGCXEAJDRY9OVMXJGCSQSGYFLGYDZUH9EH'
            b'UDQTCXLSDPMNDYQRZYRXYXKY9GIYOSIDQPXXHKJKDQLSCUY9FFBTPSTJFEFROCEX'
            b'FFYTFYHQROAVTYKQOCOQQWBN9RKJ9JJEURKTVOECYRITTYKNOGCD9OPQ9WDMKRPI'
            b'UNRAVUSLFMC9WZWHSESGLDUYHVPAX9YJOFTTFSKFHTOOQQRCPYZKTDVCUZGBOBZK'
            b'LVBVBCWTUS9XOBJADZYN9TMLGCKXEXFEQFQ9VDFKWVEWV9WGXPJHUBWYXGECBPQO'
            b'POHG9YCVXDWOXTEAOFBCEEAV9JCHUVLIRIMHXMUSZPOMMRBF9PLVLRJYTXTBANBZ'
            b'WFQWGNGFGXFOZ9YGMQSZFEJHLFZTTVHRLJPATA9TYCM9LSEWMNEUDNWQFLUXOFUN'
            b'VDKSNIIXCXVUYZZOKVYNNQDZVUQEQFWVF9EIQELSWDJXGMQRVUGGVBMRVGXBBPBE'
            b'BDVGZDBWMDMLPXYJBBRNOMKGPMCG9FTSLMRADFVPUTTEIOUCBLPRYZHGOICNC9BT'
            b'9WHJJJPDOSOMLD9EKRGKYUHUMMCAVHGYWOVQXFLTCXAAUDYKGKGKOYHLDCCQSKNH'
            b'JHPSXTJVTW9QPFOQ9FDZIDDKIVF9CDYGU9ABRESMDLIBONAQWFVGCNOTEDHBMCSU'
            b'H9GKYZPBX9QJELYYMSGDFU9EVTROODXVUAELBUKKXCDYNMHYBVAVUYGABCRIYOHV'
            b'ITGYROZZNQPTESTVALUETHREE9DONTUSEINPRODUCTION99999NUMQE9RGHNRRSK'
            b'KAOSD9WEYBHIUM9LWUWKEFSQOCVWVX9999999999999999999999999999999999'
            b'999999999999999999NYBKIVD99A99999999C99999999VEUNVMI9BSZTFZMGEZJ'
            b'CPMPOTRTUR9PSISHCXAESJQU9CEYAGXVHBAXAFRWHQNAFHGNID9BAOMKSJJDEO99'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999'
          ),

          # Spend transaction, Part 1 of 1
          TryteString(
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'99999999999TESTVALUETWO9DONTUSEINPRODUCTION99999XYYNXZLKBYNFPXA9'
            b'RUGZVEGVPLLFJEM9ZZOUINE9ONOWOB9999999999999999999999999999999999'
            b'999999999999999999NYBKIVD99999999999C99999999VEUNVMI9BSZTFZMGEZJ'
            b'CPMPOTRTUR9PSISHCXAESJQU9CEYAGXVHBAXAFRWHQNAFHGNID9BAOMKSJJDEO99'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999'
          ),
        ],
      },
    )

  def test_pass_message_short(self):
    """
    Adding a message to a transaction.
    """
    response = self.command(
      seed = Seed.random(),

      transfers = [
        ProposedTransaction(
          tag   = Tag(b'PYOTA9UNIT9TESTS9'),
          value = 0,

          address = Address(
            b'TESTVALUE9DONTUSEINPRODUCTION99999YMSWGX'
            b'VNDMLXPT9HMVAOWUUZMLSJZFWGKDVGXPSQAWAEBJN'
          ),

          message = TryteString.from_string('สวัสดีชาวโลก!'),
        ),
      ],
    )

    self.assertDictEqual(
      response,

      {
        'trytes': [
          TryteString(
            # Note that the tryte sequence starts with the transaction
            # message.
            b'HHVFHFHHVFEFHHVFOFHHVFHFHHVFMEHHVFSFHHVFCEHHVFPFHHVFEFHHWFVDHHVF'
            b'CFHHVFUDFA999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'99999999999TESTVALUE9DONTUSEINPRODUCTION99999YMSWGXVNDMLXPT9HMVA'
            b'OWUUZMLSJZFWGKDVGXPSQAWAEBJN999999999999999999999999999PYOTA9UNI'
            b'T9TESTS99999999999NYBKIVD99999999999999999999D9XYVJTKVWN9RUQAPIO'
            b'JUXXTOQTWNMOKRKLUURUGERIIZLUURHPQWZMSYROAKYLZJEKSAMLRCVWEDINFK99'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999'
          ),
        ],
      },
    )

  def test_pass_message_long(self):
    """
    The message is too long to fit into a single transaction.
    """
    response = self.command(
      seed = Seed.random(),

      transfers = [
        ProposedTransaction(
          tag   = Tag(b'PYOTA9UNIT9TESTS9'),
          value = 0,

          address = Address(
            b'TESTVALUE9DONTUSEINPRODUCTION99999YMSWGX'
            b'VNDMLXPT9HMVAOWUUZMLSJZFWGKDVGXPSQAWAEBJN'
          ),

          message = TryteString.from_string(
            'Вы не можете справиться правду! Сын, мы живем в мире, который '
            'имеет стены. И эти стены должны быть охраняют люди с оружием. '
            'Кто будет это делать? Вы? Вы, лейтенант Weinberg? У меня есть '
            'большая ответственность, чем вы можете понять. Ты плачешь '
            'Сантьяго и прокляни морских пехотинцев. У вас есть такой роскоши. '
            'У вас есть роскошь, не зная, что я знаю: что смерть Сантьяго, в '
            'то время как трагический, вероятно, спас жизнь. И мое '
            'существование, в то время как гротеск и непонятными для вас, '
            'спасает жизни ... Вы не хотите знать правду. Потому что в '
            'глубине души, в тех местах, вы не говорите о на вечеринках, вы '
            'хотите меня на этой стене. Вы должны меня на этой стене. Мы '
            'используем такие слова, как честь, код, верность ... мы '
            'используем эти слова в качестве основы к жизни провел, защищая '
            'что-то. Вы можете использовать им, как пуанта. У меня нет ни '
            'времени, ни желания, чтобы объясниться с человеком, который '
            'поднимается и спит под одеялом самой свободы я обеспечиваю, то '
            'ставит под сомнение то, каким образом я предоставить ему! Я бы '
            'предпочел, чтобы вы просто сказал спасибо и пошел на своем пути. '
            'В противном случае, я предлагаю вам подобрать оружие и встать '
            'пост. В любом случае, я не наплевать, что вы думаете, что вы '
            'имеете право!'
          ),
        ),
      ],
    )

    self.assertDictEqual(
      response,

      {
        'trytes': [
          # The message is so long that it has to be split across three
          # separate transactions!
          TryteString(
            b'EASGBGTGTDSGNFSGPFSGAGFA9999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'99999999999TESTVALUE9DONTUSEINPRODUCTION99999YMSWGXVNDMLXPT9HMVA'
            b'OWUUZMLSJZFWGKDVGXPSQAWAEBJN999999999999999999999999999PYOTA9UNI'
            b'T9TESTS99999999999NYBKIVD99B99999999B99999999YJVDLFI9FFXKNVTUKHO'
            b'PTZUWZPOTRTHNZ9YZDXFRVBAUGO9APIQQWFSCLGFQMLMVCEPCTBFAVMIIXHUPG99'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999'
          ),

          TryteString(
            b'FSG9GTGHEEASG9GSGNFEATGFETGVDSGAGSGWFEATGUDTGVDSGSFSG9GSGSFSAEAS'
            b'GKETGDEEASGRFSGAGSGYFSGTFSG9GTGDEEASGZFSGSFSG9GTGHEEASG9GSGNFEAT'
            b'GFETGVDSGAGSGWFEATGUDTGVDSGSFSG9GSGSFSAEASGUETGDEEASGVFTGUDSGBGS'
            b'GAGSGYFTGEESGUFTGWDSGSFSGZFEATGVDSGNFSGXFSGVFSGSFEATGUDSGYFSGAGS'
            b'GPFSGNFQAEASGXFSGNFSGXFEATG9ESGSFTGUDTGVDTGEEQAEASGXFSGAGSGRFQAE'
            b'ASGPFSGSFTGTDSG9GSGAGTGUDTGVDTGEEEASASASAEASGZFTGDEEASGVFTGUDSGB'
            b'GSGAGSGYFTGEESGUFTGWDSGSFSGZFEATGFETGVDSGVFEATGUDSGYFSGAGSGPFSGN'
            b'FEASGPFEASGXFSGNFTG9ESGSFTGUDTGVDSGPFSGSFEASGAGTGUDSG9GSGAGSGPFT'
            b'GDEEASGXFEASGTFSGVFSGUFSG9GSGVFEASGBGTGTDSGAGSGPFSGSFSGYFQAEASGU'
            b'FSGNFTGBESGVFTGBESGNFTGHEEATG9ETGVDSGAGRATGVDSGAGSAEASGKETGDEEAS'
            b'GZFSGAGSGTFSGSFTGVDSGSFEASGVFTGUDSGBGSGAGSGYFTGEESGUFSGAGSGPFSGN'
            b'FTGVDTGEEEASGVFSGZFQAEASGXFSGNFSGXFEASGBGTGWDSGNFSG9GTGVDSGNFSAE'
            b'ASGAFEASGZFSGSFSG9GTGHEEASG9GSGSFTGVDEASG9GSGVFEASGPFTGTDSGSFSGZ'
            b'FSGSFSG9GSGVFQAEASG9GSGVFEASGTFSGSFSGYFSGNFSG9GSGVFTGHEQAEATG9ET'
            b'GVDSGAGSGOFTGDEEASGAGSGOFTGCETGHETGUDSG9GSGVFTGVDTGEETGUDTGHEEAT'
            b'GUDEATG9ESGSFSGYFSGAGSGPFSGSFSGXFSGAGSGZFQAEASGXFSGAGTGVDSGAGTGT'
            b'DTGDESGWFEASGBGSGAGSGRFSG9GSGVFSGZFSGNFSGSFTGVDTGUDTGHEEASGVFEAT'
            b'GUDSGBGSGVFTGVDEASGBGSGAGSGRFEASGAGSGRFSGSFTGHESGYFSGAGSGZFEATGU'
            b'DSGNFSGZFSGAGSGWFEATGUDSGPFSGAGSGOFSGAGSGRFTGDEEATGHEEASGAGSGOFS'
            b'GSFTGUDSGBGSGSFTG9ESGVFSGPFSGNFTGGEQAEATGVDSGAGEATGUDTGVDSGNFSGP'
            b'FSGVFTGVDEASGBGSGAGSGRFEATGUDSGAGSGZFSG9GSGSFSG9GSGVFSGSFEATGVDS'
            b'GAGQAEASGXFSGNFSGXFSGVFSGZFEASGAGSGOFTGTDSGNFSGUFSGAGSGZFEATGHEE'
            b'ASGBGTGTDSGSFSGRFSGAGTGUDTGVDSGNFSGPFSGVFTGVDTGEEEASGSFSGZFTGWDF'
            b'AEASGMFEASGOFTGDEEASGBGTGTDSGSFSGRFSGBGSGAGTG9ESGSFSGYFQAEATG9ET'
            b'GVDSGAGSGOFTGDEEASGPFTGDEEASGBGTGTDSGAGTGUDTGVDSGAGEATGUDSGXFSGN'
            b'FSGUFSGNFSGYFEATGUDSGBGSGNFTGUDSGVFSGOFSGAGEASGVFEASGBGSGAGTGAES'
            b'GSFSGYFEASG9GSGNFEATGUDSGPFSGAGSGSFSGZFEASGBGTGWDTGVDSGVFSAEASGK'
            b'EEASGBGTGTDSGAGTGVDSGVFSGPFSG9GSGAGSGZFEATGUDSGYFTGWDTG9ESGNFSGS'
            b'FQAEATGHEEASGBGTGTDSGSFSGRFSGYFSGNFSGQFSGNFTGGEEASGPFSGNFSGZFEAS'
            b'GBGSGAGSGRFSGAGSGOFTGTDSGNFTGVDTGEEEASGAGTGTDTGWDSGTFSGVFSGSFEAS'
            b'GVFEASGPFTGUDTGVDSGNFTGVDTGEEEASGBGSGAGTGUDTGVDSAEASGKEEASGYFTGG'
            b'ESGOFSGAGSGZFEATGUDSGYFTGWDTG9ESGNFSGSFQAEATGHEEASG9GSGSFEASG9GS'
            b'GNFSGBGSGYFSGSFSGPFSGNFTGVDTGEEQAEATG9ETGVDSGAGEASGPFTGDEEASGRFT'
            b'GWDSGZFSGNFSGSFTGVDSGSFQAEATG9ETGVDSGAGEASGPFTGDEEASGVFSGZFSGSFS'
            b'GSFTGVDSGSFTESTVALUE9DONTUSEINPRODUCTION99999YMSWGXVNDMLXPT9HMVA'
            b'OWUUZMLSJZFWGKDVGXPSQAWAEBJN999999999999999999999999999PYOTA9UNI'
            b'T9TESTS99999999999NYBKIVD99A99999999B99999999YJVDLFI9FFXKNVTUKHO'
            b'PTZUWZPOTRTHNZ9YZDXFRVBAUGO9APIQQWFSCLGFQMLMVCEPCTBFAVMIIXHUPG99'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999'
          ),

          TryteString(
            b'SGKETGDEEASG9GSGSFEASGZFSGAGSGTFSGSFTGVDSGSFEATGUDSGBGTGTDSGNFSG'
            b'PFSGVFTGVDTGEETGUDTGHEEASGBGTGTDSGNFSGPFSGRFTGWDFAEASGZETGDESG9G'
            b'QAEASGZFTGDEEASGTFSGVFSGPFSGSFSGZFEASGPFEASGZFSGVFTGTDSGSFQAEASG'
            b'XFSGAGTGVDSGAGTGTDTGDESGWFEASGVFSGZFSGSFSGSFTGVDEATGUDTGVDSGSFSG'
            b'9GTGDESAEASGQEEATGFETGVDSGVFEATGUDTGVDSGSFSG9GTGDEEASGRFSGAGSGYF'
            b'SGTFSG9GTGDEEASGOFTGDETGVDTGEEEASGAGTGYDTGTDSGNFSG9GTGHETGGETGVD'
            b'EASGYFTGGESGRFSGVFEATGUDEASGAGTGTDTGWDSGTFSGVFSGSFSGZFSAEASGSETG'
            b'VDSGAGEASGOFTGWDSGRFSGSFTGVDEATGFETGVDSGAGEASGRFSGSFSGYFSGNFTGVD'
            b'TGEEIBEASGKETGDEIBEASGKETGDEQAEASGYFSGSFSGWFTGVDSGSFSG9GSGNFSG9G'
            b'TGVDEAFCTCXCBDQCTCFDVCIBEASGAFEASGZFSGSFSG9GTGHEEASGSFTGUDTGVDTG'
            b'EEEASGOFSGAGSGYFTGEETGAESGNFTGHEEASGAGTGVDSGPFSGSFTGVDTGUDTGVDSG'
            b'PFSGSFSG9GSG9GSGAGTGUDTGVDTGEEQAEATG9ESGSFSGZFEASGPFTGDEEASGZFSG'
            b'AGSGTFSGSFTGVDSGSFEASGBGSGAGSG9GTGHETGVDTGEESAEASG9FTGDEEASGBGSG'
            b'YFSGNFTG9ESGSFTGAETGEEEASGZESGNFSG9GTGVDTGEETGHESGQFSGAGEASGVFEA'
            b'SGBGTGTDSGAGSGXFSGYFTGHESG9GSGVFEASGZFSGAGTGTDTGUDSGXFSGVFTGYDEA'
            b'SGBGSGSFTGYDSGAGTGVDSGVFSG9GTGZDSGSFSGPFSAEASGAFEASGPFSGNFTGUDEA'
            b'SGSFTGUDTGVDTGEEEATGVDSGNFSGXFSGAGSGWFEATGTDSGAGTGUDSGXFSGAGTGAE'
            b'SGVFSAEASGAFEASGPFSGNFTGUDEASGSFTGUDTGVDTGEEEATGTDSGAGTGUDSGXFSG'
            b'AGTGAETGEEQAEASG9GSGSFEASGUFSG9GSGNFTGHEQAEATG9ETGVDSGAGEATGHEEA'
            b'SGUFSG9GSGNFTGGEDBEATG9ETGVDSGAGEATGUDSGZFSGSFTGTDTGVDTGEEEASGZE'
            b'SGNFSG9GTGVDTGEETGHESGQFSGAGQAEASGPFEATGVDSGAGEASGPFTGTDSGSFSGZF'
            b'TGHEEASGXFSGNFSGXFEATGVDTGTDSGNFSGQFSGVFTG9ESGSFTGUDSGXFSGVFSGWF'
            b'QAEASGPFSGSFTGTDSGAGTGHETGVDSG9GSGAGQAEATGUDSGBGSGNFTGUDEASGTFSG'
            b'VFSGUFSG9GTGEESAEASGQEEASGZFSGAGSGSFEATGUDTGWDTGBESGSFTGUDTGVDSG'
            b'PFSGAGSGPFSGNFSG9GSGVFSGSFQAEASGPFEATGVDSGAGEASGPFTGTDSGSFSGZFTG'
            b'HEEASGXFSGNFSGXFEASGQFTGTDSGAGTGVDSGSFTGUDSGXFEASGVFEASG9GSGSFSG'
            b'BGSGAGSG9GTGHETGVDSG9GTGDESGZFSGVFEASGRFSGYFTGHEEASGPFSGNFTGUDQA'
            b'EATGUDSGBGSGNFTGUDSGNFSGSFTGVDEASGTFSGVFSGUFSG9GSGVFEASASASAEASG'
            b'KETGDEEASG9GSGSFEATGYDSGAGTGVDSGVFTGVDSGSFEASGUFSG9GSGNFTGVDTGEE'
            b'EASGBGTGTDSGNFSGPFSGRFTGWDSAEASGXESGAGTGVDSGAGSGZFTGWDEATG9ETGVD'
            b'SGAGEASGPFEASGQFSGYFTGWDSGOFSGVFSG9GSGSFEASGRFTGWDTGAESGVFQAEASG'
            b'PFEATGVDSGSFTGYDEASGZFSGSFTGUDTGVDSGNFTGYDQAEASGPFTGDEEASG9GSGSF'
            b'EASGQFSGAGSGPFSGAGTGTDSGVFTGVDSGSFEASGAGEASG9GSGNFEASGPFSGSFTG9E'
            b'SGSFTGTDSGVFSG9GSGXFSGNFTGYDQAEASGPFTGDEEATGYDSGAGTGVDSGVFTGVDSG'
            b'SFEASGZFSGSTESTVALUE9DONTUSEINPRODUCTION99999YMSWGXVNDMLXPT9HMVA'
            b'OWUUZMLSJZFWGKDVGXPSQAWAEBJN999999999999999999999999999PYOTA9UNI'
            b'T9TESTS99999999999NYBKIVD99999999999B99999999YJVDLFI9FFXKNVTUKHO'
            b'PTZUWZPOTRTHNZ9YZDXFRVBAUGO9APIQQWFSCLGFQMLMVCEPCTBFAVMIIXHUPG99'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999999999999999999'
            b'9999999999999999999999999999999999999999999999999'
          ),
        ],
      },
    )
