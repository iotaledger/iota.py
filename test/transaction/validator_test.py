# coding=utf-8
from __future__ import absolute_import, division, print_function, \
  unicode_literals

from typing import Tuple
from unittest import TestCase

from iota import Address, Bundle, BundleHash, BundleValidator, Fragment, Hash, \
  Tag, Transaction, TransactionHash, TransactionTrytes


class BundleValidator_CurlTestCase(TestCase):
  """
  Tests bundle validation using the old Curl hash algorithm.

  References:
    - https://github.com/iotaledger/kerl#kerl-integration-in-iota
  """
  # noinspection SpellCheckingInspection
  def setUp(self):
    super(BundleValidator_CurlTestCase, self).setUp()

    # Define a valid bundle that will serve as the happy path.
    # We will mangle it in various ways to trigger validation errors.
    self.bundle = Bundle([
      # "Spend" transaction, Part 1 of 1
      Transaction(
        hash_ =
          TransactionHash(
            b'LUQJUUDAZIHSTPBLCZYXWXYKXTFCOCQJ9EHXKLEB'
            b'IJBPSRFSBYRBYODDAZ9NPKPYSMPVNEFXYZQ999999'
          ),

        address =
          Address(
            b'FZXUHBBLASPIMBDIHYTDFCDFIRII9LRJPXFTQTPO'
            b'VLEIFE9NWTFPPQZHDCXYUOUCXHHNRPKCIROYYTWSA'
          ),

        branch_transaction_hash =
          TransactionHash(
            b'UKGIAYNLALFGJOVUZYJGNIOZSXBBZDXVQLUMHGQE'
            b'PZJWYDMGTPJIQXS9GOKXR9WIGWFRWRSKGCJ999999'
          ),

        bundle_hash =
          BundleHash(
            b'ZSATLX9HDENCIARERVLWYHXPQETFL9QKTNC9LUOL'
            b'CDXKKW9MYTLZJDXBNOHURUXSYWMGGD9UDGLHCSZO9'
          ),

        nonce =
          Hash(
            b'LIJVXBVTYMEEPCKJRIQTGAKWJRAMYNPJEGHEWAUL'
            b'XPBBUQPCJTJPRZTISQPJRJGMSBGQLER9OXYQXFGQO'
          ),

        trunk_transaction_hash =
          TransactionHash(
            b'KFCQSGDYENCECCPNNZDVDTBINCBRBERPTQIHFH9G'
            b'YLTCSGUFMVWWSAHVZFXDVEZO9UHAUIU9LNX999999'
          ),

        signature_message_fragment = Fragment(b''),

        current_index = 0,
        last_index    = 3,
        tag           = Tag(b''),
        timestamp     = 1483033814,
        value         = 1,
      ),

      # Input #1, Part 1 of 2
      Transaction(
        hash_ =
          TransactionHash(
            b'KFCQSGDYENCECCPNNZDVDTBINCBRBERPTQIHFH9G'
            b'YLTCSGUFMVWWSAHVZFXDVEZO9UHAUIU9LNX999999'
          ),

        address =
          Address(
            b'GMHOSRRGXJLDPVWRWVSRWI9BCIVLUXWKTJYZATIA'
            b'RAZRUCRGTWXWP9SZPFOVAMLISUPQUKHNDMITUJKIB'
          ),

        branch_transaction_hash =
          TransactionHash(
            b'UKGIAYNLALFGJOVUZYJGNIOZSXBBZDXVQLUMHGQE'
            b'PZJWYDMGTPJIQXS9GOKXR9WIGWFRWRSKGCJ999999'
          ),

        bundle_hash =
          BundleHash(
            b'ZSATLX9HDENCIARERVLWYHXPQETFL9QKTNC9LUOL'
            b'CDXKKW9MYTLZJDXBNOHURUXSYWMGGD9UDGLHCSZO9'
          ),

        nonce =
          Hash(
            b'VRYLDCKEWZJXPQVSWOJVYVBJSCWZQEVKPBG9KGEZ'
            b'GPRQFKFSRNBPXCSVQNJINBRNEPIKAXNHOTJFIVYJO'
          ),

        trunk_transaction_hash =
          TransactionHash(
            b'QSTUKDIBYAZIQVEOMFGKQPHAIPBHUPSDQFFKKHRA'
            b'ABYMYMQDHMTEWCM9IMZHQMGXOTWNSJYHRNA999999'
          ),

        signature_message_fragment =
          Fragment(
            b'XS9OVIXHIGGR9IYQBHGMFAHPZBWLIBNAQPFMPVYUZDOLLFDJIPZEMIOGVANQJSCU'
            b'IPDNNUNAMWEL9OFXXK9NV9UTCRBYTARBJHPQYJYKNAQGMATG9EXQMHGXY9QOHPBA'
            b'FEVABDYMCXORXHBMPLEWJYGYFFBWVXAUXHGLTABBKOQMZLFAYWDAKEOMJPJX9TMT'
            b'GXIJXZTKRRIPAMYY9UNSPPEGFPJE9NFSJFWKYOFZRMPBXZDNQUEKLRUVPXMCTQRE'
            b'ZWICSCVXN9VBLN9DRINRPAZTYJYXPGGRZJLMYXGCLUQNZ9NJGH9GFQPKKVK9N9WR'
            b'IJXDNKUMLLJUVIQRGPHEVWTXQHRLRCWQJCHTPASCVLRGPNWSIUKWIBMDJJ9EUTQ9'
            b'NXZZEJFWY9LCJJSOEPXWETUBKKVZNUKTLUPEPDBLUWCQGYTOXZ9NZUXHBDOUYQBP'
            b'MNECVJ9HGWA9AWU9VHGETWKBU9YZEZGEQKMVTAKPLCZVWKQFXDEFBPKNUCQDSPWA'
            b'LMPFTUFGRFDZH9PQHJ9WXZPCDWGMNASVVEUXEGWATM9ZIMCEEXTHCXFLYG9LQAKV'
            b'UOGORP9UUWYFTWGZ9OFOGSP9KDNPDSQKEMMISEMWQDVFKCSQXSP9RUMNUQJOBACU'
            b'MPIXCGBJLQQGB9GDSMUUUSYWIY9ZNIAIZBJYTAJKJKZIBFPMGDWUEPXSO9HUJRNV'
            b'QE9OTVUPKBVNVUBSILVZEDPC9AMEYAIATE9JEIQQWIMGCZXMHOPXPFUTEPJEATJN'
            b'QWDFZQ9OGPNBFUHLJDJZQJLXCFEUDPZKVCPEBTNBRYNIIKJHUV9EUFVMB9AHTARQ'
            b'DN9TZ9JPAPCEXSYHZPAQLBJMNQ9R9KPWVZLDLFNHYCCQBFVEPMEZSXAB9GOKGOGC'
            b'SOVL9XJSAQYSECY9UUNSVQSJB9BZVYRUURNUDMZVBJTMIDQUKQLMVW99XFDWTOPR'
            b'UBRPKS9BGEAQPIODAMJAILNCH9UVYVWSDCZXZWLO9XJJZ9FQOL9F9ZJDNGMUGFKJ'
            b'PCYURGYBGYRVKPEBKMJPZZGDKZKT9UBFSJEELREWOYDQZVUPVSGPZYIDVOJGNTXC'
            b'OFGCHBGVZPQDNRKAQNVJEYKYTKHTFBJRDMKVSHEWADNYIQOAUFXYMZKNJPLXGYFX'
            b'DTCVDDBUHBDPG9WLNMWPSCCCGVTIOOLEECXKNVAYNNTDLJMDGDGSKOGWO9UYXTTF'
            b'FCRZEDDQNN9ZODTETGMGGUXOYECGNMHGMGXHZSPODIBMBATJJHSPQHDUCZOMWQNI'
            b'CUZG9LAMBOQRQQDIPIBMIDCIAJBBBNDUAIEMFCEASHPUJPFPPXNDUVGDNNYBRRTW'
            b'SPXGXMCSUXYJSTFIRUIDNEUSVKNIDKIBRQNMEDCYQOMJYTMGRZLYHBUYXCRGSAXR'
            b'ZVHTZEAKNAUKJPFGPOGQLTDMSOXR9NVOIAIMCBVWOF9FXAZUKKZKHJEGHFNLUB9B'
            b'TGAICGQGAYZRRHSFIDTNIJPHIHCXTHQUSKJRSVAWFUXLBYA99QKMGLHDNUHOPEW9'
            b'OFNWPDXXRVZREUIQKSVSDCFIJ99TSGSZ9KU9JGE9VXDVVOLMGNMUGSHUZAOFCIMK'
            b'CPEWMG9IHUZAILQCANIUUG9JNEZMT9EONSN9CWWQOTFBEPZRTTJTQFSTQTBERKGE'
            b'NGFFIYMZMCFBYNIOBPOFOIYPUMYYPRXEHUJEVVELOPNXAPCYFXQ9ORMSFICDOZTS'
            b'GQOMDI9FKEKRIMZTWSIWMYAUSBIN9TPFSMQZCYGVPVWKSFZXPE9BP9ALNWQOVJGM'
            b'SCSJSTNUTMUAJUIQTITPPOHG9NKIFRNXSCMDAEW9LSUCTCXITSTZSBYMPOMSMTXP'
            b'CEBEOAUJK9STIZRXUORRQBCYJPCNHFKEVY9YBJL9QGLVUCSZKOLHD9BDNKIVJX9T'
            b'PPXQVGAXUSQQYGFDWQRZPKZKKWB9ZBFXTUGUGOAQLDTJPQXPUPHNATSGILEQCSQX'
            b'X9IAGIVKUW9MVNGKTSCYDMPSVWXCGLXEHWKRPVARKJFWGRYFCATYNZDTRZDGNZAI'
            b'OULYHRIPACAZLN9YHOFDSZYIRZJEGDUZBHFFWWQRNOLLWKZZENKOWQQYHGLMBMPF'
            b'HE9VHDDTBZYHMKQGZNCSLACYRCGYSFFTZQJUSZGJTZKKLWAEBGCRLXQRADCSFQYZ'
            b'G9CM9VLMQZA'
          ),

        current_index = 1,
        last_index    = 3,
        tag           = Tag(b''),
        timestamp     = 1483033814,
        value         = -99,
      ),

      # Input #1, Part 2 of 2
      Transaction(
        hash_ =
          TransactionHash(
            b'QSTUKDIBYAZIQVEOMFGKQPHAIPBHUPSDQFFKKHRA'
            b'ABYMYMQDHMTEWCM9IMZHQMGXOTWNSJYHRNA999999'
          ),

        address =
          Address(
            b'GMHOSRRGXJLDPVWRWVSRWI9BCIVLUXWKTJYZATIA'
            b'RAZRUCRGTWXWP9SZPFOVAMLISUPQUKHNDMITUJKIB'
          ),

        branch_transaction_hash =
          TransactionHash(
            b'UKGIAYNLALFGJOVUZYJGNIOZSXBBZDXVQLUMHGQE'
            b'PZJWYDMGTPJIQXS9GOKXR9WIGWFRWRSKGCJ999999'
          ),

        bundle_hash =
          BundleHash(
            b'ZSATLX9HDENCIARERVLWYHXPQETFL9QKTNC9LUOL'
            b'CDXKKW9MYTLZJDXBNOHURUXSYWMGGD9UDGLHCSZO9'
          ),

        nonce =
          Hash(
            b'AAKVYZOEZSOXTX9LOLHZYLNAS9CXBLSWVZQAMRGW'
            b'YW9GHHMVIOHWBMTXHDBXRTF9DEFFQFQESNVJORNXK'
          ),

        trunk_transaction_hash =
          TransactionHash(
            b'ZYQGVZABMFVLJXHXXJMVAXOXHRJTTQUVDIIQOOXN'
            b'NDPQGDFDRIDQMUWJGCQKKLGEUQRBFAJWZBC999999'
          ),

        signature_message_fragment =
          Fragment(
            b'YSNEGUCUHXEEFXPQEABV9ATGQMMXEVGMZWKKAFAVOVGUECOZZJFQDNRBCSXCOTBD'
            b'BRUJ9HF9CITXQI9ZQGZFKCXMFZTOYHUTCXDIBIMTBKVXMMTPNKRDRLQESLWFZSQQ'
            b'9BCGKVIZAHBWYTNXG9OWOXHAMQECMOVKN9SOEVJBBARPXUXYUQVFPYXWXQQMDIVP'
            b'VITRWTNNBY9CYBHXJTZUVIPJJG9WLTNMFVPXGYZCNOGSLGVMS9YXXNSV9AYPXZTA'
            b'QJYUNUFBCSZBZNKWCPMVMOGFIDENTOOOCPRDJTNGQRLA9YKMLYZQRO9QQJMCSYVF'
            b'YLISFIWQQYMWMHUOEZPATYCEZARLWLAMCZWYWJZVD9WWKYJURTOLITFFRXQUBKST'
            b'DG9CKDBLPXTPCIMKEKRGEXJGLRL9ZST9VOLV9NOFZLIMVOZBDZJUQISUWZKOJCRN'
            b'YRBRJLCTNPV9QIWQJZDQFVPSTW9BJYWHNRVQTITWJYB9HBUQBXTAGK9BZCHYWYPE'
            b'IREDOXCYRW9UXVSLZBBPAFIUEJABMBYKSUPNWVVKAFQJKDAYYRDICTGOTWWDSFLG'
            b'BQFZZ9NBEHZHPHVQUYEETIRUDM9V9LBXFUXTUGUMZG9HRBLXCKMMWWMK9VTKVZSA'
            b'PRSMJVBLFFDHTYCPDXKBUYYLZDPW9EVXANPZOPBASQUPRNCDGHNUK9NDUQSULUZI'
            b'VMIJTPUGMZPCYR9AERBAGUYNGVEHWIIADAAPPMYQOAGBQCXEDTQOGHWHHSWDFZLC'
            b'DVLNPYMGDPZWOZURT9OZKDJKFECXSFIALXJDRJWMWMTNUUNVDUCJAZLDRN9ZWLHH'
            b'SNXDWULUBNLVRDJZQMKCTRCKULKS9VARFZSRYZCPNH9FHXCAFWKPNGOPOFMYXJLE'
            b'LTKUHSZVDQRDJIGQRGOSKYWDCU9EBJMXQDBKTBNQTIZNCALHRNTHKN99WOBQVVEV'
            b'HEDTDRKFPGLIWOSPLAAELQQXDCDWPIFED9OEUPYPKHZBOHPQGQGSEKO9BFIQFYZK'
            b'YEULWSIBZVSPXBGOJTTYBVIIIPAXGL9ZJNNIELFYAUOUBRDWLJJMSAXHQOYGOWDV'
            b'HHPISRZFSHPDLNQDFWRHLWNAJPYM9REAJLZDIAIVLQBFAUJIQKVHJDFPXENI9ZM9'
            b'SFNGSQHDFEDC9CQVXAXTQVLWYMVSLEDCOVNSQLSANLVA9TWSY9BHAJKOCGI9YLAB'
            b'VROCBJRVXRWBKNUXCAXJIAYWSFRDZHIPQSNBRYNKZAFXHDUENVLHFHYIKH9IANFV'
            b'FKWVFJCSEELVTDDUHBPIYNFLTJLINNORIMDEAXMN9LGNGBWVWYWQIPWKBFDKNDOX'
            b'WFKGBAMZIUFYA9DXGAL9OQQTJAUUXTINWZSQUTPUKUMOZCGOBKKFBXCVR9AGTAQS'
            b'SVGTUBBHSIRHFRSIR9SKSZPXQFG9AOYAHZNQR9AHSEFCKWCJHUTLREDVGBQYVBZR'
            b'CZDXFG9PTSAWQOURYKNWYAZNASV9UMUYUMFCQSFDHZD99WUMCORLYTIZMRGNBAY9'
            b'UJYJMMRCLJP9XVLXTAZOHNVVYSCOSDHGUOPXIRBJDXJUCJYLQKUJOTNJCPRBDOKV'
            b'ZEMIGZRNJOQKFFAXQVGGY9YRJORZCOD9REIIIDDTRQ9TJWTFYRKOPLAFNUUPCHXA'
            b'WVPYUQXAFFCTYAESWAFUTQQYZRQVLVZW9OWAAJMPSAEPKWXVEZVTVPQEEBVXNZJP'
            b'ZU9JJSIAEPIT9HE99XNAUYOAKRIFQQJQTFIMWEOKLCH9JKCQTGZPEGWORFB9ARNS'
            b'DPYKRONBONYOGEVEFXGTMQTQBEMFQWEMIDSGAVEQHVHAPSMTCJ9FMEYBWAQWWJCE'
            b'ABUUMMVNDMSBORFLHVIIDOUQHHXQKXTVGRAYTLMECCSVZOZM9JKUWIGGFLMMDGBU'
            b'DBIHJFUINVOKSFTOGFCZEMIBSZNGPL9HXWGTNNAKYIMDITCRMSHFR9BDSFGHXQMR'
            b'ACZOVUOTSJSKMNHNYIFEOD9CVBWYVVMG9ZDNR9FOIXSZSTIO9GLOLPLMW9RPAJYB'
            b'WTCKV9JMSEVGD9ZPEGKXF9XYQMUMJPWTMFZJODFIEYNLI9PWODSPPW9MVJOWZQZU'
            b'CIKXCVVXDKWHXV99GOEZ9CMGUH9OWGLLISNZEPSAPEDHVRKKGFFNGBXFLDBQTTQL'
            b'WVLUITJQ9JM'
          ),

        current_index = 2,
        last_index    = 3,
        tag           = Tag(b''),
        timestamp     = 1483033814,
        value         = 0,
      ),

      # "Change" transaction, Part 1 of 1
      Transaction(
        hash_ =
          TransactionHash(
            b'ZYQGVZABMFVLJXHXXJMVAXOXHRJTTQUVDIIQOOXN'
            b'NDPQGDFDRIDQMUWJGCQKKLGEUQRBFAJWZBC999999'
          ),

        address =
          Address(
            b'YOTMYW9YLZQCSLHB9WRSTZDYYYGUUWLVDRHFQFEX'
            b'UVOQARTQWZGLBU9DVSRDPCWYWQZHLFHY9NGLPZRAQ'
          ),

        branch_transaction_hash =
          TransactionHash(
            b'QCHKLZZBG9XQMNGCDVXZGDRXIJMFZP9XUGAWNNVP'
            b'GXBWB9NVEKEFMUWOEACULFUR9Q9XCWPBRNF999999'
          ),

        bundle_hash =
          BundleHash(
            b'ZSATLX9HDENCIARERVLWYHXPQETFL9QKTNC9LUOL'
            b'CDXKKW9MYTLZJDXBNOHURUXSYWMGGD9UDGLHCSZO9'
          ),

        nonce =
          Hash(
            b'TPGXQFUGNEYYFFKPFWJSXKTWEUKUFTRJCQKKXLXL'
            b'PSOHBZTGIBFPGLSVRIVYAC9NZMOMZLARFZYCNNRCM'
          ),

        trunk_transaction_hash =
          TransactionHash(
            b'UKGIAYNLALFGJOVUZYJGNIOZSXBBZDXVQLUMHGQE'
            b'PZJWYDMGTPJIQXS9GOKXR9WIGWFRWRSKGCJ999999'
          ),

        signature_message_fragment = Fragment(b''),

        current_index = 3,
        last_index    = 3,
        tag           = Tag(b''),
        timestamp     = 1483033814,
        value         = 98,
      ),
    ])

  def test_pass_happy_path(self):
    """
    Bundle passes validation.
    """
    validator = BundleValidator(self.bundle)

    self.assertListEqual(validator.errors, [])
    self.assertTrue(validator.is_valid())

  def test_pass_empty(self):
    """
    Bundle has no transactions.
    """
    validator = BundleValidator(Bundle())

    self.assertListEqual(validator.errors, [])
    self.assertTrue(validator.is_valid())

  def test_fail_balance_positive(self):
    """
    The bundle balance is > 0.
    """
    self.bundle.transactions[0].value += 1

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Bundle has invalid balance (expected 0, actual 1).',
      ],
    )

  def test_fail_balance_negative(self):
    """
    The bundle balance is < 0.
    """
    self.bundle.transactions[3].value -= 1

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Bundle has invalid balance (expected 0, actual -1).',
      ],
    )

  def test_fail_bundle_hash_invalid(self):
    """
    One of the transactions has an invalid ``bundle_hash`` value.
    """
    # noinspection SpellCheckingInspection
    self.bundle.transactions[3].bundle_hash =\
      BundleHash(
        b'NFDPEEZCWVYLKZGSLCQNOFUSENIXRHWWTZFBXMPS'
        b'QHEDFWZULBZFEOMNLRNIDQKDNNIELAOXOVMYEI9PG'
      )

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Transaction 3 has invalid bundle hash.',
      ],
    )

  def test_fail_current_index_invalid(self):
    """
    One of the transactions has an invalid ``current_index`` value.
    """
    self.bundle.transactions[3].current_index = 4

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Transaction 3 has invalid current index value '
        '(expected 3, actual 4).',
      ],
    )

  def test_fail_last_index_invalid(self):
    """
    One of the transactions has an invalid ``last_index`` value.
    """
    self.bundle.transactions[0].last_index = 2

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Transaction 0 has invalid last index value '
        '(expected 3, actual 2).'
      ],
    )

  def test_fail_missing_signature_fragment_underflow(self):
    """
    The last transaction in the bundle is an input, and its second
    signature fragment is missing.
    """
    # Remove the last input's second signature fragment, and the change
    # transaction.
    del self.bundle.transactions[-2:]
    for (i, txn) in enumerate(self.bundle): # type: Tuple[int, Transaction]
      txn.current_index = i
      txn.last_index    = 1

    # Fix bundle balance, since we removed the change transaction.
    self.bundle[1].value = -self.bundle[0].value

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Transaction 1 has invalid signature (using 1 fragments).',
      ],
    )

  def test_fail_signature_fragment_address_wrong(self):
    """
    The second signature fragment for an input is associated with the
    wrong address.
    """
    # noinspection SpellCheckingInspection
    self.bundle[2].address =\
      Address(
        b'QHEDFWZULBZFEOMNLRNIDQKDNNIELAOXOVMYEI9P'
        b'GNFDPEEZCWVYLKZGSLCQNOFUSENIXRHWWTZFBXMPS'
      )

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Transaction 1 has invalid signature (using 1 fragments).',
      ],
    )

  def test_fail_signature_fragment_value_wrong(self):
    """
    The second signature fragment for an input has a nonzero balance.
    """
    self.bundle[2].value = -1
    self.bundle[-1].value += 1

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Transaction 2 has invalid amount (expected 0, actual -1).',
      ],
    )

  def test_fail_signature_invalid(self):
    """
    One of the input signatures fails validation.
    """
    self.bundle[2].signature_message_fragment[:-1] = b'9'

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Transaction 1 has invalid signature (using 2 fragments).',
      ],
    )

  def test_fail_multiple_errors(self):
    """
    The bundle has multiple problems.
    """
    del self.bundle.transactions[2]

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      # Note that there is no error about the missing signature
      # fragment for transaction 1.  The bundle fails some basic
      # consistency checks, so we don't even bother to validate
      # signatures.
      [
        'Transaction 0 has invalid last index value '
        '(expected 2, actual 3).',

        'Transaction 1 has invalid last index value '
        '(expected 2, actual 3).',

        'Transaction 2 has invalid current index value '
        '(expected 2, actual 3).',

        'Transaction 2 has invalid last index value '
        '(expected 2, actual 3).',
      ],
    )


class BundleValidatorMultisig_CurlTestCase(TestCase):
  """
  Tests how :py:class:`BundleValidator` handles a bundle with a
  multisig input, using the old Curl hash algorithm.

  References:
    - https://github.com/iotaledger/kerl#kerl-integration-in-iota
  """
  def setUp(self):
    super(BundleValidatorMultisig_CurlTestCase, self).setUp()

    # This is the result from ``examples/multisig.py``.
    # noinspection SpellCheckingInspection
    self.bundle = Bundle.from_tryte_strings([
      # Spend transaction.
      TransactionTrytes(b'GVJ9TQAQFKGGO9TIXJYNXOIRMXOKUFIEKDDUXMUHHLIWWMQIOFROPAWTODKLLWPFJZQQIENGGPFEUFXXYRBFMZBWENUBKAFFNQVZRQK9ZQVUDXWSERJDZMYFGJ9MLDPTW9DMB9GEWFEPFSZAKMPBLKOOVBLVFLLCVQXAPCVXQBJXDXOAEFSQILAHQJZLNOAKJGSBKDDUIXRD9ZB99NRELUIWLMDGIXTLSBJCFNJCV9SN9LXWTHHEILYKLVIVSKBLUP9JVGEFUKZHIYUBZXRBYOZDSDBAAADJLOTCTPZEUGWQXOKXFWTCQHAMHS9ZRWPIYOYHRJT9BNDTR9KBYYUIQVALOHKQXHWTCTLQOBSWCL9GENFLYKDJHNHBYHNTYIPGXGZJZPQPPOZXUHRGYVSSFNTFRSFVDDBHPOOKVEQMQIHEWKDR9OVZNDPZIVLXSUHTVAAZGVORGD9HFKVLXWFUWLXZIKQBTVXTZZKDQUQGGVFEIQOKFHB9QHESESVUTPCMWJOT9WFVFDFLNSUTOVZEOMMRTTCZHZMDCQVJ9NJQDJFDGJMTMRXVJSYSKSEGD9ELOYGUCATBNSKMFQZXROHGWABBUOPVQSSEMYQCDTOROSSUJKIKARW99UCARWQOOKXRLJFREG9YGFSFIGYLRUMURYIIKRTZSDPQPFHWSG9HMBNAMDIBNQDVPIAR9QOSYKWQOYJFCDUEQND9RBUKBGDKWUEZAVMIFEDEZKDCA9WHNDJAQXBAOIREZWOUJCZMKNXONEMW9QSBQLNFMQHAXMNKWKBORCQBVGZJSAIVXELWEYXNT9GCNPHUTRVINSNNMSMKXPSKTSQAB99HHKZXSP9N9SKDCQAJBBIFAUFKDUHZSGHZSKARULBTNUZAGHIUENEEMFVLXAKHMYYBDOAAWQPCDAWMXGRGPKQBSFOJPJDQHDPWS9ROMJCBVRZZI9SCKAIN9UCLRMQRHVHIV9PXUEAEMRMBUSJYCMHODFFZOVTG9VAOC9NCBMYW9WJOOMAOVLOKUKDWALN9Y9MELUHZGMMGKFWXLYKSMQXIFJJQNNNVSJTWEVRRFATYMXSCKVQSIVGZERHJCRLFMKHUVKDPDYFVZZDWWK9BHVYP9KRGZTIWPL9TDL9MZSHOCKC9BCZEIKIHDFJSQXILPRPVZT9CIRPUQX9NWQRVFTKMEBSRBULFUYK9UJBRZJMQCDLJNYLLTYXYIGFUI9NXDVXBXGUBU9Y9HMSHMGURNRWCPVOKFRRFPKDYPDYK9PTTBIHMBVXQVQHMVELHEKUNPQQPTMRLIPZIBFIML9JMZUQXG9CHEJMN99UUYGVTX9QRIGNGMIYIHY9VHLWJOLQPCA9NPRVPGUXPWCWUAANXIZVUWKEUZVRUTKFBQLIQDAWBVRICRD9BZCKLIISKOOZJZTZRWWKZD99HTKXGGJNLVMJ9TLZSBQNGXIEABJOQFRKHXDPVSFISQLAWAEDYHLNY9RNALGRTETYGURUSRSZHSJUNYYMASRNHYLBETEZKFUIQMYIBHNJZKIFUFPDKTHRCGUDWTBZSWEEQVFREIFHT9MUHMXOTNFZZAJGYSXHCOXHHBAPCDTJHNMXZGFLPRAUSDOBHUO9WFODRQFSHMLKZKXJGEHKOQDKPAO9UELDUINXI9TBOZTTZ9ALJ9DBBPCBRZUKGUCVMXJLKKQFDJFPFVLMBHYJMHRUHRQTCK9HPQJINWEE9PMWLHN9ZWRLNJEUAWDIZUEGEGVBGVVJBJKZDKJIWKGVMJRSXFZVWKFOOLH9BIAXPPCIPVWXWEOSQMUGISPGEHVMDZBCCKLC9XVJXIZPNWKZGECLUNDUNZMNJVBQGKNVRYBO9MBPFDRFFPFMIMSLGZQWORXGN9XUUWBQRLRTAQOVGVNZXTFUXDEILZHCLJILYDKOE9YBVXDNXBPDIDHGHXBCFSZZMRIKWISUFPGRKGH9I9MBRXW9XUIQKDKEBOSHNGVEOWJTBACUHHOQDWYPDPWZEDIFNZRBQJVEJHYPWOLNAHQJRHRBZGMPHHBORZNGTZQFP9GTPBCBLPPQVFMKRMJLQFLTAJDOMFQHXZGVZFUQBFNJAOPFYRHAFQPHWMPRPXQDHKSAMZUNAYEYOE9Q9XGXMJFFNWPGYLSOPXOXAKEEUKF9ACKF9UAGURDWPXUZYYVFPFWO9ZDICIKOQFIKWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALI999999999999999999999999999KITTEHS99999999999999999999HXUBQXD99H99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),

      # Input (requires 8 fragments to store the entire signature).
      TransactionTrytes(b'TDKJI9LEFSAMBEVUEOMJUJRVXDIWAPZJZVTWAPLZFCJBKEWKEMI9RYBIABRELCYU9TJAZKBPCOZYHZTCXEXJXXGZFSAZBNNGGJAFPLSZHG9PEFMRXSDHRGAWNIJVSPWFGENTPGWQUWCXAGXGWJXSDMJXXC9XAPFOTEQVJHRGQEZSIHKKQDJZW9NRMGKJHNUQMKNCEFAIRXURNEWLEVXIHURXMBQGYFYXZGXBIHESRFUMU9S9LKKJYULLGWQUIGY9UMWDVJEZVCLEQRIFMKOXZIOLOUGYTJDYYHWAGWCJWKNNZ9VENFMEBEFPOLTQICOUWHNYVINR9DSOGQCH9QPIUZIIZILN9JQEBERPYZBJUFKMQEESGACPFVZOQZCFKZARGDUI9EBDBIEVPMEU9RQD9BYJGAIFLSHMMZ99XHRBCELITCWHEHVENOOFNTAZNFZTFVTDQOUCM9XLUOKGTGRJKIIIBZVXPRDEYJCWRXOOOMBSXMKWCEOXSGOOBQWRAMNPGKJQPPIVI9URFNMBHMOAJUFOLFNIJWEHUQJEFEGYLEQGCG9TEZCLLVUNSKZWCLEHKJEBJJQKYFEQ9IPQDICBEJGKAUGS9GDMOGPEXZEKUJON9TAWFVOGVAEDTXTCVHZWELOZTCXQGRXIIXQEFWPZBFTCCAB9PSOGIFQJGNLZTFGIVZUPJVQXB9JLAYBW9ILHBHENWVBFLMZLDPKJWBFLRBYOJOPGOXCPKUYAZQWACANHSISVMEKBBZOJXRMVHPFCJGMWTYJSYVBXERTVGZGTVGFZNYG9KZIJEUORNCTPNDRLEBXMRFUYUMYUZCOJSMRGGYXA9VUNQ9NTBAUNWTXKWNSYVZJBD9CFGKOYAALBKSIKOSKYRJECUITWEBKFPQUKEBAVSCGTSACQWLRWEFPPFGAWYDOPXMTDPIDJG9QRCGHZRYBDDCGPWKTNHGXKDRRQR9OK99MRKZJJFRKVILXQUTVVRWVJVCLORPHXTEHTPUFEXVBVIGUWVXWOCOOZOREBCKPGYZTVPKHEDLCVIQCHOGEMTMB9MKHOFXZCDYSLVPDAXTNYWTKPGTOK9ODLGOFFG9BK9XZDGDC9EPWBQX9SPNNFABHNVCRQFPLHGUHUJBIKYNEOHULQUMVUONIKGNQFSNAEWE9WBWUMPVVIFDT9JPJTICVANOBHGXARARPMMDXUNGWJNFXDBABZNVAS9NRGPLZHHQURABVVZSMQUOAXHCPMEJYNZVWEASLCBSFMDOOMXNKFUZOO9BKOJFRBWYELDVDXCSBIIC9LMLTLQFXSAGTSXORPBZNJMNEG9UIWGN9TDSJTMFQZNVBSWNWQLPIQOREWCRMMNONYFROOKGYMFFOJYIGZUYCCYVMNNNZZCNYZPTSDRFZKG9XFAQAJXSJSIV9SUQEACI9SJDPPWBFXSRQEWDMGQTDR9KJAMRENBUQYBNYDRQFQEEXXODDVTSXFJFXQAFGZTBYECVGVVTYJLHNAWVEYXTBGASEKJJIKQ9SVGVZQBVCHUUNLIPAIGFJ9LBHVGN9SQIDWGBEZBEEDZXSJNNXZIUMYPNLWPJIWEWXOFHKPTEDMBMMKWZSWIPPQPNHBVZZGAUCKNQXXHFDKFGIYPRRIKLWV9NYYXZVNSSTKDWBSIMNWANDYEHBMKTGOCROVZKTP9ORWSWMEALZBC9BBIZXJWT9TKDHKIDFMCUTGETRROIJIFDMIERXXYEIIKKDCVOZCAOVCHJIREQMMEXKOESAQWHJIWBDUFSYKECRVWJRQRBLKOHWXAIHAZVREIPXDIKEDAQNAMJRPIHDIXQLLPKZRCEBDKW9SHNYDJBJQPBIJ9AGMVGATRPCBPZRDKGAUBVVGTKLJWILYERNTZFBEWFFQEQKQO9OLLNTD9RQCITOSXDELAOSXDCDMWBKKUIUFNNHIJTUAAOTNOVXGBUXKWMNXIGBWFVDINBEBVNKCOOENLHBKKW9KWHKULEJY9XZJREEHUOGNOEHITMCZIABFFSGG9DYGCHHUACHFXHJOWQBFXPAKIIMCTAF9TIMKUIAERCTDSHGKZYHSROZUQINIUYMFZLYWIELARYM9RJDYSYWUNDFYUACDITAWLCAGFLWXFNIVVQNAJNNSJPVDAW99IXPEIFALUOLPQIJAFHCNTZDMS9CUFUITGWKUZEO9KGUNHKPBXAEWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALI999999999999999999999999999KITTEHS99999999999999999999HXUBQXD99G99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
      TransactionTrytes(b'TIZUJYPRYXNEPO9CADASFGX9MNIWNRMJCECOACVWVFANNXVQUATDBUNZYHTWIUAMOLMLJGJZCOJPUYYNIGBWANVKEAAPPF9XKLUQERECEBFHURPSFCZFLDUIHYJXFIAVIFWFLRKJQWXCLHLFGIHTLBDJCSWYAPJ9SDZJSYXXPZTCLLDXFKWFXGRLEABYESFCOMFKQHUYGOQLVN9GPNN9NCJTIURBWOYCDTRRJPUCMJEMNDHUFYACSDKYFROLRDBVYDKV9QZPJAUASZMZSYMIOUYADETJIASNKYUTDY9WBEMUISXMWCGR9LR9QFQLOWPOGWJPQPKIJJD9BP9BTOMBUNJUFMHZSUYBUTMEZPVXNJCXMZKBZGZJKDZDFBNAPPYWKBQXPHPRYWMYEHRMTJTPMKSHVXDOZSBY9XWAJGGQRDYHFIJRZOEZQTHEBNYEVLITCT9WTUIVQOFQJAXURIELYKAEHBETWSNJP9QZFDPLDPFDIYSPWBC9SHHBEFWYZ9WYTFNOJNHMZUNQH9KNJFHEYYIGTRJXXYDMCWH9RGBZFNKYCAGIMNKBSRCFVKKBZEAASVYTWDJ9E9LVCRTAQO9AROF9FPTKWYGFZRBOPS9ZRCYYJWFCSUOLJLPBTRPMCNK9ZWGCPIGIGQYXEJEQCEAKDKGIPJ9AEIWEYIBFGSSKVBO9KSJODHCVMIYPTQ9KIICAAZAQZQCKHIMZJGJAQGUNVBGTUSDVZCIXAMTULXGZXULRCMJOKUJNFDW9SUMKIULAU9SAVVRVBEVPHJJCMMBOPQHVIJDWYJJMEJEZAGYPOHFQMQSFNOOTWTOSTF9UO9JBLLRBJMPFTEFULKIKNMY9BNTZRDDFSLXBCLCRVXYHGATGUMJXXOSNF9WIABUTHYYTNS9OUNLAOWHPXWBNPDGQJ9KMSHL9PFIXIERQXSLYILNVAVIOSOM9UOTEAYKIEYDNPDHWZDIUOABNLADSKHPYCXJ9CZAFUD9KNXLR9SDGZCTRKPPCCODDJQZEQHIRFOGDVFHUMEKMBUKNMDZYYHOWPQUBNPYZ9DNBGSCRQMOYLPEHMVLZ9VNCRIRUVNRPZYNMZMHKAXYKJTXNLNOVJRGJFQHWUCWKABNXDXOAFU9TPWCFNRFWKUXJSFY9ZZOABINDPZMUSTMPAELAAUG9X9E9XEUTQONQ9SGUDYGYGSQ9MQLHEYUYQLOSFG9T9CVXUUARXYVAQCIVPKHXKPVLUBSEHVUO9MLXXWIUHJP9WFDSWUZWIJDJSLLUOBLABWTCVTZQYYVPHNHMNVNXDBHKYEXY9ZTRLM9EYEUWOGEUKAWZGKQGAIXWXDWXPGXVELFCDPCIAY9WTZJNJQMAJEFUAMNGJQ9RWEHQYJAMA9MRIHDIXMSYLLZSJ9AQZHFDLLGOZXINWWE9ZNGZNNQFIOAHRNMVRKUBVFAIYISTSSTMVSRDG9KZC9XRVVEHJVVVFIPRIOUXMYJX9ACVPVNOBUYNUEJHAYXITWLVWBQAYFQXXRENRHZAMRENQZAAM9CA9KYFFFRFVLRJJMWHPWSXGFOTSFNEOAHNGOBVDJNLTSJAMXPTFZXMFBDMNVZ9XFVYOEWOFYRLUFTLSYAIJCFBHFAMGGSUZCUKBRWBPUEPSEPOUXWOPQWWBTXHVZKEBUIIAZXONCBMUGGJUCYRVJMGYVKORYJPSMBJKGJPCCRCMYBQQIRAJPJFXMBWINHGDVXTYVBVJTYJIXFEGGGBDMQG9UIKRLAHH9WTOEKTUX9SDVUIICZQCMSNSEMXGTKVKLWRGO9VUDAGIVRBDDDFUFVKXIXVDEZYEUWQVJHKYSTTYCFWPQWCBBTAYLVJTQJZEDNJKYEOHUL9VKCNRFFRDKPIPTOWJTSEG9POFORFBUHGAKIWC9ITRNCJHWMKUWQAOMDZOFCXETC99HJLX9NYBMLJUCBXDIESMNPYFSGAWFRCQGDKELLNI9BTOUFELHXEXUWVEKABAAZBLZLTNNBQOIAIKEPOQWUKOGVTUYOL9QFKWVBYVNPNDFUMBTHHFKWEZKSMNYURZEQP9KRKCIKDWNMXVXGDPRFMCLSDZSKLAFEIOVMHPJKBQQVLWSPIQJAC9UUCIVZZARODKIGWQUEOQHLPLXAVHMDLPZEKBYVWUQRGRHKBWVJAT9FQMBWFGGHXZRNPRBQEENIJ9YHPSW9VJOHWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALI999999999999999999999999999KITTEHS99999999999999999999HXUBQXD99F99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
      TransactionTrytes(b'ZVCSZIBVTNOSBPDAKKDOHLRIOQOKANO9ORRKWDXKOIKMFZRHWKLMJDILSHOQQRFFBGYDPIHKJIALTNMGTRRDLRX9RLRUISU9WTONYSCXAXOATYBCOINNJTOIFIEWPUMIGD9KZTSZ9YAUFQUGSGNPWGLIDFSNLW9EHWCBGTREBXWHKGWVAVFPZFFUTKDWQI9RAFUZGBZODZWWVUHEJEUHUWJTFPTAMEMEBKM9WYUAMRFOOKQTQ9SCOUTLVOQHEBZYMSVDMSRLLCFZ9RQJPNQXIFNIFZPLXOJMXYRAHHNDYPRQMLOWDJWDWBBDKJUWCY9JK9HUZTOOZWONRVYLNZQIGYQ9UOMKYALOEKIHOKIXFPUGIXJS9KCESUGTMWMINHVVWVDNOYQTUCGEAMUOALKDEGMDJNEI9MEYZZLFDQ9VIQKTVSOZ9QM9MNGAYOHPLOBUL9BL9ENYVXXBLDNQPXZIAOLMPG9WLEXCXJZM9SAVPO9ENNUPCONSFMAMJETUUBXQO9ABTPEZIHWYSRIKMPYFAFNKENXGBLRTKEDC9LSBFYRXIEXSPQQTJXVN9LKETZYKXGCQCREPHVEFBAJHJPY9SNLXCCXTXUUY9XZBAGOGRJ9NUOVBKPKXEYLZGSHX9PCTAWHCRCDTE9LZDRRC9LQEYASMSSRKPZNQYUPBVUOSVULPJS9SKPFLURGFOZTQERVACIYEUVGMVDMHOBYWEZEHDHLMV9CEDVETRQPCUAZBNLRFDTDMHGUZVHRXBWGXJXSXKUUAFIJGAJYKJYIAXTFFLVKNMMVMUECBKBSMON9KIWKJCVRSSGHJVKGIIWQHJLEUZESOSZRSRKADPTLRRNZFZIMLIQ9RGPPVUCCNQRODMXRUTGJOELBBZDZHHOAMHCCOWNRZELNWANVSYRIDAHTRKSCQUFWILBPCLDATNKLLQOAIBKFLLGLZGWTKGJWDZLXRRBPVCEAGTXHRNEATPYGIJNPPYWCSZVVVHAHDVQOZFYZSTISMWRBBVJGAXMFCIZGLQV9KVRETBOHXOUTNYPR9VNXDMIJIAMMMZRMDCMIZPFGUNMT9GIKNANMPUABRPAHIFFXFTAEJKFMIIGLRYTXKNMGILCCCRBZVIQNFUCLRPU9ILCTZXBVEXMBNBOELUMUJGWIHTVOVSTDFZAKPMHZWOONVZCP9SZPMHJXDE9GOMVZXWNJVZ9DKDKOLTIEWEGXCBQPAVHXNCGGQDZOPS9REQTEBMTHGGDBCK9FLHJBBSZUDYBFRBTCYNROGVRN9RGNMGDBMVPICTIBSPSFKDZXTCGSDBIGCLEAEIAEZLLKGQE9AGAHWSA9PVHOZCAD99ZHXJQQMKYUTNLTVRJXEYQAVQKDTYRGDWXOKDEKYZXCCKEXIKZLCQ9IAZLZKEZAAYJVKELGBUFJAA9TBDVSFFGDSIAAFAVMSKQFXMKCLZXENZOVOXKEPVGVTEXCEEFLDKRNKHABHRRVMJMPQSDGZJVZVGUZTUDFA9PJFOMXLQEQNVMCXHHDSDJJJQLMYOGKDBWJMGKZGOIWGIYHKWLUSTQEZXTXKEW9KEOVRAJRSIPESIIRGLKTKBDUVKRDLESSKEIGMFCCMWCUQYBSDINZXDFCDSUUAGMBDAVISZHQJTOLOXXMZHUJKM9HXPFKJSNJWMWFAMMHSQVSZC9WZLDD99DCOXDGAUBIROEIKFXYTQXDOCVDSRSFVLDQIVUFBNJXC9YWFSVBHXEWUZVGFKGJBXE9XNVGVIBUQRFKJVCDNVUSERLLHGGQLIETWNGGCRTNPMAJAD9BMJWRFDPFOJOZKZGZLJMMIZDANBSXNTUANOOHN9LYLMIUZLGGWXIXXJFTPUS9QMZGL9Z9BHRHURCBIUNQKNJBCOKKZVUZMADWBFGDVJEHKREWYBEA9LRZFILQIYDLPZZ99LVXTCPOXGKPSNSXMDUFWYDVTKMBXUNTMSSZVZXXLMEVXHGNHDTTUAAFMRGGYCZDGUGLT9YFIHSCB9CIGVPEGSIYR9S9IDYFOBWDXQYLKYYEMRMRKTDSHWXSSTIHWNNVNSXMTSORUPCJFYSGWEKHESGN9RM9IHHPTTNMYNGQVEIYAUVOGKOSXJSFGZFROVWFGONQVQJQUQTBWGZ9MZHGHCEFECONQX9NOAVTLQXVVUYERAPEPXFDPPFWRZMUBTTDKTPDSSLOWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALI999999999999999999999999999KITTEHS99999999999999999999HXUBQXD99E99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
      TransactionTrytes(b'QDXKWIQHXUINEMHCJ9AJVHPOMMESNHPVHAHGTSNFWMHPKUGTDADRRWSGHGBGUTZRK9HMCFHKZJYUFQHGJZGKKKEKKZUZSXVRJYIB9PPO9MTZZAKTPNWGOVFLRWPPLAO9VZHBZMDGUZOWXILC9LAIYPBDSTPRZIDOWKBRWGKROSNOWBCXGDTPZXAULESGFHQGCURKIXET9CWTRPLESSHBUNUVHFZDVDMB9DVSR9OKIIEZTNKVUPQJJNIQRZINTKMWWQLWISYG9FDUD9VYXU9UIAXFXNBKVIV9XVUKHLWH9JAUXVQMDYZZVXLLNVUZEEBTUAFZSPFTTJHMXGKLAAEGSGRBFB9HCU9BKYWLYWJBQGUTOHSXDUUYROAEZDVQOCHXHSFEHCWMVJJTUDQVYFHXBBVGNXHEYCAXHOHVCXFBSUCPMXKIW9UHTDAGCMIMZVXAHZLHFVNIMJQHDPJNAHO9AJMYWXUAMFMS9MPSZOOT9EVTPQRXBG9MFPJWXDSYWJLYIDAHXRGMZFEYZTSUSLSQOMH9HGOILRBUFNZUERICIUYYKQ9RMIAGN9EJSVRMHOQGMCPUZS9AFIOIYCLXBTACMOMBGXKEHUZJJEJGOZUSMMAAVPXUTOGITYDAVTPXRWDLESNXZKCCNSHLUQ9MHDLHT9NMFMOZPLTPBVAQPXGXWTKDVPEBAJFNISQGPRJNWNEXOEUC9ZJGJXGEJNWBERHJJRFYMPG9EVKBESTZFWPKOMWMEEAYHTPNTFCIRBOFLFQGOKOZLQDTENDYQXRKXTMOSPFWYKNKUIRREZQJSYTHQHMEANYHPFJNNKLLEPSLIWQXOBQLNAWAHVBCAVYLIDTKILBLTCGXDCJNHOABVVFROZBOCXINETQKIQAIDWHFIKQJYMFZKKNKUIHLHDIJODFJHSD9IOZZAGNJJJR9MCHAANUCKAUKZAYNVMJPULARPCTDRJWPCQCVZPNZRWFPDYJPTNQTQHVDUVFHCGRHFKLDPBXYLUDANFLLOUMJZFZTNEBCAO9OSTPYUVNNHBA9I9OWDGAVSPBOVYGOASQDECRSXCOXXEUSAIACHGTKHUSLM9YMEDMNLMZVSTMRKRGOGBIEKUUOQVFYEQKDGVBGSJBZP9UWSHLWCJRGKXJWOBPLJUPTFXN9LHJRRDODYURRUOJZBKJPMCSJYQDEXKFYPRIGOJTAFSNVISYJRL9CHPOJ9IBMHUODALXMOAPTIXDLHGTPIPEUR9SSFFDQOCPQMFPUCFGSFCFMSAVPXT9ZQIHIHHFTBV9FAMVBNPHYCKSXAGVEQSTQBUNCUIBDFNUBQSISZMACPLHDARLHYLAMMFCHOLCCQERHTFEMYXKSUBASH9ALHVILQZGN9GBBIVPOYRQWVQXGFKGRHTNWNMKQMKPUQDJB9OGUTGDHMZFRBI9GDRVWFUZG999TSYFLY9PBSXYKKRHMOTWAUOBNCJZJQBBIZIBTCKJFNPGEK9FZPUAERPA9ESCKEY9RKRAUNKNGEJXJMBSSYFRLUOYWNKZNEDFCQVQ9QGSLBMFSCPSEAGCRFUPXBXVQAHQSXWAPXGMGYZXUNXFE9ADTPTFRZXEYPZZRKFWZADLR9TDWKVSEVRXOOVINRKYANNBIWIPPJ9RMATUICLKZK9KXRFUMQMNRQPDUNJGYLDXAWPIHKSFSVFRQHBGIWMRCDN9BEUSPBXHNNWJMCHNLDKLYE9SVYSCS9ZZSRFLVIAGKKHTTDYLCTRVOCWXKQNURWKFAMJPTNNQXXLKWAE9FWJHGINNQTLWHTMHCWR9AV9ZPDZRSNVJBMROFVWVNORKKUSRHLMHAVSPBHWKFLKMGMCTQMJELDBVJUATRMUFLNPGNJOYFRUHDRZVFMIANLECBFHMAGZUFBUHNEETSZGZVMSIOTHAUKIAYVDBXJJXMCECSHDCMUAIOSHJZCBARHWLSVDBENZISNDROOZW9ZGPFEIDRWZAWRU9UZSJTG9UMAKRVQODVJYOHFTEPDSHOEKBWFHLNXEQXCCZNMTFN9ECTPNGXZVPUPWTDPCOSIXJWI9TMYKDJTAS9TLRORJRBZWLZMYJMYSECVMMHJJDHEHVCWJDOGO9QFMLXPLTXL9HYCWTKUPBTZIKXJIXDJA9RHFAWEQXIECWGCUUQYELVCMKCDWCGKXQRUKTCUSVHFQIAVXNDLAHQZPJWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALI999999999999999999999999999KITTEHS99999999999999999999HXUBQXD99D99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
      TransactionTrytes(b'FOXBM9TXJZXZZWCKTPUGWMPSMTYW9VAAS9ETIGGHY9BUPRBTUBLTIWAML9EWYUISFIGZBHXO9UDHMSXITLONUGGQTTTWEAMGLKGXTPVADNLUSRDXPBPWLQCPSXJBDMREQYJJPQVIEVLXVTEEBTSNMBUCPUFQNSIONXZSPQMKGHVURSMDCIW9IORAEOQJEWCNWSMKTHRUTCZ9XHNVRAOYNCKUGABWY9KYRDLPQLTWYXKCYOQIELKBFNXAWTGKLYTSPFACCNSUJ9NMOETDJAMEQGCIGTNTSNNALCS9FNGWDPWMPVSK9HPLNGMYCBGEQPZHKGLYGPHLHTKGKMWUYKAPRWFHRXTBKTMQAEELGQCBLSBCDROEJAHTEUXKATAOQRVL9UZUK9GALZPLWTBTDFHPDPC9MRIIN9SQEOPZFXZLAPMJUBY9UXVXUARBMJEUXEJMN9NWMVPWNWZ9FYIMSTTHV9EABVLFYDJVZBIJAJTPRAOFTVCBEKWFRQYNDCJEOKDKQUIO9MYHCAWYRWSYCMTZQXWDPRSXQZEUYFNTFNXJOJNMZLEDECWJYWIUGJCLGKOMIH9MPXBMZLLUDXWPEJJFPYHBFQ9MYWT9MFBLVSYCFDGEHQUAKCP9S9IZGGYOMDUMSNFFSNSNJMPXVGV9KMSYOSKDVCJTPCDMTVL9YIXS9ENPCHKSGFEPMNVTPILVXKTQOSDPCLCLVWBYQBTWVYQBTRGKDIHQZPVAKDRTMYLGMWZPLSZ9GDYC9RARWWHPVMMYHBHUIHAKRGKZLIGPEWIBNXFKRDPJRVRVKKYZXGTLZMJQBHGODUV9PZWMXDUYPCGD9MPYSQLHDMLUTILQNWD9PUSTQHVQWBRBJSBRCFIWYHMVMKLHWAXWCVPTKAOTXW9NGTUVRI9ESHOUAZIBDLPJDAKXIOIHSGNEKXNXEYPNEXSO9BNSZSAHUOKPBCRBSV9UQYTDBEPV9AJNSSPAIEZWLKUKYDONNIEPMNLBMJXSUVYDUBFUOOVKVXOGHXGOZGMLBAEKJEIZCHWNUKFPDXHJSCBFXUHFJVUMPJQTQPGESWNEYFKFXHNNGMFSAOQIVHJ9GNQFKDADDJGQZGSOOFJ9YNPWDDDTFVCHONUUHZDODHVCOOHTUQPCBUYDKUPDJQTYXAEPKQANCRGHOLUGVWIIBDH9JVTAYGOEFCOTEQILTDJ9SE9CJOCGQJGPCWXIDUPYLWBJGVQXMZGGAWURAUANJ9JSSRIHKNBHWNATKBJDTXLWWIWFXTMSHSQCCPGHFTBRMXYJMKBYDPUXXPVQAVDIX9ISDDDF9VBKINLYNNS9XVIBQKWSXF9UKXJKQXJHUCSMHPJYBOSEFGQFRWANPOTXFSGFSETSSE9I9YDSWNNAKXM9MXYFVZDIJOCRBQGKUVN9CNYEEVVCTIMCYQVEAZLEQQZXTNXPYEHHDUHVJGKKMYXIOXPMXUGJLOLFEHTAG9LGOXISRYTGJZHMKESGNXRZEWODDNMNMXQWHGOAMVL9XJBBROYXCAEWMLXOMDKLQPPSBWEINGJWFNFKVYNIKPJEARCWPJXKWH9JMAFKDWX9GMUUKUXDHUIUGHVSHUISSGMXTPGCPNMWYVMDXRFHSGPCNVTKQCMUWMCHRJKAQUEESHBTRZBRLRIZKJ9BJREEO9PPIOVSTORGOR9INC99TDDMCSXQZLFOUMIOTYXWMGPDSLYSMWPCTXCTFPEWD9WTHZRCNYBMCEFCMIUAZXDG9UTZQEJ9HYNLVBLYHHDODPLELAXXXBDTMZWPKLLRAXWJXHJPRWWIDAGGCERUVAAMHYBHNORTJHTBOORFXDMBKLOZKGWZEJLZIGDLIVNFTTZ9EUWJFVESZBMUVLNCXESFAGGDRSKTOYBGVEFKCFIRUJRZMUVXMANVZXXMIICRQSJKFHNSWYGXCTEAKMLYWCIAXZT9AJDJTVTJRHCAEHNHWUWQPIRWQMEXNQYREKLCSGKMSRVJSKYYDLREOTUDXCVSVEIRXVAZEWNHWPECVCDNM9KIKELEXZEBYD9ZNGTRFMMKSQRI9MYAMITL9FZREEQCYXKFPWCI9MJOFNTJQTVJCMFCVRNVMBPJRGGFTHITUWRGLLRDLQHWSTOWXIMZSWLPCCYUDPATCNCNLWPXPKRMGPXOG9C9EDXFMWXGVGRMTXEOSWOEGONBCEUJARCWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALI999999999999999999999999999KITTEHS99999999999999999999HXUBQXD99C99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
      TransactionTrytes(b'WUEEBSQOLEMSHWDFSOUPIPGEWQSAUMIKOUXZJMA9XIBGKA9JHOJIJJWQGBVVSRWYNLEL9AZQTMNRNCBWAKQXATGBPPYJQVKDGELRPWQJKGLGMDQNYNOPOYREOSGNFWHERCITSLWGPFBHIWWJUPCFXILTNMJW9BRCXUTAWTZEUZOBEQJAEFSYEXOMXEHSSFSZLMWYIVWQEWL9HCFWEPXSEMKOWYPCPSETZZXDNSKRSHAVZGBCDNLJYDUVLNR9LNTUEXZSSWR9OXJTSPO9KTLJSYSZD9XWGEPRMTRQNSXIIOADAYRT9IQLILMGKUHVCSDOTXEAW9XTATTUWVDVPGUWIHJKGLTQDEXO9CGYUBKWDVKXUBCXGZDXYBXJCJQHYUKGRDRFWVYXTIZEIDTJJEFBRU9LHPELCMEZCSFGPJYZNMNK9SONRFPCH9PRHBVUTQPTIPGPNIALHKXDHBAVQDWABUEYDFID9JHMNM9AGBUOGICHFGZLSUWBL9ZJLZJZHPIVVV9ZGNXHUJRRIDKFHAESQHAHQQTXKBRALIGKDLCADQWIUHTJWYVBAAJ9AXNXJQDQEVTMVKASMDJEZARMCXZIKWGMRUTJKJ9YNCSPXUXYDGCNEAZHIKFIFOMSMDCAUYJKGPCIGMTKXEUJLRNXKYGPPCOHNVLZMFYPAHVOVZLX9PNDKGAYWJXNTBMIPJGSMJYHWYVLGDUTW9CEPLSKTDWREBOF9LKZVOHNXQNKDFOWKQCYDFLEZAKXOW9WYHWUFMFOEM9HIVHCJPDGEWPJEXIRZAUQRLKYGIIJIIANCGSQRMMSQXL9RPXUAOFVQCYLLJLTQJGSGLVITGHDCXBBYRHSGUVXNBEFXUGCVMUGGGXBIYODDMRBSBOLGKJQHPIUBSBZVZZVWVPIUZWMWOGAALFPNCPYFBBEVPAGLLCWHQYQBFLVHMXXOPWUBYAIJBABVYTK9ZYCNJVZWTIBBKMTG9GHAOQZKGWOET9HOHYDBUVUAECLBMWBUV9UUMDMXSWZLJCYNJWSRZJVTNGMIUYUGBZJ9QRTQZNZFSFP9YOMGIWYARHAOXVRZHSFKQMYFV9CJX9AQONTZDUMMMNLZEGYHKDHEOK9FPOOESYTCSZGJUXZTUVJHCZ9IJZU9GNNU9PLFECQWIFVKS9O9EQSDYDJT9ADDXDHWUXVAYGDKFRBCQZAZGII9QIVYEWWQEBOXSPVPQBHLDCCVQIEPTYMEBTSNIPTKS9OREXNCMLELOJYUEUNZLIGPFOUIBEOKAQZIESXFGXTWFBIYWVWAXCSEOLIUBFI9ZKSFASXBMQMQCIYXDWSUCEJHNVRG9AYG9YQMXRBYDRMGZYZZIPGGEQEROZEAGYQOWTCQI9SJSUTGUCRWNETRKXUEYMQXVRT9JHAAPIQMNCWWAXPZOU9CXRHTMUEYCGFI9TTRQIDIGSTOCGUUK9DYY9WPPXEVFYCADLYNZNYERCGVBXINZSBORYBBDKYNUXRLJAXXZMWVWUU9TVJEHSXAKRLDVYSLT9GAQP9EARBEVXYRFFLUUUQKOTOXRWXFKMDSATZKBGBDVKYGMBSDHVUHFWCXZVRABFUDEUYLVFMOBEIQLJQAWZDGFPL9NUHEASKAJHHTIDENQU9FFBLHSYDCL9URUPW9DVVENORYYBTIGSGZTZTSGCVIZVSTJNAWNVWLOHTEXPTUILX99OQINNLVGELJJYNQDIDAFSZVWLQJRJMPTL9NIUOCRYJQZKYLDELXZ9SVJEXCLENBCLUNBXYZJGKZUEDQTYTLCZDIKIZDWHCXVMZMCDGSQXAVZCCCQGNZBKHZTXKDEBLTSHVNWEIFPHFYWEGZECMELBNXZOVEBDTLZYEXUIXMQANKXRGXOFB9IJWPUHZRVJCEXJYKXVVDVFNEBEAFRJQSVQJBTXCVRICFPMHIBAHTPZKIVOKCAYZNNKPIUHTYG9UJUDHGZA9ITQFTQEYMTYZJEVGETBLVWDZL9BAGDTLFPVSBZ9KVITWM9WAWBHCHTYBZERYKBUSIBVDPCWUEEFUTGDPYOSGXZZCADUIGNHDMFJJV9HXTJMKVBTEYALJZXQTBJOCVHTBAXHUOKKHXNMBFLZXGOEOBERNAUGUI9SPQODKHRITTIWOVHRKPFERSLOLZOEPYMWQNWZBSXJMPQ9DPL9SCGXEDIXHINHEFXEWCTUWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALI999999999999999999999999999KITTEHS99999999999999999999HXUBQXD99B99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
      TransactionTrytes(b'BGDYNIDWEZBETNGCHADSWCWRFNRLLC9EFQUDQWFPEDGPDOOFJHMLXJSVSDVMVLSDSSXFSSSGESVAYVFJVTQEBNVOASHWLZJZNAUBSMCIVJHZGKIEBQPXSKWZTSDKICWQAMPRWQETLDDFYMVMJA9TMMSPIOFXSYUEVKAQWONWVICMLRLCMPVOUYLMNITEDNJGNLLREY9DOHWN9POYUZVYHWOTTTDJHPTLLNRNQKCPPYTZXIWHYKIUKHQ9EFPBFEWYBVYCS9VQBOKCZRRV9YNMJKMHFBRFARFBISWSTKJOXMUNC9MJQUXCTPXCQAYIMUYBECFPOVGDOQXMRTJTMMFUAWKVHHZLJGUGVZPDEQULYLQCUSYZDLUEZRWXUCELFKCDM9TMQIMQYVSUGGFCCGQJSUWOOTMU9DSWUWWGWXJJTDYJHUTRKSCPARCI9DCHEJ9ATQQKXJOVGECOBMTKOIYQBSXQWGCVQKM9YPBKNGQMIICAPEBBZA9ZAXV9TWCFJIJWLZPYUG9ZVVYLPJBBLZRGLYQBS9HVTHOMYUSQONV9DFVDTPYBNLX9JLNRGVIBKZYAFNWBSGDHGMZK9ACKMPZDHYEAJB9UERIXQTOGIUUGYEUUSTCNASDUKSLE9YZARPHEXBYKEMQLRBLLTVIOAZZBBGKSNPOXC9UXNTXXJTIMWFWAZNFTUMGDDFKTJAZZEGKGEDDCDEZTCF9ETJALSM9WHSLIMJVLYOQEMHGYFWAIEZAFBIXYKWCLCCPCDOYFHAVNFYHHGVHBFBOE9VNIDBIQRJSSWFHAGOSFL9PRDORHJNEOPZGSASUILJZJOENLLOAKTTDSALMUAKWCXLLDX9YAGOV9UEIDIMFEVJZWCQABOYNRJIFBMHVVTPFZD9SVX9CRNQAQBFPBOBBMBDTOYUXLWMIZWEUNIWPLDHX9LZTYUKMIIKBSMASNRAHUYRRJFHROIVESDDUPTCBAQUAHK9CTCLOJKFVDOKIRVZOVFJZAQ9NOI9RMOFVRMTSVVBIMC9SWFPFKSQECDLANVMGTMYDQPCKWXUNDJMXO9VNKJTGIIYVVEQWLAHTWOAVFYKZJNUQALP9MREOXL9EHHAYKEANWBVDPKPKRYEAJUYLVAFNNBYVCVHKUZQXCCMAQXNTHHHJJBIADSJAXOE99LGYWEYABEPRGLXLLLUKXWGAJRKPBOOEKMPZXAYODKIFRUAHIAXCUKQXFDCCB9QLXJHWTPSNATQGFPICKAERGLNYQTBAYNZZPXGWVBR9LNHCEUWNRSNCMWWINNEPSWYVFYVOXJIFXJAGTTMY9ICHHPFHBSCCIPKYWMPTZRPNACPBWQVGGTNTBMLGUBPGBDGKUGFMOCZEPELNAJUQRLNLGQSIEIIORTVI99QLKWZCJKLKIGFOCYZVLW9NBWZTWHGIEQEHHHORIFVYJWRNQBWXZWHZOAKDAGQROOTZSTRECZDXMNWC9RATEZDYMBL9EGROLCJSAPRN9R9EWRFIJUERELFGIHCEFGHGYXFOEXYMFGSSAEMUAVZZXVCIKGXTQFLPNUJVXMREZONJZVAENQGZNQCGAMHSACRLWJJDMTFJWBMFPACZTFHRPBTJVGHJRNVBKISPZGKTHRVJRYGGAFJPBGDESLHDCVJICLVEXJQVXFNRKRVCEKC9EHSPCJBHNGMEEXOUPAHYLMXTZZOSYZWLIAKCDNUNXXJBLNEVMDVENHN9D9MJVOBJZREFPW9VCQXPVJI9VJDYEZ9FQQQX9TKYZHVTPGXFRAOORZXIPSQNCUCUXWOQDYJPWM9GRXW9EWLIIJFKBHREVZNYRPXKXHEHLDS9UCQSQFXRKOBFM99DEDZQNJEUNU99FMIXVMXAKJHMGKYTGLGTKLDQBQBTLHLIDJEJZFHQDAWFYAGLFNWEQWIKTALEADY9NAJGRLIKPKRABIBTNZRWSWWIZJQWTSGFOEFYOXFETZWAMDCUWZUSMY9RYZQBRPCBNBOBPOTZWPFXQJTUWZNPAMBXFRBFYOJFIIDFCLYNQRVRJJXCAZYULHEEOBDAHDVAIMFPDSXDXYULGTOXRPHNNCNARKPLPJZIHMAFSNWTKIOQVKDGDDWOMFMIKPQAUITFAKQAOGLNXDHVMKDDQPMQZVHBZRIWYBDVJZFBJXFRGGVWZPDSBOKDWWHOKBFMIQTRBVAIDJDTGXIVWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALILY9999999999999999999999999KITTEHS99999999999999999999HXUBQXD99A99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
      TransactionTrytes(b'HDWCPCBDLDEAUCIDFDEARCWCTCTCNDQCIDFDVCTCFDGD9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999TESTVALUE9DONTUSEINPRODUCTION99999NDGYBCQZJFGGWZ9GBQFKDOLWMVILARZRHJMSYFZETZTHTZROB9999999999999999999999999KITTEHS99999999999999999999HXUBQXD99999999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    ])

  def test_pass_happy_path(self):
    """
    Bundle passes validation.
    """
    validator = BundleValidator(self.bundle)

    self.assertListEqual(validator.errors, [])
    self.assertTrue(validator.is_valid())

  def test_fail_signed_in_wrong_order(self):
    """
    The signatures were applied to the bundle in the wrong order.
    """
    # Swap the signatures from the first and second keys.
    # Note that the keys have security level of 3, so we need to swap
    # out a total of 6 signatures.
    sig_1_1 = self.bundle[1].signature_message_fragment
    sig_1_2 = self.bundle[2].signature_message_fragment
    sig_1_3 = self.bundle[3].signature_message_fragment

    sig_2_1 = self.bundle[4].signature_message_fragment
    sig_2_2 = self.bundle[5].signature_message_fragment
    sig_2_3 = self.bundle[6].signature_message_fragment

    self.bundle[1].signature_message_fragment = sig_2_1
    self.bundle[2].signature_message_fragment = sig_2_2
    self.bundle[3].signature_message_fragment = sig_2_3

    self.bundle[4].signature_message_fragment = sig_1_1
    self.bundle[5].signature_message_fragment = sig_1_2
    self.bundle[6].signature_message_fragment = sig_1_3

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Transaction 1 has invalid signature (using 8 fragments).',
      ],
    )
