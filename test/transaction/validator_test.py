# coding=utf-8
from __future__ import absolute_import, division, print_function, \
  unicode_literals

from unittest import TestCase

from iota import Address, Bundle, BundleHash, BundleValidator, TransactionTrytes


class BundleValidatorTestCase(TestCase):
  """
  Generating validation data using the JS lib:

  .. code-block:: javascript

     var Bundle = require('./lib/crypto/bundle/bundle'),
         Converter = require('./lib/crypto/converter/converter'),
         IOTA = require('./lib/iota'),
         Signing = require('./lib/crypto/signing/signing'),
         Utils = require('./lib/utils/utils');

     // Set the seed that will be used to generate signing keys.
     // Skip this step if there are no inputs.
     var seed = 'SEED9GOES9HERE';

     // Specify constant timestamp value to use for transactions.
     var timestamp = 1482938294;

     // Specify (optional) tag to attach to transactions.
     // IMPORTANT:  This must be exactly 27 trytes long!
     var tag = 'TAG';
     tag += '9'.repeat(Math.max(27-tag.length, 0));

     // Define parameters we will use to generate inputs/signatures.
     var inputs = [
       {balance: 100, keyIndex: 0, securityLevel: 3},
       ...
     ];

     // Assemble the bundle.
     var bundle = new Bundle();
     var iota = new IOTA();

     // Add spend transaction(s) to the bundle.
     // See ``lib/crypto/bundle/bundle.js:Bundle.prototype.addEntry``
     bundle.addEntry(1, 'RECIPIENT9ADDY', 42, tag, timestamp);
     ...

     // Count the number of spend transactions.
     // We'll need this later.
     // Skip this step if there are no inputs.
     var currentIndex = bundle.bundle.length;

     // Add input transaction(s) to the bundle.
     // Skip this step if there are no inputs.
     for(var i=0; i<inputs.length; ++i) {
       bundle.addEntry(
         inputs[i].securityLevel,
         iota.api._newAddress(seed, inputs[i].keyIndex, inputs[i].securityLevel, false),
         -inputs[i].balance,
         tag,
         timestamp
       );
     }

     // Add change transaction (if applicable).
     // Skip this step if there are no inputs.
     bundle.addEntry(1, 'CHANGE9ADDY', 58, tag, timestamp);

     // Finalize the bundle.
     bundle.finalize();

     // Add message fragments to spend transaction(s), if desired.
     // IMPORTANT:  Each message fragment must be exactly 2187 trytes!
     // ALSO IMPORTANT:  If you don't want to add a message to any
     // transactions, invoke this method with an empty array instead.
     // See ``lib/crypto/bundle/bundle.js:Bundle.prototype.addTrytes``
     bundle.addTrytes(['HELLO9IOTA99999...']);

     // Add signatures.
     // Skip this step if there are no inputs.
     // See ``lib/api/api.js:api.prototype.prepareTransfers``
     var normalizedBundleHash = bundle.normalizedBundle(bundle.bundle[0].bundle);
     for(var i=0; i<inputs.length; ++i) {
       var signingKey = Signing.key(
         Converter.trits(seed),
         inputs[i].keyIndex,
         inputs[i].securityLevel
       );

       for(var j=0; j<inputs[i].securityLevel; ++j) {
         bundle.bundle[currentIndex].signatureMessageFragment = Converter.trytes(
           Signing.signatureFragment(
             normalizedBundleHash.slice(j*27, (j+1)*27),
             signingKey.slice(j*6561, (j+1)*6561)
           )
         );

         ++currentIndex;
       }
     }

     // Convert into tryte sequences, and output the finished product.
     // Phew!
     var transactionTrytes = bundle.bundle.map(Utils.transactionTrytes).reverse();
     console.log(transactionTrytes);

  Note: For extra realism, it is recommended that you also perform PoW,
  but it is not needed in order for :py:class:`BundleValidator` to
  consider the bundle to be valid.
  """

  # noinspection SpellCheckingInspection
  def setUp(self):
    super(BundleValidatorTestCase, self).setUp()

    # Define a valid bundle that will serve as the happy path.
    # We will mangle it in various ways to trigger validation errors.
    self.bundle =\
      Bundle.from_tryte_strings([
        # Change Transaction, Part 1 of 1
        TransactionTrytes(b'999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999TESTVALUE9DONTUSEINPRODUCTION99999OGFZEFWIVOZCAYNFOQGRZ9AIRBMWRRFIPCVLEG9ULC9CLIDHE9999999999999999999999999PYOTA9UNIT9TESTS99999999999NYBKIVD99G99999999G99999999EIYHEUACZZAVPQFGIPKDUBFPJVOFTWHADBEXIXINYPAKPUMGZKEKVZQVQREIZHYPEBNZUAJQXHAGDYRG9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),

        # Input 2, Part 2 of 2
        TransactionTrytes(b'DEFDQQ9AQY9HBNMZZTEM9TSUWUPNOFRJKHZHCYKMRQEYVFINUVEHKSZK9JZPRBHAWHAVH9GNFYDWEEADDC9WE9G9SKVFXJKKGWQWWRFPZLFBXLEKRGGHHQIKLEOJDEITGQGRAQFYLFESHTAEMLYSRAIIPXNRKTRAS9MSNCONAB9DEPAETSRFLDSKTACASWBINAEJJFGUK9ZPYSBRGPLHFYRJAKHHPZVWYSQWEVYQBNOYRVFVBTDLHUNYDQVGDPJEVOUBFMQYDCCAWDW9ZFROSVNUZYXEYFEKCKFGZLQWHPMZNHVMYZMCJGHOXJJZPFTAEAPAA9MAREMPHTJVDPVXCGXHCWBZYXPMBMAFIMCQQEUPHZ9AYQXAYF9ZKJSHBKOBDGLCXWAQICTVFDCZHJDCDPWODLCGBVNXJSBHALJJCHGKDQPRBWYGFOGVF9FKDFA9ZQIYCHDTJOHREJYV9FEZJIWFGXYTUVEWUBO9T9NGKFLFPMGNYCDZSERANRHLUDOVIIZ9TVWSLMNLR9KTF9KPNKCWTMQHEQKBFISQVLBCOAYHJUZAOBXNVAXRPKGYCLAFBYNFXFXGMPATWUOGWVHFQMRDLAVXKOOVUFDAUAALPGIATFSYP9TZSTFNR9WKUBIGHVNVCYBDQEWLGQUSNWYDGUISWKEPCHQ9EZQCECJTPIFXIRCVOKSKMKMNXTGC9JCVHXFULEENDRPBATTOPRLMEVBWDTQVJRBGRSIV9RRMHEPKEQEGZOZWPTTECHZIEHJXBLFLTO9VBCHKUWBASCSVMSZPBXWVUMPP9RBJNUZWZCVTYTDKKZJMBKMIPRCVIVMV9NZJBILSLLEHJJUWUVFFGDMAFPRYJCLPRTJLTAGGSHDZUERGGPVCSFBTLGZEENIVFXLXPCCN9VGWUAYATCQYVDQXLOEDLCTKKAPIBGIUBPAZBZCKEAFXRDUGHNEDXOFZHX9RUTXSWAIZPXWWJXTIXKODHHBNAFU99GQPQPPQSZCCOOVSLFOUMQCZ9QEAEHGPZNPRAGTPIFPOPECUHQMOHQSHHNEYXWSVNVFFNDUXVBESCBXNWEQLIYLF9YMYLRXH9XUBVUXLZFDYZASV9OREKCOB9OLYKMUGADKAGGQ9Z9LSIBRBIMYHGZDWFJMISAUSBXSFKUZLCFHDHTNJ9GHEEUYZMRXSJUOXNNTFXNHCRMMXCNNBDFIZXSEAE99DNOWEJZKPQJTLRJGXFMHDFIGFRBVT9WXOTHOPGLOQVGYWDSGCXJEHBZPRCFCKNQSTZVGBKNBJRNXDIQM9M9N9PBGHHTR9PPJVLVQYZVKIMPHLFPIVJIOHFFMOMSLMWDBQIPCMGVH99LAMPQUDKDKLNGZIB9CUWBZKYTCUWTIFAWBCSPJTIUOHRJMIATMERZYCHB9XZ9KGHWMTVDSBY9GRTZKKNZ9AZPSVFDCQPTOATCVZWRLTILOYIBMGOFXYHEOEMAETPOVCRADPVPIGQKDZQGUZFDRAQQFRCVCZFEJYXCKISPQ9WMM9YJCHGHYWYMZUPRDVYOWORNKQNUYZWYVSTIHCOHCYCFALVFKRLLZYMNEPSHLEJCUKURIOJYKXPHLFMMEIHFXMOISMWGDGSUIU9CLWDAAYRRYYGGLQVQPMAYNGJTTTNOPCXGYUEXFVXMNCZJFIVIBGCKRPXXTMLZEYGXCRQEGNFIDSSTKVNWDBZKZDFNUMTILLN9INWTQRDVSXJRSKGLHRIAGJRQZUHHEESFIJBLCDAAXVCN9UAOU9VJJCBWXELLMPEVOBQW9CJUABIKMBRSCIBVAMOXLFQX99KH9YLQ9BXLSIU9XOQFOAGCFIDJYAINNDAZ9TKROQJCZMLFGVGIWOSEARVCMFMBBHDBJHFCBGLODBELYYHLUEKJFCCYCUTILROVKWDPLWYEDDA9WEJQWOOAOKZNRXHYAQQNUDZFXXTOGSKGGE9OIGGPHKSNXPFVSKEGCLWCWWCASZEHEZBJTYNBAZQPYLANUKBSJJSJHPIXKUQERHBUZWGOXUDKWCQUAHNATYGUJEKDZGGGCNEALOU9D9RX9EDMWDLXFV99RFAGZENALKO9MIUXXY9HBGGCTHFWRPLWSIA9GWCLIXGOYFWYCAHVQDTCNBPUGAWPKEHLLTKAYCOAKIFKYROACDDKEIHVNBNCQDKAYYMUUONZOZYY9VPHWXXUSNZGRBGYGJNMBE9LTFSIHKFLAIZFJDTQUUDMBLKCNQZWXAVYWI9YIFDQBNSOPIZGKODKTBMKMMVPBA999999999999999999999999999PYOTA9UNIT9TESTS99999999999NYBKIVD99F99999999G99999999EIYHEUACZZAVPQFGIPKDUBFPJVOFTWHADBEXIXINYPAKPUMGZKEKVZQVQREIZHYPEBNZUAJQXHAGDYRG9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),

        # Input 2, Part 1 of 2
        TransactionTrytes(b'MXPN9ZGOHJHGLVDNBFJEGLQZAHNDWGJWBPQFFXAIIGHVJMTCBELOJPUHEJPRTJNOYJGGSVMDQFJD9NFDZNIDDO9MJRP99SWYJLHMWHUBREHZZMCHJPO9UUTKELRFFFBHTEFBUYRPVLY9TUFCJGVPGRCWSEAKAAKIOZEQJXNLBRCADVNWTUEDSJXKKTJWPXOMIVHYKRSYUSFVTDPMWKIGZFCK9QFRRAAUVKBFCUJLTARFWSXRYUXEWFG9RSHOZSXJRKOVTWPJWPNOKHDFYXSNHCWPKTSDVAIJPITDMSOEBGYRGVTNQ9EOPGMGFUBADQMNRPVD9PRXSBNJBMWJAATCJRLTBWRW9CIBVUFNJOAP9FRZPDWGTKRQXEKOO9ONRQSFRDUGDZAYZCEXUEMK9EXLW9WJSNJ9XFUQCRAIAUIBHZJQDGFLRIOXUOAHSWEPVXSIXACSREGCBMRFPLBMTXMMGCUV9VJCYJVKODIYLXFVKDNOZUNAHNMECVVQN9HFXBAXL9KEEJ9LAPCXWJMRFURUPEUXNLIFAHMEFHHNKMPMSHRZCWSGXZLDOGAKNXQEGFUXCLALLFGFPKHRVLBESXQFTHYEOHNGCQUJ9CXIVBVKEPDWJUXYBFXBJXMSJGDA9WZI9UJHBVGCLHWAFEKQTCRSLNESVJGKJWU9CXQATRIV9BKIWWFSCKHATHTQMLL9CPZENIXLWQTNXTWUYGYTRXOHWDONX9OSY9VRSHWAVATCHHRWCXQSRAU99C9GEAYZYU9DXYJRGQCUDXNTCRCTJLCLFVHUXLCXJOUKKOZCDIKCHXA9QDDWIHMPBVN9MSBAHHAECMHFJXVZMGOILGRAAT9CGXFYMDTULBWGPJIVOGTRDSSIGWRJLVETCSLLBJXWMUHUMPDPADYPRNMLQS9KDFDDPJPEQVYGDTMPYAWMFQCXRCMX9PGDYYASKZEGZWD99VANFLUVAAOSTVAWOPLUYZACKRKLCGOOICJTLCWUY9EMJKMJMXWESAY9CADHRJWOFHEOHHNOLSBYPVWSDHXSGYLBZRNNOF9HDEDCDTYUYPI9AMLIRKKVWBQJOQWHBARVWGEXXKINHTZESAPMMGOQDHUZBZEQNZLZRMEWMRFYKEFAFOCWG9KXFWRLJWIDFU9ULGCCWWZXRNBV9FHYFRSOQEHKUZJJQILP9YBMDXITFGNAODNXISIHHBJIVLBWK9PISPZOCGRRUYHVVURGUGMHOPFBZIPWQLKDWKJJEYAPXKALUFRBECMAYVMGZUIKZUUYVMLUEWCFDPSYHIVUQRWDRW9KFTRIGBKWMNEXJHWIU9XOSXUEPAGFRROQODWVGAVXCNLPZPEQGGSEKPRFVZYQFFUCUVO9VCTWSPUA9TVCUVCHCOJIPAMQEQITIVLTXJGDBWAGZHESX9RIAFKUOWPOVFF9JMGFLIWXSHMIDGLK9U9CWSMA9OHFXWQIDNHSGOHDC9YYOOTYRORF99YVJFSJPVWFXBWPDDS9UEUEECPSUFGJCSEPLX9IDUQDNHXVDCVFGOTRJBXHLIMHLRUOOW9WMCXSOTDQSPGSCCUDYIGNOXOKKBGBIRIOJWDLODKNABLRENIMQYPWDGILWGMHPZHXFKFDGOV9TZFCWXGNGRXMIXDTXZQGPSOVEJQPQUSJHEBBVNGEODWJEUDZMKLXYUWAWRPIRUMUHIV9IAAVTBVZXRTVHGMUAVFWCKGPVQ9SWZDTRATQPXYBXWVABEVKJOMILQ9JSYNRTHPMKZSRGEY9CBUBSGQPBUD9QJQURXQCOSEESMSWWKXE9WIVEWFANVUPJCQ9LINZUTJUCLMQXUOUOIAHLUQ9GNPVCOMUBYYQZAZNWDBPE9KA9UYZGFMPMWJRGMUXXYCJDEDUJJ9HFHMOZMDDMDPHIEUHAZNVXRVYRJAGBDTOWZUUDQGY9NKVJYJFAEAQTCIDKSZXSPWLPKDHRVFBTXH9OPUJHWYWPYHGGZYZYHYQUSYFNUUGRVZTJKRVBRVMGXZGUK9JLF9TTXZIYC9FAFOBQCVKNDLMEWUYCDJODOKSYUYGJTHOJPWHCOHWKOPICGMDDJKE9KNPFRARIKDC9JFAEVXDZXDHKQAEPCUZPCDAWUFNJO9LFHT9URMXORUP9MKIXJAEXKZYABWDZCVHOWJRVQPGHXARSOKUFDTZJHUT9VOSA9DU9ODXXUSNZGRBGYGJNMBE9LTFSIHKFLAIZFJDTQUUDMBLKCNQZWXAVYWI9YIFDQBNSOPIZGKODKTBMKMMVPBA999999999999999999999999999PYOTA9UNIT9TESTS99999999999NYBKIVD99E99999999G99999999EIYHEUACZZAVPQFGIPKDUBFPJVOFTWHADBEXIXINYPAKPUMGZKEKVZQVQREIZHYPEBNZUAJQXHAGDYRG9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),

        # Just to be tricky, one of the inputs has a different
        # security level.
        # Input 1, Part 3 of 3
        TransactionTrytes(b'BIRYQZTRMOJCLWP9PBRNLK9ZOYZDVVEKNUZKDGYIDGMCJJRTHVJSTIPVKR9NSMBPPYLANCDGT9FBESEKYXS9ECTQHYM9CCCFFURJSTYBNZZVTRYBHSNPPQZDWYLWCVWAELJOL9E9QCJDB9ZTIHHYDT9TCBTMAVBTFAVDWPLLDRDYR99QGMNPYCAZQRTE9DUIPAJJNGWQLTLFXFARNKSZKVHSFCAAGLIHRTGTLFDCUGZHWDQMEXAYEQDHJOQAYZMSYQORTAOFQFSWLPDYQVMGUEXQUIJDEFNZIUJXDEVPQSPZN9WPQJ9NRUXJEEKSCTNWAZLYZVDJBYJNDMDW9XKTYHNCACZRBXL9TKKBNTGPI9JCFRVCTS9XDEMDPBCIRGZRHPLKWOJFHSLBVOHTYZIAWXOYDAZQPWTZBZAOKLAVXRREYVYN9CQZMLCYBDC9OIJJVDTWFMQFCOVBRSZM9FDVSQWDTIRDYQ9BUPHSYCQXBTQJ9LJBZR9HITVLGFMBPBSIPETVXI9DOXUPHJOFGDDERHOPIXACBWJJMAJQ9WL9CLMBFJDYDMHKA9BMNHKHHAMLHJDOOOAXAOIAIPUJKOOSDTRDNS9HFPRWHYHVCSWYLZARWHNOKUJCRSYUFOQPQCRQL9SQCGRCPYNMVQIANZATRDI9OPSZVOOYOY9ATSXHSAYZHEETFR9ZVEQYLAKHEZVDQIUCJQNCJM9TCSLZOOZXAPXSZVONZAXMVDUOLNTZMUSFXJPOGIINYNRWXWLWDSXSPMJMCLFEFOPHJOABJQSWK9J9FXVKLDEXVPHRLJMVWBKLLMMNNESPJFQFQIESAPXFSRTDNOVFCXHQUCJQHMPWSYFNPFS9UWVLTAYDLCAYXW9LANEFFLGEEAEGQWXTXMJRBDRHFCTNSFXYBZOTYTFOOZDDZYFPFLSWJKYETBQHQWHFMAJAKOOBJFYCZFAHDDULFLJHVIDUXOPWHKHLBCZRLH9IRRMTFOVOCENLEWXURVIFHQAEPMLSBCWGXZRDVUTMALSVGAFV9JSLPJWBQWFTJKMABUZKABQRWWMJCPNBKODNMLKWHAXIILBVNJHWFVJJIEFGSFRWGNTJOGFYQJX9KHZUUXRIOMDISBMSNADEWMOSAZWKLRWWRXZIMQSKBUPXHOWCVQYMUBIXOYCQZSYNKMHKPWDJLPIWLOOIICCFJGPAVVVGALNUHIFLHSIF9JYXDQGQQCZGXBXYPUWHTFCMSQPBOCWGRWIRSPQTGEVAPTIJ9GJXOJ99ROFM9CCASDVJBZWAKVYYIYBIAYODUG9KURZTCKRXBBDDUNYMTBMEKXQV9SREAGINGSHKMMMFOSWQSISMVRPRIGRZGQKE9EGIKTHVGYHTIZNYDBHYLJFIDIRGKWBSSNOWHLLALTMJIIQYJMVIUILDHDZAXMTMBYCCFBIWYVMGVRITMCDNXMYVMNCFWJ9KLYHCUQCJLKSHCCXNXLUFSEUFGXUYZTD9YFAC9ATT9EQSQXDESCEUZCT9PNPZHQROJAXBJPG9FAFKCZTKHK9W9SWGKVSGKWGLVTXOCKP9UAWIWLCWQPYTKTXFZQWWEWPEQEBTPOIWSFUNDKLVRSXQ9GPHYOPU9YOC9LIAGKNSNOPZLKQEBNZFSZDSSWURARUTZWPPBHMNUXFATQFWFLOIRZAFZNAPNBMVNFBXZZSOZIWZHFHPRVF9YAKYGFHC9CLUEZIIRWKFQGXTAPLRCMIWWQCIFUXMLVTOFDGLTONFCZMK9HMGCZTIEJTOPENSXISJKFHSZDZLVNGVOGHKUVYKAYMCBMIRAP9GXIVTHWTFFMBOBAELAQIKIVZZTOSWXCBPJAPCDTPSGCDYYB9EZQUSU9DUJUZX9AQWWFRJUYJYWDTNLBLPRVXVEPO9MMWKHIGBLFHXVDNPCOSFXBAIOYGQLZH9YSYBAEXBHBLKIQABEOZIJVLXKZABPPLABAYVLYWIEDJFIMSJBZICOWRXQWIYYPKLLPROGXNGTNTPPQREKS9I9WERWBALENFPWQBIKWUVGNHMXKQ9TYERABQJWUAACHGGQEMWOBBGOIZCAJYRRBZZQUYIRYCXOORUBXWOEIYEGVUKJOJRPWRERTDGCUPZLZINJIWDAW9SVF9KCUJRRFE9OYKRAWS9HH9XHCPQZAISRWZJVVRVKGYMKVFZVKNQSDYHSQ9XXUSNZGRBGYGJNMBE9LTFSIHKFLAIZFJDTQUUDMBLKCNQZWXAVYWI9YIFDQBNSOPIZGKODKTBMKMMVPBAOV9999999999999999999999999PYOTA9UNIT9TESTS99999999999NYBKIVD99D99999999G99999999EIYHEUACZZAVPQFGIPKDUBFPJVOFTWHADBEXIXINYPAKPUMGZKEKVZQVQREIZHYPEBNZUAJQXHAGDYRG9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),

        # Input 1, Part 2 of 3
        TransactionTrytes(b'YHESE9Q9LPYU9MAEMPDUDUWOTUVFGDPBBLLZTTTFCWULPFHMRZWGAUAU9YOQDFRLLBG9SJOYDLVIQPKTBAMIZWOQKVUGZTHZMFMWWBTWXLIOSOGOVLKWJMZMIBFVNOTNTRQIMCTJSYLFNARMYKFMGXMMVASRHHNP9ZZDHHUEHBPBQJJPMQBM9PIZIWQAJLAPURCQFKXIVGYZRAPATUAY9CGRJBDYHOIGPWQBPREDHSFIFILBDOBRQV9OUSARYIVHZIHJPJKUQCJDI9XBNIBHENHLBIPRUXPUXOLHEUNZVUS9CDKEHKGQXPDDQL99LHNXK9ZCVDPWJERFHTLTUVZWXZWTAZCLUAOZQHNXRFLKDSFRIJ9DKJJSLBXYKJLTW9GUIAERJWTZXZXOGJXKIDQKCQUOLHUSANAFQIKOXGMXAXJJPDTIHKMXQQ9PBNTXUEHUPLAHRVXBZJJIEUDSZTSDS9RSUPZ9ILZRFJRTG9PUIKNGWFKFUQTMUTPW9YKEID9YUUOZWIJIJYUR9VBSHPYDUMUIYWMAFOQBEKTYMYDJC9MLQTBAURFVRTYZRQOWVIXBFITAXRKNIPCYKOBMPYIABHKOOOCCDZFXLTHOMNDCYZQXHWLMSWNVANKG9RRGLGZWSUVGDIOWV9KUOUHB9YWFIHAWRHSTDABPA9PQOJD9KJPKHUOPKSFCXJMNDSKJHTNPAQMI9UMUVBQRIFBSHRLDMCLE99QASIM9CDV9GJBPH9PHDMUMIFXKKQBLLSMCBRMCJPR9NYJLEAZBYKPRZDTRBBZREVHIBFYRER9YGGCLZWLLZSUWQKPRUULNBLJTOVJAPSZGISRRQMDAMUBEQWCKGYQDMEVTYKMAGCSMTMTSEFDOBRUPQF9TVGYQDTDSAMEULRKZOUJQXQVXPMQYGNZNKIDYRQYCCHPJFQQ9PIRRTAJCSCRXKKRDQXEEIAVWDHAVOWSVMPFZXHQ9CUKLAMFXYVDCXZBWCRWHTZZWKNCD9GCRGQCNLKHWEAHRSYVV99J99OQGEFXMEZDDHJWXJGDIRJYIMLGPWTBSBVKTTJ9HA9OLTDGPZSURRIZGONXZAOYHQRDMZGMKVSGENUGNRFXHRKRNYIQYRZH9BRBJBDPCHCEZCAGXGPYVDXMBHJ9RZQJGGW99SONTRWTFVCBPDQ9YSWCRPHXAOZQXNOUYQXLKWDZMMXPWRRZRERTXZXJXQHCSWPEFTIELOBFPLAWMEVHBFPQRPDYTSUCWHSZCYJBBOQITFOVGSFZYCDTYMWRARODBCISJOCYVKJKJPOPDQSILNYAPWEI9DCNXSSXHGQWGNPSVOHUGZACFDFTIRGYJGCVPYTNPN9CTZOCLRAOZDFQZIAIYJOXROUBHATCFJYSZGEHGVLKBISDGZEARWQILPMJMFG9PCOMSEHECWYMDLKQASOMIGRMIIOYGESRHYQUXIIZOCXKJHWZ9QRSWYVHBVFVOCHGWCKMGKLAKTUSCDYZSWOJUXNSULWFJVROKGKKBZQOHRY9KXPKAGKBRHLAQNMANBYDYHWZRNCDSP9OGEDENQHAFPIB9OLYVMKKLZRUDTMNTRNOVNHTHZUVHPKJVUISFMZZ9HFNZMLCDGEUJYOBCLLOOIQOMQAEETCRHAGVMMVEDWLDNAUPACSHKDTCFBJZ9TCFB9ISIZAJQZGQMGMJWESFNDHZAFOZKRHQUXRNRDQPBEJTZJTRHIFQOCQSC9IZHHGTGPEBYFTLESFBHGRGJIXFZKJGYYPNB9UTMDUIUMUNDJNCOMRCOBXT9NPJUERWDAFBGVWSQBVMSRIZETWLQBHXQIOZ9KFWJLWZRMEUUFIYTQQWRPEROGRXBTNFPHMLXYZZEYDDX9JNZPDJTBTKLGZIXKYGXHDTRGKNUZFEYKWYTBBOGHCVKDMBHZWRBSCLLNBJWPBV9XBKO9ZRMCRFCEXRDMZWBQYAMHG9TGPDNAGPXE9YPUQUNDKXKNCWEQATNRN9WSZMVOXLWPYUDHUXJJQ9MGWDOH9OUIDMLJLLYYXUNMPPACYVHUWJUKSDJPZBTZALVQROBJAKOFUNQFYXFCEYDIDOAZKASIKY9TWQYMKIQHZQXZGHRBR9YOYXUAQDZZFPFKFLGPYTMLMSGWAVDGLJTTIPZAMFLGXIXHNRC9ASLHSYQGDRPSFWVXOCFFHTUEMDMDPUSXAZTWCQBKCWBZ9LDZSJJPDPCAVRBEBHKZTPWCBGZTVXP9DEUESJEADACA9TBNKWFNSQLLPUJQFVYLBAAYWND999999999999999999999999999PYOTA9UNIT9TESTS99999999999NYBKIVD99C99999999G99999999EIYHEUACZZAVPQFGIPKDUBFPJVOFTWHADBEXIXINYPAKPUMGZKEKVZQVQREIZHYPEBNZUAJQXHAGDYRG9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),

        # Input 1, Part 1 of 3
        TransactionTrytes(b'DEZJVMNPVBAEBZWMGIXVSBOFZWNJOSUTEALWDOIDOGXQLXKHKLAQTABJDD9HJWPTCZTAGOCMEIPFFZNCCNRNDZXVEMNVFPMONFWRKMEKLYSBXFOKOHCAHXF9MGID9BNXWENVFFZRPFXXL9RNKRXNECZBKTWIRRIDKWMLNMIPJTLSFNWILGBVZTQHFHVSEMPSWUMGAP9AKILPBWFYKWEYOFYOINADMVCYPWAOPUXA9TEVPKHT9PBYZXOF9LKUBBIRSOFVKDIZYHGOEUCDDQ9IWRYDEANKBVEDCABLVSKFDOXGSEZSTMVAXMVCPYQR9CILVQIWPOWVUPWJOTRFGJGBIPNY9OUBYYWBWSXVKYDC9HCTGATTCCUSAGQYHWQMRRWBFHSCPCSHEIAZHWUMIOEZCR9FIWXJSHSZG9TAOGRWPRTCWNSABXXOO9YQPUCCHK9CWAYOFKGXTKGWVENRKIMTNFSLGGPNWAOLIFOLYWXUQTFBFDTFVDLTXZFPLWCYIBHPPPIHFNLZJXYUBRIUQKVIYAKQZNOVOZVICEUWJFJTUVCAYHUWLQAQ9ACPUQBSJUII9HWFVIMVUNGFFTPRHILXOLWOXGOXAVOROQPVTEUDLMZKAOWYP9YWKJBDKCZHLHVSGJKVCIFWBIRXAOVVICUOJSJFLUSGAGUBDNTWCQNXWMCJEKZTWFIHGTRZTWAJUQ9UENNNBAEBEVYJFJRKMEPROHEYXMFBABSTBHYT9AICXZUEYSOHKUHEV9YMELFEYYXMYKLSJWBD9MGCSNBKIZEU9BZVPOHLTYLKTHMLRXKGIAZJKNLAURMJUYZMZPZZ9BCDCU9RRBVATIYGLVQMWDEFLWRNLH9J9GJHMZSFYJUEUKZXKLRCLMMAAIMJNACQDIJ9SKJSQYIKDPMRSZYMIPHUMZARFTCADD9UWH9TPPZVRLUWHOFVKNXVHRYSCCW9ZDHUIQRZLHDBRFMWWYUWTLEPULCZZPNYEBEGSPRRSEJPKTTLJDFH9QJTAJYSU9HYGJRA9IYJSAQMEBPWZYNPPPJPDEJGUCKB99IQZXLZV999CQBWYDUEXQB9IXM9OTMALUTBQUYZRVRVSURESZWKKPGHYSHAGVDCYQIIBXINSSAYSMUIYDZDDA9UKSLLWJAPYIZQNPLSWARDHRQHEPBOEUKORSJYJTXNDJGXDOGMGO9QMBHAJVTDIOZNLLXWSIJBWM9ECTUCJGKNWRQCVE9RYYWB9EBEKHDCKHAPEUYCTI9DLZHOHBPKILQDMBVKHAQPOGXCWBOZNNMPWXQJHAGYP9WUSJHDDCQSVBCJYL9GZYSCNVWIUMKPVQSEFBARSKLXQTSDSZJUEWRDFTYVIWGPNFBQW9VKSWKDLRJWWXMWOPENESZE9MDJYTHYAXPZADFOWWYMPE9Z9XZXDUGEOIKCGKYY9LLOPYEPYY9JVYALYCCCEGEQDBBINWYGOQBOHXQUGZNJBOQJYCEKLODXFFOON9IGAJ9NJYUWSCMUNDEGHTXHPUVSIKDNUFGTFMNLRNNQSRVZNFWBUUPTUXMTLRKTNTJIMOBSLXWMZLIGIRGCYWLHCQUDJWIKUOMPSNQYFP9UTBFRSSACVQHBWMBNCWIJJOB9SMMKVCDFLRUA9CPSZYQPWNASZXKNWDXITTKUTMFUTVMXKMLKCGTDBYQMKP9JCADDQEJCAPWLOXWKUKSQW9BDQDKLVN9YIOSGCGSMVXB9LU99AZ9HJCWONAQPRUZIAMVUURVCPJWROPNFSSFCOAU9CYAHAJRIQLBUKDEBMFPXPWGLRFPOMANCGIPXXPYYVOSEWRVYCYBORLPVGDXWEDFSFW9QANJ9PFPYOHNJMYNAUKTLYCEUJMWYPIUTCWKNKYWSOVLXRSENJLNTIGDROCFMEGAHXBLZPHTMVRDYDHPHYFUN9JZRTPBJFKFWSZDDIIJDJBXWZ9LNUOQAZQYXJNHBHHHDLEVVVOJEVH9MJPK9PROZLDIXSCPZLAWOWODBKLCUNQZCGY9MZKRIRVIYCIEIZPS9ZGZL9ZBEWSFEJUJPDL9QYNHBXCMPYRKQAVUSFSZTKURHWEAXCBORHUWOVKFRPSEIIPYUQYVGOAVZECOHFDCXSAXUKJUDMKOWPEEEWJMEMYORJSDHCYRCCKYZHQETCJ9KESALQXASIUDX9VJOUHGTIDFVTVOR9HDTWCQBKCWBZ9LDZSJJPDPCAVRBEBHKZTPWCBGZTVXP9DEUESJEADACA9TBNKWFNSQLLPUJQFVYLBAAYWNDPZ9999999999999999999999999PYOTA9UNIT9TESTS99999999999NYBKIVD99B99999999G99999999EIYHEUACZZAVPQFGIPKDUBFPJVOFTWHADBEXIXINYPAKPUMGZKEKVZQVQREIZHYPEBNZUAJQXHAGDYRG9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),

        # Just to be tricky, we will include a spend transaction with a
        # message that's too big to fit in a single fragment.
        # Spend Transaction, Part 2 of 2
        TransactionTrytes(b'DEAUCXCSCVCTCHDTCSCSAEACCWCTCEAHDTCBDGDXCCDBDEAKDPCGDEAIDBDQCTCPCFDPCQC9DTCSAJ9GAHCCDIDLAFDTCEAFDTCPC9D9DMDEABDCDHDEAVCCDXCBDVCEAHDCDEA9DXCZCTCEAXCHDQAGAEACDQCGDTCFDJDTCSCEANBTCTCDDEACCWCCDIDVCWCHDSAJ9GACCTC9D9DEAIDGDFAGAJ9GAKB9D9DEAFDXCVCWCHDQAGAEAGDPCXCSCEANBTCTCDDEACCWCCDIDVCWCHDSAEAGACCWCTCEAKBBDGDKDTCFDEAHDCDEAHDWCTCEAQBFDTCPCHDEA9CIDTCGDHDXCCDBDSASASAGAJ9GAHCTCGDIBGAJ9GAYBUCEAVBXCUCTCQAEAHDWCTCEADCBDXCJDTCFDGDTCEAPCBDSCEAOBJDTCFDMDHDWCXCBDVCSASASAGAEAGDPCXCSCEANBTCTCDDEACCWCCDIDVCWCHDSAJ9GAHCTCGDIBIBGAJ9GASBGDSASASAGAJ9GAHCTCGDIBFAGAJ9GAPBCDFDHDMDRAHDKDCDQAGAEAGDPCXCSCEANBTCTCDDEACCWCCDIDVCWCHDQAEAKDXCHDWCEAXCBDUCXCBDXCHDTCEAADPCYCTCGDHDMDEAPCBDSCEARCPC9DADSAJ9EAEAEAEAEAEAEAEA99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999TESTVALUE9DONTUSEINPRODUCTION99999ZDDJMOGAXHRGS9XCNSKQQNVB9BSYFCVANLJM9CLRLJSQKFO999999999999999999999999999PYOTA9UNIT9TESTS99999999999NYBKIVD99A99999999G99999999EIYHEUACZZAVPQFGIPKDUBFPJVOFTWHADBEXIXINYPAKPUMGZKEKVZQVQREIZHYPEBNZUAJQXHAGDYRG9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),

        # Spend Transaction, Part 1 of 2
        TransactionTrytes(b'J9GAQBCDCDSCEAADCDFDBDXCBDVCQAGAEAGDPCXCSCEANBTCTCDDEACCWCCDIDVCWCHDEAPCHDEA9DPCGDHDSAJ9GAOBFDSASASAEAQBCDCDSCEAADCDFDBDXCBDVCQAEAYBEANBTCTCDDEACCWCCDIDVCWCHDQAGAEAGDPCXCSCEAVBCDCDBDEDIDPCKD9DEABDTCFDJDCDIDGD9DMDSAJ9EAEAGANBCDEAMDCDIDEAWCPCJDTCSASASAEATCFDQAEAHDWCPCHDEAXCGDSASASAGAJ9GASASASAEAPCBDEAPCBDGDKDTCFDEAUCCDFDEAMDCDIDIBGAEAXCBDHDTCFDFDIDDDHDTCSCEANBTCTCDDEACCWCCDIDVCWCHDEAADPCYCTCGDHDXCRCPC9D9DMDSAEAGAHCTCGDSAEASBEAWCPCJDTCSAGAJ9CCWCTCEAHDKDCDEAADTCBDEAGDWCXCJDTCFDTCSCEAKDXCHDWCEATCLDDDTCRCHDPCBDRCMDSAEACCWCTCXCFDEAKDPCXCHDXCBDVCEAWCPCSCEABDCDHDEAQCTCTCBDEAXCBDEAJDPCXCBDSAJ9GACCWCTCFDTCEAFDTCPC9D9DMDEAXCGDEACDBDTCIBGAEAQCFDTCPCHDWCTCSCEAZBWCCDIDRCWCVCSAJ9GACCWCTCFDTCEAFDTCPC9D9DMDEAXCGDEACDBDTCQAGAEARCCDBDUCXCFDADTCSCEANBTCTCDDEACCWCCDIDVCWCHDSAJ9GACCCDEAOBJDTCFDMDHDWCXCBDVCIBEACCCDEAHDWCTCEAVCFDTCPCHDEA9CIDTCGDHDXCCDBDEACDUCEAVBXCUCTCQAEAHDWCTCEADCBDXCJDTCFDGDTCEAPCBDSCEAOBJDTCFDMDHDWCXCBDVCIBGAJ9GAHCTCGDSAGAJ9LBCDHDWCEACDUCEAHDWCTCEAADTCBDEAWCPCSCEAQCTCTCBDEAHDFDPCXCBDTCSCEAUCCDFDEAHDWCXCGDEAADCDADTCBDHDEBEAHDWCTCXCFDEA9DXCJDTCGDEAWCPCSCEAQCTCTCBDEAPCJ9EAEADDFDTCDDPCFDPCHDXCCDBDEAUCCDFDEAXCHDEBEAHDWCTCMDEAWCPCSCEAQCTCTCBDEAGDTC9DTCRCHDTCSCEAPCHDEAQCXCFDHDWCEAPCGDEAHDWCCDGDTCEAKDWCCDEAKDCDID9DSCJ9EAEAKDXCHDBDTCGDGDEAHDWCTCEAPCBDGDKDTCFDEBEAQCIDHDEATCJDTCBDEAGDCDEAHDWCTCMDEAUCCDIDBDSCEAHDWCTCADGDTC9DJDTCGDEAVCPCGDDDXCBDVCEAPCBDSCEAGDEDIDXCFDADXCBDVCJ9EAEA9DXCZCTCEATCLDRCXCHDTCSCEARCWCXC9DSCFDTCBDSAJ9GAKBBDSCEAMDCDIDLAFDTCEAFDTCPCSCMDEAHDCDEAVCXCJDTCEAXCHDEAHDCDEAIDGDIBGAEAIDFDVCTCSCEAVBCDCDBDEDIDPCKD9DSAJ9GASBEAPCADSAGAJ9GAXBCDKDIBGAJ9GAXBCDKDQAGAEAGDPCXCSCEANBTCTCDDEACCWCCDIDVCWCHDSAJ9CCWCTCMDEAQCCDHDWCEA9DXCRCZCTCSCEAHDWCTCXCFDEASCFDMDEA9DXCDDGDSAJ9GACCWCCDIDVCWCEASBEASCCDBDLAHDEAHDWCXCBDZCQAGAEAPCSCSCTCSCEANBTCTCDDEACCWCCDIDVCWCHDQAEAGAHDWCPCHDEAMDCDIDLAFDTCEAVCCDXCBDVCEAHDCDEA9DXCZCTCEAXCHDSAGAJ9GANBCDTCGDBDLAHDEAADPCHDHDTCFDQAGAEAGDPCXCSCEAZBWCCDIDRCWCVCSAEAGAFCTCEAADIDGDHDEAZCBDCDKDEAXCHDFAEAXBCDKDFAGAJ9GAXBCDKDIBGAEATCBDEDIDXCFDTCSCEANBTCTCDDEACCWCCDIDVCWCHDSAJ9GAHCTCGDFAEAXBCDKDFAGAJ9GAKB9D9DEAFDXCVCWCHDQAGAEAGDPCXCSCEAHDWCTCEARCCDADDDIDHDTCFDEAPCBDSCEAGDTCHDHD9DTCSCEAXCBDHDCDEAGDXC9DTCBDRCTCEAPCVCPCXCBDSAJ9EAEACCWCTCEAHDKDCDEAADTCBTESTVALUE9DONTUSEINPRODUCTION99999ZDDJMOGAXHRGS9XCNSKQQNVB9BSYFCVANLJM9CLRLJSQKFOOB9999999999999999999999999PYOTA9UNIT9TESTS99999999999NYBKIVD99999999999G99999999EIYHEUACZZAVPQFGIPKDUBFPJVOFTWHADBEXIXINYPAKPUMGZKEKVZQVQREIZHYPEBNZUAJQXHAGDYRG9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
      ])

  def test_pass_happy_path(self):
    """
    Bundle passes validation.
    """
    validator = BundleValidator(self.bundle)

    self.assertListEqual(validator.errors, [])
    self.assertTrue(validator.is_valid())

  def test_pass_empty(self):
    """
    Bundle has no transactions.
    """
    validator = BundleValidator(Bundle())

    self.assertListEqual(validator.errors, [])
    self.assertTrue(validator.is_valid())

  def test_fail_balance_positive(self):
    """
    The bundle balance is > 0.
    """
    self.bundle.transactions[0].value += 1

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Bundle has invalid balance (expected 0, actual 1).',
      ],
    )

  def test_fail_balance_negative(self):
    """
    The bundle balance is < 0.
    """
    self.bundle.transactions[3].value -= 1

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Bundle has invalid balance (expected 0, actual -1).',
      ],
    )

  def test_fail_bundle_hash_invalid(self):
    """
    One of the transactions has an invalid ``bundle_hash`` value.
    """
    # noinspection SpellCheckingInspection
    self.bundle.transactions[3].bundle_hash =\
      BundleHash(
        b'NFDPEEZCWVYLKZGSLCQNOFUSENIXRHWWTZFBXMPS'
        b'QHEDFWZULBZFEOMNLRNIDQKDNNIELAOXOVMYEI9PG'
      )

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Transaction 3 has invalid bundle hash.',
      ],
    )

  def test_fail_current_index_invalid(self):
    """
    One of the transactions has an invalid ``current_index`` value.
    """
    self.bundle.transactions[3].current_index = 4

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Transaction 3 has invalid current index value '
        '(expected 3, actual 4).',
      ],
    )

  def test_fail_last_index_invalid(self):
    """
    One of the transactions has an invalid ``last_index`` value.
    """
    self.bundle.transactions[0].last_index = 2

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Transaction 0 has invalid last index value '
        '(expected 7, actual 2).'
      ],
    )

  def test_fail_missing_signature_fragment_underflow(self):
    """
    The last transaction in the bundle is an input, and its final
    signature fragment is missing.
    """
    # Adjust bundle balance, since we will also remove the change
    # transaction.
    self.bundle[0].value += self.bundle[-1].value

    # Remove the last input's second signature fragment, and the change
    # transaction.
    del self.bundle.transactions[-2:]
    for txn in self.bundle:
      txn.last_index -= 2

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Transaction 4 has invalid signature (using 2 fragments).',
      ],
    )

  def test_fail_signature_fragment_address_wrong(self):
    """
    One of the signature fragments for an input is associated with the
    wrong address.
    """
    # noinspection SpellCheckingInspection
    self.bundle[5].address =\
      Address(
        b'QHEDFWZULBZFEOMNLRNIDQKDNNIELAOXOVMYEI9P'
        b'GNFDPEEZCWVYLKZGSLCQNOFUSENIXRHWWTZFBXMPS'
      )

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        # The bundle validator uses the address to link inputs
        # together, so if it encounters a different address, then it
        # assumes it has found a new input.
        'Transaction 4 has invalid signature (using 1 fragments).',
      ],
    )

  def test_fail_signature_fragment_value_wrong(self):
    """
    One of the second (or subsequent) fragments for an input has a
    nonzero balance.
    """
    # Don't forget to adjust the change transaction, in order to ensure
    # the bundle has a zero balance.
    self.bundle[5].value = -1
    self.bundle[-1].value += 1

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Transaction 5 has invalid value (expected 0, actual -1).',
      ],
    )

  def test_fail_signature_invalid(self):
    """
    One of the input signatures fails validation.
    """
    self.bundle[5].signature_message_fragment[:-1] = b'9'

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        # Transaction 5's fragment is invalid, but the validator has no
        # way to determine this, so it just assumes the entire input is
        # invalid (the first transaction for this input is at index 4).
        'Transaction 4 has invalid signature (using 3 fragments).',
      ],
    )

  def test_fail_multiple_errors(self):
    """
    The bundle has multiple problems.
    """
    del self.bundle.transactions[4]

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.maxDiff = None

    self.assertListEqual(
      validator.errors,

      # Note that there is no error about the missing signature
      # fragment for the first input.  The bundle fails some basic
      # consistency checks, so it doesn't even bother to validate
      # signatures.
      [
        'Transaction 0 has invalid last index value '
        '(expected 6, actual 7).',

        'Transaction 1 has invalid last index value '
        '(expected 6, actual 7).',

        'Transaction 2 has invalid last index value '
        '(expected 6, actual 7).',

        'Transaction 3 has invalid last index value '
        '(expected 6, actual 7).',

        'Transaction 4 has invalid current index value '
        '(expected 4, actual 5).',

        'Transaction 4 has invalid last index value '
        '(expected 6, actual 7).',

        'Transaction 5 has invalid current index value '
        '(expected 5, actual 6).',

        'Transaction 5 has invalid last index value '
        '(expected 6, actual 7).',

        'Transaction 6 has invalid current index value '
        '(expected 6, actual 7).',

        'Transaction 6 has invalid last index value '
        '(expected 6, actual 7).',

        'Bundle has invalid balance '
        '(expected 0, actual 147).',
      ],
    )


class BundleValidatorMultisigTestCase(TestCase):
  """
  Tests how :py:class:`BundleValidator` handles a bundle with a
  multisig input.

  Generating validation data using the JS lib:
  See :py:class:`BundleValidatorTestCase` (code is exactly the same;
  there's just more input transactions in the bundle).
  """
  def setUp(self):
    super(BundleValidatorMultisigTestCase, self).setUp()

    # This is the result from ``examples/multisig.py``.
    # noinspection SpellCheckingInspection
    self.bundle = Bundle.from_tryte_strings([
      # Spend transaction.
      TransactionTrytes(b'GVJ9TQAQFKGGO9TIXJYNXOIRMXOKUFIEKDDUXMUHHLIWWMQIOFROPAWTODKLLWPFJZQQIENGGPFEUFXXYRBFMZBWENUBKAFFNQVZRQK9ZQVUDXWSERJDZMYFGJ9MLDPTW9DMB9GEWFEPFSZAKMPBLKOOVBLVFLLCVQXAPCVXQBJXDXOAEFSQILAHQJZLNOAKJGSBKDDUIXRD9ZB99NRELUIWLMDGIXTLSBJCFNJCV9SN9LXWTHHEILYKLVIVSKBLUP9JVGEFUKZHIYUBZXRBYOZDSDBAAADJLOTCTPZEUGWQXOKXFWTCQHAMHS9ZRWPIYOYHRJT9BNDTR9KBYYUIQVALOHKQXHWTCTLQOBSWCL9GENFLYKDJHNHBYHNTYIPGXGZJZPQPPOZXUHRGYVSSFNTFRSFVDDBHPOOKVEQMQIHEWKDR9OVZNDPZIVLXSUHTVAAZGVORGD9HFKVLXWFUWLXZIKQBTVXTZZKDQUQGGVFEIQOKFHB9QHESESVUTPCMWJOT9WFVFDFLNSUTOVZEOMMRTTCZHZMDCQVJ9NJQDJFDGJMTMRXVJSYSKSEGD9ELOYGUCATBNSKMFQZXROHGWABBUOPVQSSEMYQCDTOROSSUJKIKARW99UCARWQOOKXRLJFREG9YGFSFIGYLRUMURYIIKRTZSDPQPFHWSG9HMBNAMDIBNQDVPIAR9QOSYKWQOYJFCDUEQND9RBUKBGDKWUEZAVMIFEDEZKDCA9WHNDJAQXBAOIREZWOUJCZMKNXONEMW9QSBQLNFMQHAXMNKWKBORCQBVGZJSAIVXELWEYXNT9GCNPHUTRVINSNNMSMKXPSKTSQAB99HHKZXSP9N9SKDCQAJBBIFAUFKDUHZSGHZSKARULBTNUZAGHIUENEEMFVLXAKHMYYBDOAAWQPCDAWMXGRGPKQBSFOJPJDQHDPWS9ROMJCBVRZZI9SCKAIN9UCLRMQRHVHIV9PXUEAEMRMBUSJYCMHODFFZOVTG9VAOC9NCBMYW9WJOOMAOVLOKUKDWALN9Y9MELUHZGMMGKFWXLYKSMQXIFJJQNNNVSJTWEVRRFATYMXSCKVQSIVGZERHJCRLFMKHUVKDPDYFVZZDWWK9BHVYP9KRGZTIWPL9TDL9MZSHOCKC9BCZEIKIHDFJSQXILPRPVZT9CIRPUQX9NWQRVFTKMEBSRBULFUYK9UJBRZJMQCDLJNYLLTYXYIGFUI9NXDVXBXGUBU9Y9HMSHMGURNRWCPVOKFRRFPKDYPDYK9PTTBIHMBVXQVQHMVELHEKUNPQQPTMRLIPZIBFIML9JMZUQXG9CHEJMN99UUYGVTX9QRIGNGMIYIHY9VHLWJOLQPCA9NPRVPGUXPWCWUAANXIZVUWKEUZVRUTKFBQLIQDAWBVRICRD9BZCKLIISKOOZJZTZRWWKZD99HTKXGGJNLVMJ9TLZSBQNGXIEABJOQFRKHXDPVSFISQLAWAEDYHLNY9RNALGRTETYGURUSRSZHSJUNYYMASRNHYLBETEZKFUIQMYIBHNJZKIFUFPDKTHRCGUDWTBZSWEEQVFREIFHT9MUHMXOTNFZZAJGYSXHCOXHHBAPCDTJHNMXZGFLPRAUSDOBHUO9WFODRQFSHMLKZKXJGEHKOQDKPAO9UELDUINXI9TBOZTTZ9ALJ9DBBPCBRZUKGUCVMXJLKKQFDJFPFVLMBHYJMHRUHRQTCK9HPQJINWEE9PMWLHN9ZWRLNJEUAWDIZUEGEGVBGVVJBJKZDKJIWKGVMJRSXFZVWKFOOLH9BIAXPPCIPVWXWEOSQMUGISPGEHVMDZBCCKLC9XVJXIZPNWKZGECLUNDUNZMNJVBQGKNVRYBO9MBPFDRFFPFMIMSLGZQWORXGN9XUUWBQRLRTAQOVGVNZXTFUXDEILZHCLJILYDKOE9YBVXDNXBPDIDHGHXBCFSZZMRIKWISUFPGRKGH9I9MBRXW9XUIQKDKEBOSHNGVEOWJTBACUHHOQDWYPDPWZEDIFNZRBQJVEJHYPWOLNAHQJRHRBZGMPHHBORZNGTZQFP9GTPBCBLPPQVFMKRMJLQFLTAJDOMFQHXZGVZFUQBFNJAOPFYRHAFQPHWMPRPXQDHKSAMZUNAYEYOE9Q9XGXMJFFNWPGYLSOPXOXAKEEUKF9ACKF9UAGURDWPXUZYYVFPFWO9ZDICIKOQFIKWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALI999999999999999999999999999KITTEHS99999999999999999999HXUBQXD99H99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),

      # Input (requires 8 fragments to store the entire signature).
      TransactionTrytes(b'TDKJI9LEFSAMBEVUEOMJUJRVXDIWAPZJZVTWAPLZFCJBKEWKEMI9RYBIABRELCYU9TJAZKBPCOZYHZTCXEXJXXGZFSAZBNNGGJAFPLSZHG9PEFMRXSDHRGAWNIJVSPWFGENTPGWQUWCXAGXGWJXSDMJXXC9XAPFOTEQVJHRGQEZSIHKKQDJZW9NRMGKJHNUQMKNCEFAIRXURNEWLEVXIHURXMBQGYFYXZGXBIHESRFUMU9S9LKKJYULLGWQUIGY9UMWDVJEZVCLEQRIFMKOXZIOLOUGYTJDYYHWAGWCJWKNNZ9VENFMEBEFPOLTQICOUWHNYVINR9DSOGQCH9QPIUZIIZILN9JQEBERPYZBJUFKMQEESGACPFVZOQZCFKZARGDUI9EBDBIEVPMEU9RQD9BYJGAIFLSHMMZ99XHRBCELITCWHEHVENOOFNTAZNFZTFVTDQOUCM9XLUOKGTGRJKIIIBZVXPRDEYJCWRXOOOMBSXMKWCEOXSGOOBQWRAMNPGKJQPPIVI9URFNMBHMOAJUFOLFNIJWEHUQJEFEGYLEQGCG9TEZCLLVUNSKZWCLEHKJEBJJQKYFEQ9IPQDICBEJGKAUGS9GDMOGPEXZEKUJON9TAWFVOGVAEDTXTCVHZWELOZTCXQGRXIIXQEFWPZBFTCCAB9PSOGIFQJGNLZTFGIVZUPJVQXB9JLAYBW9ILHBHENWVBFLMZLDPKJWBFLRBYOJOPGOXCPKUYAZQWACANHSISVMEKBBZOJXRMVHPFCJGMWTYJSYVBXERTVGZGTVGFZNYG9KZIJEUORNCTPNDRLEBXMRFUYUMYUZCOJSMRGGYXA9VUNQ9NTBAUNWTXKWNSYVZJBD9CFGKOYAALBKSIKOSKYRJECUITWEBKFPQUKEBAVSCGTSACQWLRWEFPPFGAWYDOPXMTDPIDJG9QRCGHZRYBDDCGPWKTNHGXKDRRQR9OK99MRKZJJFRKVILXQUTVVRWVJVCLORPHXTEHTPUFEXVBVIGUWVXWOCOOZOREBCKPGYZTVPKHEDLCVIQCHOGEMTMB9MKHOFXZCDYSLVPDAXTNYWTKPGTOK9ODLGOFFG9BK9XZDGDC9EPWBQX9SPNNFABHNVCRQFPLHGUHUJBIKYNEOHULQUMVUONIKGNQFSNAEWE9WBWUMPVVIFDT9JPJTICVANOBHGXARARPMMDXUNGWJNFXDBABZNVAS9NRGPLZHHQURABVVZSMQUOAXHCPMEJYNZVWEASLCBSFMDOOMXNKFUZOO9BKOJFRBWYELDVDXCSBIIC9LMLTLQFXSAGTSXORPBZNJMNEG9UIWGN9TDSJTMFQZNVBSWNWQLPIQOREWCRMMNONYFROOKGYMFFOJYIGZUYCCYVMNNNZZCNYZPTSDRFZKG9XFAQAJXSJSIV9SUQEACI9SJDPPWBFXSRQEWDMGQTDR9KJAMRENBUQYBNYDRQFQEEXXODDVTSXFJFXQAFGZTBYECVGVVTYJLHNAWVEYXTBGASEKJJIKQ9SVGVZQBVCHUUNLIPAIGFJ9LBHVGN9SQIDWGBEZBEEDZXSJNNXZIUMYPNLWPJIWEWXOFHKPTEDMBMMKWZSWIPPQPNHBVZZGAUCKNQXXHFDKFGIYPRRIKLWV9NYYXZVNSSTKDWBSIMNWANDYEHBMKTGOCROVZKTP9ORWSWMEALZBC9BBIZXJWT9TKDHKIDFMCUTGETRROIJIFDMIERXXYEIIKKDCVOZCAOVCHJIREQMMEXKOESAQWHJIWBDUFSYKECRVWJRQRBLKOHWXAIHAZVREIPXDIKEDAQNAMJRPIHDIXQLLPKZRCEBDKW9SHNYDJBJQPBIJ9AGMVGATRPCBPZRDKGAUBVVGTKLJWILYERNTZFBEWFFQEQKQO9OLLNTD9RQCITOSXDELAOSXDCDMWBKKUIUFNNHIJTUAAOTNOVXGBUXKWMNXIGBWFVDINBEBVNKCOOENLHBKKW9KWHKULEJY9XZJREEHUOGNOEHITMCZIABFFSGG9DYGCHHUACHFXHJOWQBFXPAKIIMCTAF9TIMKUIAERCTDSHGKZYHSROZUQINIUYMFZLYWIELARYM9RJDYSYWUNDFYUACDITAWLCAGFLWXFNIVVQNAJNNSJPVDAW99IXPEIFALUOLPQIJAFHCNTZDMS9CUFUITGWKUZEO9KGUNHKPBXAEWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALI999999999999999999999999999KITTEHS99999999999999999999HXUBQXD99G99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
      TransactionTrytes(b'TIZUJYPRYXNEPO9CADASFGX9MNIWNRMJCECOACVWVFANNXVQUATDBUNZYHTWIUAMOLMLJGJZCOJPUYYNIGBWANVKEAAPPF9XKLUQERECEBFHURPSFCZFLDUIHYJXFIAVIFWFLRKJQWXCLHLFGIHTLBDJCSWYAPJ9SDZJSYXXPZTCLLDXFKWFXGRLEABYESFCOMFKQHUYGOQLVN9GPNN9NCJTIURBWOYCDTRRJPUCMJEMNDHUFYACSDKYFROLRDBVYDKV9QZPJAUASZMZSYMIOUYADETJIASNKYUTDY9WBEMUISXMWCGR9LR9QFQLOWPOGWJPQPKIJJD9BP9BTOMBUNJUFMHZSUYBUTMEZPVXNJCXMZKBZGZJKDZDFBNAPPYWKBQXPHPRYWMYEHRMTJTPMKSHVXDOZSBY9XWAJGGQRDYHFIJRZOEZQTHEBNYEVLITCT9WTUIVQOFQJAXURIELYKAEHBETWSNJP9QZFDPLDPFDIYSPWBC9SHHBEFWYZ9WYTFNOJNHMZUNQH9KNJFHEYYIGTRJXXYDMCWH9RGBZFNKYCAGIMNKBSRCFVKKBZEAASVYTWDJ9E9LVCRTAQO9AROF9FPTKWYGFZRBOPS9ZRCYYJWFCSUOLJLPBTRPMCNK9ZWGCPIGIGQYXEJEQCEAKDKGIPJ9AEIWEYIBFGSSKVBO9KSJODHCVMIYPTQ9KIICAAZAQZQCKHIMZJGJAQGUNVBGTUSDVZCIXAMTULXGZXULRCMJOKUJNFDW9SUMKIULAU9SAVVRVBEVPHJJCMMBOPQHVIJDWYJJMEJEZAGYPOHFQMQSFNOOTWTOSTF9UO9JBLLRBJMPFTEFULKIKNMY9BNTZRDDFSLXBCLCRVXYHGATGUMJXXOSNF9WIABUTHYYTNS9OUNLAOWHPXWBNPDGQJ9KMSHL9PFIXIERQXSLYILNVAVIOSOM9UOTEAYKIEYDNPDHWZDIUOABNLADSKHPYCXJ9CZAFUD9KNXLR9SDGZCTRKPPCCODDJQZEQHIRFOGDVFHUMEKMBUKNMDZYYHOWPQUBNPYZ9DNBGSCRQMOYLPEHMVLZ9VNCRIRUVNRPZYNMZMHKAXYKJTXNLNOVJRGJFQHWUCWKABNXDXOAFU9TPWCFNRFWKUXJSFY9ZZOABINDPZMUSTMPAELAAUG9X9E9XEUTQONQ9SGUDYGYGSQ9MQLHEYUYQLOSFG9T9CVXUUARXYVAQCIVPKHXKPVLUBSEHVUO9MLXXWIUHJP9WFDSWUZWIJDJSLLUOBLABWTCVTZQYYVPHNHMNVNXDBHKYEXY9ZTRLM9EYEUWOGEUKAWZGKQGAIXWXDWXPGXVELFCDPCIAY9WTZJNJQMAJEFUAMNGJQ9RWEHQYJAMA9MRIHDIXMSYLLZSJ9AQZHFDLLGOZXINWWE9ZNGZNNQFIOAHRNMVRKUBVFAIYISTSSTMVSRDG9KZC9XRVVEHJVVVFIPRIOUXMYJX9ACVPVNOBUYNUEJHAYXITWLVWBQAYFQXXRENRHZAMRENQZAAM9CA9KYFFFRFVLRJJMWHPWSXGFOTSFNEOAHNGOBVDJNLTSJAMXPTFZXMFBDMNVZ9XFVYOEWOFYRLUFTLSYAIJCFBHFAMGGSUZCUKBRWBPUEPSEPOUXWOPQWWBTXHVZKEBUIIAZXONCBMUGGJUCYRVJMGYVKORYJPSMBJKGJPCCRCMYBQQIRAJPJFXMBWINHGDVXTYVBVJTYJIXFEGGGBDMQG9UIKRLAHH9WTOEKTUX9SDVUIICZQCMSNSEMXGTKVKLWRGO9VUDAGIVRBDDDFUFVKXIXVDEZYEUWQVJHKYSTTYCFWPQWCBBTAYLVJTQJZEDNJKYEOHUL9VKCNRFFRDKPIPTOWJTSEG9POFORFBUHGAKIWC9ITRNCJHWMKUWQAOMDZOFCXETC99HJLX9NYBMLJUCBXDIESMNPYFSGAWFRCQGDKELLNI9BTOUFELHXEXUWVEKABAAZBLZLTNNBQOIAIKEPOQWUKOGVTUYOL9QFKWVBYVNPNDFUMBTHHFKWEZKSMNYURZEQP9KRKCIKDWNMXVXGDPRFMCLSDZSKLAFEIOVMHPJKBQQVLWSPIQJAC9UUCIVZZARODKIGWQUEOQHLPLXAVHMDLPZEKBYVWUQRGRHKBWVJAT9FQMBWFGGHXZRNPRBQEENIJ9YHPSW9VJOHWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALI999999999999999999999999999KITTEHS99999999999999999999HXUBQXD99F99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
      TransactionTrytes(b'ZVCSZIBVTNOSBPDAKKDOHLRIOQOKANO9ORRKWDXKOIKMFZRHWKLMJDILSHOQQRFFBGYDPIHKJIALTNMGTRRDLRX9RLRUISU9WTONYSCXAXOATYBCOINNJTOIFIEWPUMIGD9KZTSZ9YAUFQUGSGNPWGLIDFSNLW9EHWCBGTREBXWHKGWVAVFPZFFUTKDWQI9RAFUZGBZODZWWVUHEJEUHUWJTFPTAMEMEBKM9WYUAMRFOOKQTQ9SCOUTLVOQHEBZYMSVDMSRLLCFZ9RQJPNQXIFNIFZPLXOJMXYRAHHNDYPRQMLOWDJWDWBBDKJUWCY9JK9HUZTOOZWONRVYLNZQIGYQ9UOMKYALOEKIHOKIXFPUGIXJS9KCESUGTMWMINHVVWVDNOYQTUCGEAMUOALKDEGMDJNEI9MEYZZLFDQ9VIQKTVSOZ9QM9MNGAYOHPLOBUL9BL9ENYVXXBLDNQPXZIAOLMPG9WLEXCXJZM9SAVPO9ENNUPCONSFMAMJETUUBXQO9ABTPEZIHWYSRIKMPYFAFNKENXGBLRTKEDC9LSBFYRXIEXSPQQTJXVN9LKETZYKXGCQCREPHVEFBAJHJPY9SNLXCCXTXUUY9XZBAGOGRJ9NUOVBKPKXEYLZGSHX9PCTAWHCRCDTE9LZDRRC9LQEYASMSSRKPZNQYUPBVUOSVULPJS9SKPFLURGFOZTQERVACIYEUVGMVDMHOBYWEZEHDHLMV9CEDVETRQPCUAZBNLRFDTDMHGUZVHRXBWGXJXSXKUUAFIJGAJYKJYIAXTFFLVKNMMVMUECBKBSMON9KIWKJCVRSSGHJVKGIIWQHJLEUZESOSZRSRKADPTLRRNZFZIMLIQ9RGPPVUCCNQRODMXRUTGJOELBBZDZHHOAMHCCOWNRZELNWANVSYRIDAHTRKSCQUFWILBPCLDATNKLLQOAIBKFLLGLZGWTKGJWDZLXRRBPVCEAGTXHRNEATPYGIJNPPYWCSZVVVHAHDVQOZFYZSTISMWRBBVJGAXMFCIZGLQV9KVRETBOHXOUTNYPR9VNXDMIJIAMMMZRMDCMIZPFGUNMT9GIKNANMPUABRPAHIFFXFTAEJKFMIIGLRYTXKNMGILCCCRBZVIQNFUCLRPU9ILCTZXBVEXMBNBOELUMUJGWIHTVOVSTDFZAKPMHZWOONVZCP9SZPMHJXDE9GOMVZXWNJVZ9DKDKOLTIEWEGXCBQPAVHXNCGGQDZOPS9REQTEBMTHGGDBCK9FLHJBBSZUDYBFRBTCYNROGVRN9RGNMGDBMVPICTIBSPSFKDZXTCGSDBIGCLEAEIAEZLLKGQE9AGAHWSA9PVHOZCAD99ZHXJQQMKYUTNLTVRJXEYQAVQKDTYRGDWXOKDEKYZXCCKEXIKZLCQ9IAZLZKEZAAYJVKELGBUFJAA9TBDVSFFGDSIAAFAVMSKQFXMKCLZXENZOVOXKEPVGVTEXCEEFLDKRNKHABHRRVMJMPQSDGZJVZVGUZTUDFA9PJFOMXLQEQNVMCXHHDSDJJJQLMYOGKDBWJMGKZGOIWGIYHKWLUSTQEZXTXKEW9KEOVRAJRSIPESIIRGLKTKBDUVKRDLESSKEIGMFCCMWCUQYBSDINZXDFCDSUUAGMBDAVISZHQJTOLOXXMZHUJKM9HXPFKJSNJWMWFAMMHSQVSZC9WZLDD99DCOXDGAUBIROEIKFXYTQXDOCVDSRSFVLDQIVUFBNJXC9YWFSVBHXEWUZVGFKGJBXE9XNVGVIBUQRFKJVCDNVUSERLLHGGQLIETWNGGCRTNPMAJAD9BMJWRFDPFOJOZKZGZLJMMIZDANBSXNTUANOOHN9LYLMIUZLGGWXIXXJFTPUS9QMZGL9Z9BHRHURCBIUNQKNJBCOKKZVUZMADWBFGDVJEHKREWYBEA9LRZFILQIYDLPZZ99LVXTCPOXGKPSNSXMDUFWYDVTKMBXUNTMSSZVZXXLMEVXHGNHDTTUAAFMRGGYCZDGUGLT9YFIHSCB9CIGVPEGSIYR9S9IDYFOBWDXQYLKYYEMRMRKTDSHWXSSTIHWNNVNSXMTSORUPCJFYSGWEKHESGN9RM9IHHPTTNMYNGQVEIYAUVOGKOSXJSFGZFROVWFGONQVQJQUQTBWGZ9MZHGHCEFECONQX9NOAVTLQXVVUYERAPEPXFDPPFWRZMUBTTDKTPDSSLOWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALI999999999999999999999999999KITTEHS99999999999999999999HXUBQXD99E99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
      TransactionTrytes(b'QDXKWIQHXUINEMHCJ9AJVHPOMMESNHPVHAHGTSNFWMHPKUGTDADRRWSGHGBGUTZRK9HMCFHKZJYUFQHGJZGKKKEKKZUZSXVRJYIB9PPO9MTZZAKTPNWGOVFLRWPPLAO9VZHBZMDGUZOWXILC9LAIYPBDSTPRZIDOWKBRWGKROSNOWBCXGDTPZXAULESGFHQGCURKIXET9CWTRPLESSHBUNUVHFZDVDMB9DVSR9OKIIEZTNKVUPQJJNIQRZINTKMWWQLWISYG9FDUD9VYXU9UIAXFXNBKVIV9XVUKHLWH9JAUXVQMDYZZVXLLNVUZEEBTUAFZSPFTTJHMXGKLAAEGSGRBFB9HCU9BKYWLYWJBQGUTOHSXDUUYROAEZDVQOCHXHSFEHCWMVJJTUDQVYFHXBBVGNXHEYCAXHOHVCXFBSUCPMXKIW9UHTDAGCMIMZVXAHZLHFVNIMJQHDPJNAHO9AJMYWXUAMFMS9MPSZOOT9EVTPQRXBG9MFPJWXDSYWJLYIDAHXRGMZFEYZTSUSLSQOMH9HGOILRBUFNZUERICIUYYKQ9RMIAGN9EJSVRMHOQGMCPUZS9AFIOIYCLXBTACMOMBGXKEHUZJJEJGOZUSMMAAVPXUTOGITYDAVTPXRWDLESNXZKCCNSHLUQ9MHDLHT9NMFMOZPLTPBVAQPXGXWTKDVPEBAJFNISQGPRJNWNEXOEUC9ZJGJXGEJNWBERHJJRFYMPG9EVKBESTZFWPKOMWMEEAYHTPNTFCIRBOFLFQGOKOZLQDTENDYQXRKXTMOSPFWYKNKUIRREZQJSYTHQHMEANYHPFJNNKLLEPSLIWQXOBQLNAWAHVBCAVYLIDTKILBLTCGXDCJNHOABVVFROZBOCXINETQKIQAIDWHFIKQJYMFZKKNKUIHLHDIJODFJHSD9IOZZAGNJJJR9MCHAANUCKAUKZAYNVMJPULARPCTDRJWPCQCVZPNZRWFPDYJPTNQTQHVDUVFHCGRHFKLDPBXYLUDANFLLOUMJZFZTNEBCAO9OSTPYUVNNHBA9I9OWDGAVSPBOVYGOASQDECRSXCOXXEUSAIACHGTKHUSLM9YMEDMNLMZVSTMRKRGOGBIEKUUOQVFYEQKDGVBGSJBZP9UWSHLWCJRGKXJWOBPLJUPTFXN9LHJRRDODYURRUOJZBKJPMCSJYQDEXKFYPRIGOJTAFSNVISYJRL9CHPOJ9IBMHUODALXMOAPTIXDLHGTPIPEUR9SSFFDQOCPQMFPUCFGSFCFMSAVPXT9ZQIHIHHFTBV9FAMVBNPHYCKSXAGVEQSTQBUNCUIBDFNUBQSISZMACPLHDARLHYLAMMFCHOLCCQERHTFEMYXKSUBASH9ALHVILQZGN9GBBIVPOYRQWVQXGFKGRHTNWNMKQMKPUQDJB9OGUTGDHMZFRBI9GDRVWFUZG999TSYFLY9PBSXYKKRHMOTWAUOBNCJZJQBBIZIBTCKJFNPGEK9FZPUAERPA9ESCKEY9RKRAUNKNGEJXJMBSSYFRLUOYWNKZNEDFCQVQ9QGSLBMFSCPSEAGCRFUPXBXVQAHQSXWAPXGMGYZXUNXFE9ADTPTFRZXEYPZZRKFWZADLR9TDWKVSEVRXOOVINRKYANNBIWIPPJ9RMATUICLKZK9KXRFUMQMNRQPDUNJGYLDXAWPIHKSFSVFRQHBGIWMRCDN9BEUSPBXHNNWJMCHNLDKLYE9SVYSCS9ZZSRFLVIAGKKHTTDYLCTRVOCWXKQNURWKFAMJPTNNQXXLKWAE9FWJHGINNQTLWHTMHCWR9AV9ZPDZRSNVJBMROFVWVNORKKUSRHLMHAVSPBHWKFLKMGMCTQMJELDBVJUATRMUFLNPGNJOYFRUHDRZVFMIANLECBFHMAGZUFBUHNEETSZGZVMSIOTHAUKIAYVDBXJJXMCECSHDCMUAIOSHJZCBARHWLSVDBENZISNDROOZW9ZGPFEIDRWZAWRU9UZSJTG9UMAKRVQODVJYOHFTEPDSHOEKBWFHLNXEQXCCZNMTFN9ECTPNGXZVPUPWTDPCOSIXJWI9TMYKDJTAS9TLRORJRBZWLZMYJMYSECVMMHJJDHEHVCWJDOGO9QFMLXPLTXL9HYCWTKUPBTZIKXJIXDJA9RHFAWEQXIECWGCUUQYELVCMKCDWCGKXQRUKTCUSVHFQIAVXNDLAHQZPJWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALI999999999999999999999999999KITTEHS99999999999999999999HXUBQXD99D99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
      TransactionTrytes(b'FOXBM9TXJZXZZWCKTPUGWMPSMTYW9VAAS9ETIGGHY9BUPRBTUBLTIWAML9EWYUISFIGZBHXO9UDHMSXITLONUGGQTTTWEAMGLKGXTPVADNLUSRDXPBPWLQCPSXJBDMREQYJJPQVIEVLXVTEEBTSNMBUCPUFQNSIONXZSPQMKGHVURSMDCIW9IORAEOQJEWCNWSMKTHRUTCZ9XHNVRAOYNCKUGABWY9KYRDLPQLTWYXKCYOQIELKBFNXAWTGKLYTSPFACCNSUJ9NMOETDJAMEQGCIGTNTSNNALCS9FNGWDPWMPVSK9HPLNGMYCBGEQPZHKGLYGPHLHTKGKMWUYKAPRWFHRXTBKTMQAEELGQCBLSBCDROEJAHTEUXKATAOQRVL9UZUK9GALZPLWTBTDFHPDPC9MRIIN9SQEOPZFXZLAPMJUBY9UXVXUARBMJEUXEJMN9NWMVPWNWZ9FYIMSTTHV9EABVLFYDJVZBIJAJTPRAOFTVCBEKWFRQYNDCJEOKDKQUIO9MYHCAWYRWSYCMTZQXWDPRSXQZEUYFNTFNXJOJNMZLEDECWJYWIUGJCLGKOMIH9MPXBMZLLUDXWPEJJFPYHBFQ9MYWT9MFBLVSYCFDGEHQUAKCP9S9IZGGYOMDUMSNFFSNSNJMPXVGV9KMSYOSKDVCJTPCDMTVL9YIXS9ENPCHKSGFEPMNVTPILVXKTQOSDPCLCLVWBYQBTWVYQBTRGKDIHQZPVAKDRTMYLGMWZPLSZ9GDYC9RARWWHPVMMYHBHUIHAKRGKZLIGPEWIBNXFKRDPJRVRVKKYZXGTLZMJQBHGODUV9PZWMXDUYPCGD9MPYSQLHDMLUTILQNWD9PUSTQHVQWBRBJSBRCFIWYHMVMKLHWAXWCVPTKAOTXW9NGTUVRI9ESHOUAZIBDLPJDAKXIOIHSGNEKXNXEYPNEXSO9BNSZSAHUOKPBCRBSV9UQYTDBEPV9AJNSSPAIEZWLKUKYDONNIEPMNLBMJXSUVYDUBFUOOVKVXOGHXGOZGMLBAEKJEIZCHWNUKFPDXHJSCBFXUHFJVUMPJQTQPGESWNEYFKFXHNNGMFSAOQIVHJ9GNQFKDADDJGQZGSOOFJ9YNPWDDDTFVCHONUUHZDODHVCOOHTUQPCBUYDKUPDJQTYXAEPKQANCRGHOLUGVWIIBDH9JVTAYGOEFCOTEQILTDJ9SE9CJOCGQJGPCWXIDUPYLWBJGVQXMZGGAWURAUANJ9JSSRIHKNBHWNATKBJDTXLWWIWFXTMSHSQCCPGHFTBRMXYJMKBYDPUXXPVQAVDIX9ISDDDF9VBKINLYNNS9XVIBQKWSXF9UKXJKQXJHUCSMHPJYBOSEFGQFRWANPOTXFSGFSETSSE9I9YDSWNNAKXM9MXYFVZDIJOCRBQGKUVN9CNYEEVVCTIMCYQVEAZLEQQZXTNXPYEHHDUHVJGKKMYXIOXPMXUGJLOLFEHTAG9LGOXISRYTGJZHMKESGNXRZEWODDNMNMXQWHGOAMVL9XJBBROYXCAEWMLXOMDKLQPPSBWEINGJWFNFKVYNIKPJEARCWPJXKWH9JMAFKDWX9GMUUKUXDHUIUGHVSHUISSGMXTPGCPNMWYVMDXRFHSGPCNVTKQCMUWMCHRJKAQUEESHBTRZBRLRIZKJ9BJREEO9PPIOVSTORGOR9INC99TDDMCSXQZLFOUMIOTYXWMGPDSLYSMWPCTXCTFPEWD9WTHZRCNYBMCEFCMIUAZXDG9UTZQEJ9HYNLVBLYHHDODPLELAXXXBDTMZWPKLLRAXWJXHJPRWWIDAGGCERUVAAMHYBHNORTJHTBOORFXDMBKLOZKGWZEJLZIGDLIVNFTTZ9EUWJFVESZBMUVLNCXESFAGGDRSKTOYBGVEFKCFIRUJRZMUVXMANVZXXMIICRQSJKFHNSWYGXCTEAKMLYWCIAXZT9AJDJTVTJRHCAEHNHWUWQPIRWQMEXNQYREKLCSGKMSRVJSKYYDLREOTUDXCVSVEIRXVAZEWNHWPECVCDNM9KIKELEXZEBYD9ZNGTRFMMKSQRI9MYAMITL9FZREEQCYXKFPWCI9MJOFNTJQTVJCMFCVRNVMBPJRGGFTHITUWRGLLRDLQHWSTOWXIMZSWLPCCYUDPATCNCNLWPXPKRMGPXOG9C9EDXFMWXGVGRMTXEOSWOEGONBCEUJARCWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALI999999999999999999999999999KITTEHS99999999999999999999HXUBQXD99C99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
      TransactionTrytes(b'WUEEBSQOLEMSHWDFSOUPIPGEWQSAUMIKOUXZJMA9XIBGKA9JHOJIJJWQGBVVSRWYNLEL9AZQTMNRNCBWAKQXATGBPPYJQVKDGELRPWQJKGLGMDQNYNOPOYREOSGNFWHERCITSLWGPFBHIWWJUPCFXILTNMJW9BRCXUTAWTZEUZOBEQJAEFSYEXOMXEHSSFSZLMWYIVWQEWL9HCFWEPXSEMKOWYPCPSETZZXDNSKRSHAVZGBCDNLJYDUVLNR9LNTUEXZSSWR9OXJTSPO9KTLJSYSZD9XWGEPRMTRQNSXIIOADAYRT9IQLILMGKUHVCSDOTXEAW9XTATTUWVDVPGUWIHJKGLTQDEXO9CGYUBKWDVKXUBCXGZDXYBXJCJQHYUKGRDRFWVYXTIZEIDTJJEFBRU9LHPELCMEZCSFGPJYZNMNK9SONRFPCH9PRHBVUTQPTIPGPNIALHKXDHBAVQDWABUEYDFID9JHMNM9AGBUOGICHFGZLSUWBL9ZJLZJZHPIVVV9ZGNXHUJRRIDKFHAESQHAHQQTXKBRALIGKDLCADQWIUHTJWYVBAAJ9AXNXJQDQEVTMVKASMDJEZARMCXZIKWGMRUTJKJ9YNCSPXUXYDGCNEAZHIKFIFOMSMDCAUYJKGPCIGMTKXEUJLRNXKYGPPCOHNVLZMFYPAHVOVZLX9PNDKGAYWJXNTBMIPJGSMJYHWYVLGDUTW9CEPLSKTDWREBOF9LKZVOHNXQNKDFOWKQCYDFLEZAKXOW9WYHWUFMFOEM9HIVHCJPDGEWPJEXIRZAUQRLKYGIIJIIANCGSQRMMSQXL9RPXUAOFVQCYLLJLTQJGSGLVITGHDCXBBYRHSGUVXNBEFXUGCVMUGGGXBIYODDMRBSBOLGKJQHPIUBSBZVZZVWVPIUZWMWOGAALFPNCPYFBBEVPAGLLCWHQYQBFLVHMXXOPWUBYAIJBABVYTK9ZYCNJVZWTIBBKMTG9GHAOQZKGWOET9HOHYDBUVUAECLBMWBUV9UUMDMXSWZLJCYNJWSRZJVTNGMIUYUGBZJ9QRTQZNZFSFP9YOMGIWYARHAOXVRZHSFKQMYFV9CJX9AQONTZDUMMMNLZEGYHKDHEOK9FPOOESYTCSZGJUXZTUVJHCZ9IJZU9GNNU9PLFECQWIFVKS9O9EQSDYDJT9ADDXDHWUXVAYGDKFRBCQZAZGII9QIVYEWWQEBOXSPVPQBHLDCCVQIEPTYMEBTSNIPTKS9OREXNCMLELOJYUEUNZLIGPFOUIBEOKAQZIESXFGXTWFBIYWVWAXCSEOLIUBFI9ZKSFASXBMQMQCIYXDWSUCEJHNVRG9AYG9YQMXRBYDRMGZYZZIPGGEQEROZEAGYQOWTCQI9SJSUTGUCRWNETRKXUEYMQXVRT9JHAAPIQMNCWWAXPZOU9CXRHTMUEYCGFI9TTRQIDIGSTOCGUUK9DYY9WPPXEVFYCADLYNZNYERCGVBXINZSBORYBBDKYNUXRLJAXXZMWVWUU9TVJEHSXAKRLDVYSLT9GAQP9EARBEVXYRFFLUUUQKOTOXRWXFKMDSATZKBGBDVKYGMBSDHVUHFWCXZVRABFUDEUYLVFMOBEIQLJQAWZDGFPL9NUHEASKAJHHTIDENQU9FFBLHSYDCL9URUPW9DVVENORYYBTIGSGZTZTSGCVIZVSTJNAWNVWLOHTEXPTUILX99OQINNLVGELJJYNQDIDAFSZVWLQJRJMPTL9NIUOCRYJQZKYLDELXZ9SVJEXCLENBCLUNBXYZJGKZUEDQTYTLCZDIKIZDWHCXVMZMCDGSQXAVZCCCQGNZBKHZTXKDEBLTSHVNWEIFPHFYWEGZECMELBNXZOVEBDTLZYEXUIXMQANKXRGXOFB9IJWPUHZRVJCEXJYKXVVDVFNEBEAFRJQSVQJBTXCVRICFPMHIBAHTPZKIVOKCAYZNNKPIUHTYG9UJUDHGZA9ITQFTQEYMTYZJEVGETBLVWDZL9BAGDTLFPVSBZ9KVITWM9WAWBHCHTYBZERYKBUSIBVDPCWUEEFUTGDPYOSGXZZCADUIGNHDMFJJV9HXTJMKVBTEYALJZXQTBJOCVHTBAXHUOKKHXNMBFLZXGOEOBERNAUGUI9SPQODKHRITTIWOVHRKPFERSLOLZOEPYMWQNWZBSXJMPQ9DPL9SCGXEDIXHINHEFXEWCTUWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALI999999999999999999999999999KITTEHS99999999999999999999HXUBQXD99B99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
      TransactionTrytes(b'BGDYNIDWEZBETNGCHADSWCWRFNRLLC9EFQUDQWFPEDGPDOOFJHMLXJSVSDVMVLSDSSXFSSSGESVAYVFJVTQEBNVOASHWLZJZNAUBSMCIVJHZGKIEBQPXSKWZTSDKICWQAMPRWQETLDDFYMVMJA9TMMSPIOFXSYUEVKAQWONWVICMLRLCMPVOUYLMNITEDNJGNLLREY9DOHWN9POYUZVYHWOTTTDJHPTLLNRNQKCPPYTZXIWHYKIUKHQ9EFPBFEWYBVYCS9VQBOKCZRRV9YNMJKMHFBRFARFBISWSTKJOXMUNC9MJQUXCTPXCQAYIMUYBECFPOVGDOQXMRTJTMMFUAWKVHHZLJGUGVZPDEQULYLQCUSYZDLUEZRWXUCELFKCDM9TMQIMQYVSUGGFCCGQJSUWOOTMU9DSWUWWGWXJJTDYJHUTRKSCPARCI9DCHEJ9ATQQKXJOVGECOBMTKOIYQBSXQWGCVQKM9YPBKNGQMIICAPEBBZA9ZAXV9TWCFJIJWLZPYUG9ZVVYLPJBBLZRGLYQBS9HVTHOMYUSQONV9DFVDTPYBNLX9JLNRGVIBKZYAFNWBSGDHGMZK9ACKMPZDHYEAJB9UERIXQTOGIUUGYEUUSTCNASDUKSLE9YZARPHEXBYKEMQLRBLLTVIOAZZBBGKSNPOXC9UXNTXXJTIMWFWAZNFTUMGDDFKTJAZZEGKGEDDCDEZTCF9ETJALSM9WHSLIMJVLYOQEMHGYFWAIEZAFBIXYKWCLCCPCDOYFHAVNFYHHGVHBFBOE9VNIDBIQRJSSWFHAGOSFL9PRDORHJNEOPZGSASUILJZJOENLLOAKTTDSALMUAKWCXLLDX9YAGOV9UEIDIMFEVJZWCQABOYNRJIFBMHVVTPFZD9SVX9CRNQAQBFPBOBBMBDTOYUXLWMIZWEUNIWPLDHX9LZTYUKMIIKBSMASNRAHUYRRJFHROIVESDDUPTCBAQUAHK9CTCLOJKFVDOKIRVZOVFJZAQ9NOI9RMOFVRMTSVVBIMC9SWFPFKSQECDLANVMGTMYDQPCKWXUNDJMXO9VNKJTGIIYVVEQWLAHTWOAVFYKZJNUQALP9MREOXL9EHHAYKEANWBVDPKPKRYEAJUYLVAFNNBYVCVHKUZQXCCMAQXNTHHHJJBIADSJAXOE99LGYWEYABEPRGLXLLLUKXWGAJRKPBOOEKMPZXAYODKIFRUAHIAXCUKQXFDCCB9QLXJHWTPSNATQGFPICKAERGLNYQTBAYNZZPXGWVBR9LNHCEUWNRSNCMWWINNEPSWYVFYVOXJIFXJAGTTMY9ICHHPFHBSCCIPKYWMPTZRPNACPBWQVGGTNTBMLGUBPGBDGKUGFMOCZEPELNAJUQRLNLGQSIEIIORTVI99QLKWZCJKLKIGFOCYZVLW9NBWZTWHGIEQEHHHORIFVYJWRNQBWXZWHZOAKDAGQROOTZSTRECZDXMNWC9RATEZDYMBL9EGROLCJSAPRN9R9EWRFIJUERELFGIHCEFGHGYXFOEXYMFGSSAEMUAVZZXVCIKGXTQFLPNUJVXMREZONJZVAENQGZNQCGAMHSACRLWJJDMTFJWBMFPACZTFHRPBTJVGHJRNVBKISPZGKTHRVJRYGGAFJPBGDESLHDCVJICLVEXJQVXFNRKRVCEKC9EHSPCJBHNGMEEXOUPAHYLMXTZZOSYZWLIAKCDNUNXXJBLNEVMDVENHN9D9MJVOBJZREFPW9VCQXPVJI9VJDYEZ9FQQQX9TKYZHVTPGXFRAOORZXIPSQNCUCUXWOQDYJPWM9GRXW9EWLIIJFKBHREVZNYRPXKXHEHLDS9UCQSQFXRKOBFM99DEDZQNJEUNU99FMIXVMXAKJHMGKYTGLGTKLDQBQBTLHLIDJEJZFHQDAWFYAGLFNWEQWIKTALEADY9NAJGRLIKPKRABIBTNZRWSWWIZJQWTSGFOEFYOXFETZWAMDCUWZUSMY9RYZQBRPCBNBOBPOTZWPFXQJTUWZNPAMBXFRBFYOJFIIDFCLYNQRVRJJXCAZYULHEEOBDAHDVAIMFPDSXDXYULGTOXRPHNNCNARKPLPJZIHMAFSNWTKIOQVKDGDDWOMFMIKPQAUITFAKQAOGLNXDHVMKDDQPMQZVHBZRIWYBDVJZFBJXFRGGVWZPDSBOKDWWHOKBFMIQTRBVAIDJDTGXIVWYIKYFEYULFVZZCVBVOUSGVNBOZEUUBPFEPJKH9EUCSBAGGBYWBCSHSDHSSHRSYSEDW9WSUB9JWTTWALILY9999999999999999999999999KITTEHS99999999999999999999HXUBQXD99A99999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
      TransactionTrytes(b'HDWCPCBDLDEAUCIDFDEARCWCTCTCNDQCIDFDVCTCFDGD9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999TESTVALUE9DONTUSEINPRODUCTION99999NDGYBCQZJFGGWZ9GBQFKDOLWMVILARZRHJMSYFZETZTHTZROB9999999999999999999999999KITTEHS99999999999999999999HXUBQXD99999999999H99999999DZBUANFERBAVZFT9HLVYC9WHLNTJASCXUFKHLWRBQGUFPDAHJBJWB9VNOSE9YTRKRBMEQNQEHFFINFBNX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'),
    ])

  def test_pass_happy_path(self):
    """
    Bundle passes validation.
    """
    validator = BundleValidator(self.bundle)

    self.assertListEqual(validator.errors, [])
    self.assertTrue(validator.is_valid())

  def test_fail_signed_in_wrong_order(self):
    """
    The signatures were applied to the bundle in the wrong order.
    """
    # Swap the signatures from the first and second keys.
    # Note that the keys have security level of 3, so we need to swap
    # out a total of 6 signatures.
    sig_1_1 = self.bundle[1].signature_message_fragment
    sig_1_2 = self.bundle[2].signature_message_fragment
    sig_1_3 = self.bundle[3].signature_message_fragment

    sig_2_1 = self.bundle[4].signature_message_fragment
    sig_2_2 = self.bundle[5].signature_message_fragment
    sig_2_3 = self.bundle[6].signature_message_fragment

    self.bundle[1].signature_message_fragment = sig_2_1
    self.bundle[2].signature_message_fragment = sig_2_2
    self.bundle[3].signature_message_fragment = sig_2_3

    self.bundle[4].signature_message_fragment = sig_1_1
    self.bundle[5].signature_message_fragment = sig_1_2
    self.bundle[6].signature_message_fragment = sig_1_3

    validator = BundleValidator(self.bundle)

    self.assertFalse(validator.is_valid())

    self.assertListEqual(
      validator.errors,

      [
        'Transaction 1 has invalid signature (using 8 fragments).',
      ],
    )
